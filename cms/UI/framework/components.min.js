/*!  Zving JS library mergedfile  
* compress at 2015-02-05 
*/
/*! Server */
(function(){var f=window.Zving,c=f.DataCollection,a=f.CONTEXTPATH,b=f.String.encodeURL,e=f.String.htmlEncode,d={};d.RequestMap={};d.MainServletURL="ajax/invoke";d.Pool=[];d.timeout=30;d.getXMLHttpRequest=function(){var h;for(h=0;h<d.Pool.length;h++){if(d.Pool[h][1]=="0"){d.Pool[h][1]="1";return d.Pool[h][0]}}var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{if(window.ActiveXObject){for(h=5;h>1;h--){try{if(h===2){j=new ActiveXObject("Microsoft.XMLHTTP")}else{j=new ActiveXObject("Msxml2.XMLHTTP."+h+".0")}}catch(g){}}}}while(d.Pool.length>10){d.Pool.shift()}d.Pool.push([j,"1"]);return j};d.loadURL=function(h,m,j,n){n=n||d.timeout;var k=d.getXMLHttpRequest();var o;k.open("GET",a+h,true);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.onreadystatechange=function(){if(k.readyState==4){clearTimeout(o);if(k.status>=200&&k.status<300){if(m){m(k.responseText)}}else{if(j){j(k.status)}}for(var p=0;p<d.Pool.length;p++){if(d.Pool[p][0]==k){d.Pool[p][1]="0";break}}k.onreadystatechange=f.noopFn;k=null;m=null;j=null}};if(j){var g=function(){if(k.readyState!=4){k.abort();j()}};o=setTimeout(g,n*1000)}if(/^file:\/\/\//.test(location.href)){clearTimeout(o);f.Console.error("AJAX不能在本地文件系统中使用，请通过http访问本页面。")}else{k.send(null)}};d.getOneValue=function(j,h,k){if(h&&h.prototype===c.prototype){d.sendRequest(j,h,k)}else{var g=new c();g.add("_Param0",h);d.sendRequest(j,g,k)}};d.sendRequest=function(r,q,k,h,j,o){var p=d.timeout;if(!d.fireEvent(r,q)){f.Console.error(r+"的调用被注册事件阻止!");return}var n;if(h!==null&&d.RequestMap[h]){n=d.RequestMap[h];n.abort()}else{n=d.getXMLHttpRequest()}n.open("POST",a+d.MainServletURL,true);n.setRequestHeader("Content-type","application/x-www-form-urlencoded");var g="_ZVING_METHOD="+r;if(j){g+="&_ZVING_NOSESSION=true"}if(o){g+="&_ZVING_DATA_FORMAT="+o}g+="&_ZVING_DATA=";if(typeof q=="string"){g+=encodeURIComponent(q)}else{if(typeof q=="object"){if(f.isEmpty(q)){g+=""}else{g+=encodeURIComponent(f.JSON.stringify(q))}}}g+="&_ZVING_URL="+encodeURIComponent(window.location.pathname);d._ResponseDC=null;n.onreadystatechange=function(){d.onRequestComplete(n,k)};var m=function(){if(n.readyState!=4){k._timeoutHandler=false;n.abort();var s={};s.Status=408;s.Message="连接超时!";console.warn("请求后台方法"+r+"连接超时!");k(s)}};if(k){k._timeoutHandler=window.setTimeout(m,p*1000)}if(/^file:\/\/\//.test(location.href)){f.Console.error("AJAX不能在本地文件系统中使用，请通过http访问本页面。")}else{n.send(g)}};d.onRequestComplete=function(m,h){if(m.readyState==4){if(h){if(h._timeoutHandler){clearTimeout(h._timeoutHandler);h._timeoutHandler=false}else{if(h._timeoutHandler===false&&m.status==0&&m.responseText==""){console.warn("请求后台方法"+methodName+"因连接超时!已取消请求");return}}}var q={};q.Status=m.status;if(m.status>=200&&m.status<300){var p=m.responseText.trim();if(p.indexOf("<")==0){var r=m.responseXML;if(!r){r=f.toXMLDOM(p)}if(r){q=new c();if(q.parseXML(r)){if(q.get("_ZVING_SCRIPT")){window["eval"](q.get("_ZVING_SCRIPT"))}var g=q.get("_ZVING_STATUS");if(g){q.map.Status=g}var o=q.get("_ZVING_MESSAGE");if(o){q.map.Message=o}}q=q.map;d._ResponseDC=q;r=null}}else{if(p.indexOf("{")==0||p.indexOf("[")==0){q=f.JSON.parse(p);if(q._ZVING_SCRIPT){window["eval"](q._ZVING_SCRIPT)}for(var j in q){if(q[j]!=null&&typeof q[j]["@type"]=="string"){q[j]=new f[q[j]["@type"]](q[j])}}if(q._ZVING_STATUS!==undefined){q.Status=q._ZVING_STATUS}if(q._ZVING_MESSAGE!==undefined){q.Message=q._ZVING_MESSAGE}d._ResponseDC=q}else{q.Message="后台程序发生异常，未获取到正确的数据!"}}}else{if(m.status==0){q.Message=undefined}else{q.Message="服务器发生"+m.status+"异常，未获取到数据!"}}if(h){q.get=q.get||function(k){return q[k]};h(q)}for(var n=0;n<d.Pool.length;n++){if(d.Pool[n][0]==m){d.Pool[n][1]="0";break}}m.onreadystatechange=f.noopFn;m=null;h=null}};d.getResponse=function(){return d._ResponseDC};d.Events={};d.bindEvent=function(h,j){var g=d.Events[h];if(!g){g=[]}g.push(j)};d.fireEvent=function(h){var j=f.toArray(arguments);var g=d.Events[h];if(!g){return true}var k;for(k=0;k<g.length;k++){if(!g[k].apply(null,j.push(j.shift()))){return false}}return true};$window.on("unload",function(){d.Pool.length=0;d.RequestMap={};d._ResponseDC=null});f.Server=d})();
/*! UIX.js */
(function(){var c=window.Zving,d=c.isIE6,b={};b.initCtrl=function(f,e){f=c.getDom(f);if(f._ctrl_style_attached_){return}var g=f.type;switch(g){case"textarea":if(d&&f.disabled===true){c.Node.addClass(f,"disabled")}break;case"text":case"":if(d&&f.className===""){c.Node.addClass(f,"inputText")}if(f.getAttribute("placeholder")&&!c.support.placeholder){b.placeholder(f)}break;case"password":if(d&&f.className===""){c.Node.addClass(f,"inputText")}if(d&&f.disabled===true){c.Node.addClass(f,"disabled")}break;case"submit":case"reset":case"button":if(d&&f.className===""&&!(/border|background/).test(f.style.cssText)){c.Node.addClass(f,"inputButton")}if(d&&f.disabled===true){c.Node.addClass(f,"disabled")}break;case"checkbox":break;case"radio":break;case"file":break;case"image":break;default:}f._ctrl_style_attached_=true;f=null};b.placeholder=function(e){$(e).focus(function(){if(this.value==this.getAttribute("placeholder")){this.value=""}$(this).removeClass("placeholder")});$(e).blur(function(){if(this.value===""||this.value==this.getAttribute("placeholder")){$(this).addClass("placeholder");this.value=this.getAttribute("placeholder")}});if(e.value===""||e.value==e.getAttribute("placeholder")){$(e).addClass("placeholder");e.value=e.getAttribute("placeholder")}};if(c.isIE6&&c.ieVersion<8){c.Node.addClass(document.documentElement,"ie-lt8")}var a=function(){var e=$window.width();var f=document.documentElement;if(e<768){c.Node.addClass(f,"ww-lt768");c.Node.removeClass(f,"ww-lt992");c.Node.removeClass(f,"ww-lt1200")}else{if(e<992){c.Node.addClass(f,"ww-lt992");c.Node.removeClass(f,"ww-lt768");c.Node.removeClass(f,"ww-lt1200")}else{if(e<1200){c.Node.addClass(f,"ww-lt1200");c.Node.removeClass(f,"ww-lt768");c.Node.removeClass(f,"ww-lt992")}}}};a();c.EventManager.onWindowResize(a,this);c.UI=b})();
/*! Console */
(function(){var z=window.Zving,Cookie=z.Cookie,Console={};var getDebugModeValue=Cookie.set("console_debug")=="true";getDebugModeValue=/^(http:\/\/develop)/.test(location.href)||getDebugModeValue;if(getDebugModeValue){Console.debug=true;Console.silence=true}else{Console.debug=false;Console.silence=true}var timer;Console.cache=[];Console.history=[];Console.queue=[];Console.counters={error:0,warn:0,info:0,log:0};Console.status=true;Console.max=100;Console.historyIndex=null;Console.debugWindowError=false;Console.useBrowerConsole=false;Console.constr=function(value,inObject,inArray,link){var isArray=false,isHash,isElement=false,vtype=typeof value,result=[];if(vtype==="object"){if(Object.prototype.toString.call(value)==="[object Date]"){vtype="date"}else{if(Object.prototype.toString.call(value)==="[object String]"){vtype="string"}else{if(Object.prototype.toString.call(value)==="[object Boolean]"){vtype="boolean"}else{if(Object.prototype.toString.call(value)==="[object RegExp]"){vtype="regexp"}}}}}try{var i,len;if(value instanceof Array&&typeof _object!=="function"){isArray=true}if(vtype==="object"&&(value==window||value instanceof Object)&&!value.nodeName){isHash=true}if(vtype!=="undefined"&&Boolean(value.nodeName)&&Boolean(value.nodeType)){isElement=true}if(value===null||value===undefined||vtype==="undefined"||vtype==="number"||vtype==="string"||vtype==="boolean"||(vtype==="function"&&value.nodeName!=="OBJECT")||vtype==="regexp"||vtype==="date"){if(value===null){result.push("<span style='color:#999'>null</span>")}else{if(value===undefined){result.push("<span style='color:#999'>undefined</span>")}else{if(vtype==="undefined"){result.push("<span style='color:#c99'>undefined</span>")}else{if(vtype==="regexp"){result.push("<span style='color:#360'>"+value+"</span>")}else{if(vtype==="date"){result.push("<span style='color:#060;'>'"+value+"'</span>")}else{if(vtype==="number"){result.push("<span style='color:#009'>"+value+"</span>")}else{if(vtype==="boolean"){result.push("<span style='color:#00c'>"+value+"</span>")}else{if(vtype==="function"){if(inObject||inArray){result.push("<span style='color:#696; text-decoration:underline; cursor:pointer;' onclick='Zving.Console.log(Zving.Console.cache["+(Console.cache.push(value)-1)+"])'>function()</span>")}else{result.push("<span style='color:#090'>"+value.toString().substring(0,100)+(value.toString().length>100?" ...":"")+"</span>")}}else{result.push("<span style='color:#e22'>"+(!inObject&&!inArray?value:'"'+value.substring(0,100)+(value.length>100?" ...":"")+'"').replace(/\n/g,"\\n").replace(/\s/g,"&nbsp;").replace(/>/g,"&#62;").replace(/</g,"&#60;")+"</span>")}}}}}}}}}else{if(isElement){if(value.nodeType===3){result.push(Console.constr(value.nodeValue))}else{if(inObject){result.push("<span style='color:#999'>"+value.nodeName.toLowerCase()+"</span>")}else{result.push("<span style='color:#00f;"+(!inObject&&!inArray?"'":"text-decoration:underline; cursor:pointer;' onclick='Zving.Console.log(Zving.Console.cache["+(Console.cache.push(value)-1)+"])'")+"'>");if(inArray){result.push(value.nodeName.toLowerCase());if(value.getAttribute){if(value.getAttribute&&value.getAttribute("id")){result.push("<span style='color:#009'>#"+value.getAttribute("id")+"</span>")}var elClass=value.getAttribute((z.isIE6||z.isIE7)?"className":"class")||"";result.push(!elClass?"":"<span style='color:#f00'>."+elClass.split(" ")[0]+"</span>")}result.push("</span>")}else{result.push("<span style='color:#009'>&#60;<span style='color:#00f'>"+value.nodeName.toLowerCase());if(value.attributes){for(i=0,len=value.attributes.length;i<len;i++){var item=value.attributes[i];if(item&&(z.isGecko||(item.nodeValue&&typeof item.nodeValue!=="function"))){result.push(" <span style='color:#009'>"+item.nodeName+"=\"<span style='color:#f00'>"+item.nodeValue+'</span>"</span>')}}}result.push("</span>&#62;</span>")}}}}else{if(isArray||isHash){if(isArray){if(inObject){result.push("<span style='color:#999;text-decoration:underline; cursor:pointer;' onclick='Zving.Console.log(Zving.Console.cache["+(Console.cache.push(value)-1)+"])'>["+value.length+"]</span>")}else{result.push("<span style='font-weight:normal'>[ ");for(i=0,len=value.length;i<len;i++){if((inObject||inArray)&&i>3){result.push(", <span style='color:#999;font-weight:bold'>"+(len-4)+" More...</span>");break}result.push((i>0?", ":"")+Console.constr(value[i],false,true,true))}result.push(" ]</span>")}}else{if(inObject){result.push("<span  style='color:#009; text-decoration:underline; cursor:pointer;' onclick='Zving.Console.log(Zving.Console.cache["+(Console.cache.push(value)-1)+"])'>Object</span>")}else{result.push("<span  style='color:#060;font-weight:normal;"+(!inObject&&!inArray?"'":" text-decoration:underline; cursor:pointer;' onclick='Zving.Console.log(Zving.Console.cache["+(Console.cache.push(value)-1)+"])'")+">Object");i=0;for(var key in value){var val=value[key];if((inObject||inArray)&&i>3){result.push(" <span style='color:#999;font-weight:bold;'>More...</span>");break}result.push(" "+key+"="+Console.constr(val,true));i++}result.push("</span>")}}}else{result.push(["<span style='color:#999;'>"+value+"</span>"])}}}}catch(e){result.push("<span style='background-color:#FFFFDD;'>"+e.message+"</span>")}return result.join("")};Console.inputKeydown=function(evt){evt=window.event||evt;var consoleInput=z.getDom("_ConsoleInput");if(evt.keyCode===13){Console.evaluate(consoleInput.value.replace(/(^\s*)|(\s*$)/g,""))}else{if(evt.keyCode===40){if(Console.history[Console.historyIndex+1]){Console.historyIndex+=1;consoleInput.value=Console.history[Console.historyIndex]}}else{if(evt.keyCode===38){if(Console.history[Console.historyIndex-1]){Console.historyIndex-=1;consoleInput.value=Console.history[Console.historyIndex]}}}}};Console.evaluate=function(cmd){var result;if(cmd.length===0){return}z.getDom("_ConsoleInput").value="";Console.historyIndex=Console.history.push(cmd);try{result=eval.call(window,cmd);if(cmd.substr(0,7)!=="Console"){Console.log(">> "+cmd);Console.log(result)}}catch(e){Console.log(e)}};Console.getConsoleDiv=function(){var consoleWrapDiv=z.getDom("_Console");if(!consoleWrapDiv){consoleWrapDiv=document.createElement("div");consoleWrapDiv.id="_Console";consoleWrapDiv.className="console-warp";consoleWrapDiv.style.cssText="position:absolute; z-index:9999; left:0%;top:"+Math.max(document.documentElement.scrollTop,document.body.scrollTop)+"px; width:62%; background-color:#fff; border:1px solid #359; opacity:0.9; filter:alpha(opacity=90); padding:4px;";consoleWrapDiv.innerHTML='<div id="_ConsoleHead"; style="background-color:#cde; height:20px; color:#000; font-size:12px; line-height:20px; cursor:move;"><a style="color:#123; float:right; text-decoration:none; margin:1px 2px 0;" href="javascript:Zving.Console.hide();void(0);">[隐藏]</a><a style="color:#123; float:right; text-decoration:none; margin:1px 2px 0;" href="javascript:Zving.Console.clear();void(0);">[清空]</a><a style="color:#123; float:right; text-decoration:none; margin:1px 2px 0;" href="javascript:void(0);" onclick="javascript:this.innerHTML=Zving.Console.switchDebugMode()?\'[调试模式:开]\':\'[调试模式:关]\';void(0);">['+(Console.debug?"调试模式:开":"调试模式:关")+']</a></div><div id="_ConsoleBody"; style="font-size:12px; line-height:1.2;color:#333; width:100%; max-height:200px; overflow:auto;"></div><div id="_ConsoleFoot" style="font-size:12px; line-height:2; color:#333; border-top:1px solid #ccc">&gt;&gt; <input type="text" id="_ConsoleInput" style="width:94%" /></div>';document.body.appendChild(consoleWrapDiv);var consoleDivHead=z.getDom("_ConsoleHead");var consoleDivBody=z.getDom("_ConsoleBody");if(z.isIE6){consoleDivBody.style.height="200px"}var consoleDivFoot=z.getDom("_ConsoleFoot");if(z.SimpleDrag){new z.SimpleDrag({dragEl:consoleWrapDiv,handleEl:consoleDivHead})}z.getDom("_ConsoleInput").onkeydown=Console.inputKeydown;Console.consoleDiv=consoleWrapDiv;Console.consoleDivBody=consoleDivBody}return Console.consoleDiv};Console.formatArgs=function(){var content=[];for(var i=0,len=arguments.length;i<len;i++){content.push(Console.constr(arguments[i],false,false,true))}return content.join(" ")};Console.addLine=function(html){var newItem=document.createElement("div");newItem.style.cssText="border-top:1px solid #cde; padding:3px;font-family:'Courier New'; font-size:13px; background-color:#fff";newItem.innerHTML=html;var consoleWrapDiv=Console.getConsoleDiv();var consoleDivBody=Console.consoleDivBody;while(consoleDivBody.childNodes.length>Console.max){consoleDivBody.removeChild(firstChild)}consoleDivBody.appendChild(newItem);return newItem};Console.scroll=function(){if(!Console.debug){return false}var consoleWrapDiv=Console.getConsoleDiv();consoleWrapDiv.style.display="";var ConsoleDivTop=parseInt(consoleWrapDiv.style.top.replace(/\D/gi,""),10)||0;if(ConsoleDivTop<Math.max(document.documentElement.scrollTop,document.body.scrollTop)||ConsoleDivTop>Math.max(document.documentElement.scrollTop,document.body.scrollTop)+(document.compatMode==="BackCompat"?document.body.clientHeight:document.documentElement.clientHeight)){consoleWrapDiv.style.top=Math.max(document.documentElement.scrollTop,document.body.scrollTop)+"px"}var consoleDivBody=Console.consoleDivBody;consoleDivBody.scrollTop=9999};Console.stack=function(level,agrs){if(Console.queue.length>=Console.max){Console.queue.splice(0,Console.queue.length-3*Math.floor(Console.max/4))}Console.queue.push({level:level,agrs:agrs});++Console.counters[level]};Console.log=function(){if(!Console.debug){return}if(Console.silence||!document.body||Console.getConsoleDiv().style.display==="none"){Console.stack("log",arguments)}else{var html=Console.formatArgs.apply(window,arguments);var newItem=Console.addLine(html);Console.scroll()}};Console.warn=function(){if(!Console.debug){return}if(Console.silence||!document.body||Console.getConsoleDiv().style.display==="none"){Console.stack("warn",arguments)}else{var html=Console.formatArgs.apply(window,arguments);var newItem=Console.addLine(html);newItem.style.backgroundColor="#DDFFFF";Console.scroll()}};Console.error=function(){if(!Console.debug){return}if(Console.silence||!document.body||Console.getConsoleDiv().style.display==="none"){Console.stack("error",arguments)}else{var html=Console.formatArgs.apply(window,arguments);var newItem=Console.addLine(html);newItem.style.backgroundColor="#FFFFDD";Console.scroll()}};Console.info=function(){if(!Console.debug){return}if(Console.silence||!document.body||Console.getConsoleDiv().style.display==="none"){Console.stack("info",arguments)}else{var html=Console.formatArgs.apply(window,arguments);var newItem=Console.addLine(html);Console.scroll()}};Console.show=function(){Console.silence=false;var consoleWrapDiv=Console.getConsoleDiv();consoleWrapDiv.style.display="";while(Console.queue.length>0){Console[Console.queue[0].level].apply(window,Console.queue[0].agrs);Console.queue.shift()}Console.queue.length=0;var consoleInput=z.getDom("_ConsoleInput");consoleInput.focus()};Console.hide=function(){Console.silence=true;z.getDom("_Console").style.display="none"};Console.clear=function(){z.getDom("_ConsoleBody").innerHTML="";Console.cache.length=0;Console.queue.length=0};Console.switchDebugMode=function(status){if(status===undefined){Console.debug=!Console.debug}else{Console.debug=status}if(Console.debug){Cookie.set("console_debug","true");Console.log("调试模式开启。")}else{Cookie.set("console_debug","false");Console.addLine("调试模式关闭。");Console.scroll();window.setTimeout(function(){Console.hide();Console.clear()},1000)}return Console.debug};Console.toggleVisible=function(){if(z.getDom("_Console")&&z.getDom("_Console").style.display!=="none"){Console.hide()}else{Console.show()}};Console.attachOnkeyup=function(event){if(event.altKey&&event.shiftKey&&event.ctrlKey){if(event.keyCode===68){Console.toggleVisible()}}};Console.notify=function(){var counters=Console.counters;if(counters.error+counters.warn+counters.info+counters.log){var msg=["Logged Errors:",counters.error,"Warnings:",counters.warn,"Info:",counters.info,"Log:",counters.log].join(" ");if(counters.error){msg="*** "+msg}Zving.rootWin.status=msg}if(Console.status===false&&timer){window.clearInterval(timer);timer=null}};timer=window.setInterval(Console.notify,1000);if(window.console&&window.console.log&&Console.useBrowerConsole===true){Console=window.console}else{if(Console.debug&&Console.debugWindowError){window.onerror=function(message,file,line){if(z.getDom("_Console")&&z.getDom("_Console").style.display==="none"){return}Console.error("脚本错误：行:"+line+"  错误:"+message+"  文件:"+file);var oFun=window.onerror.caller;var oArgs=Array.prototype.slice.call(oFun.arguments);Console.error("抛出错误的函数:"+Console.constr(oFun));Console.error("函数执行时的参数:"+Console.constr(oArgs))}}$document.on("keyup",Console.attachOnkeyup);$window.on("unload",function(){$document.off("keyup",Console.attachOnkeyup)})}z.Console=Console})();(function(){var e=window.Zving,a={},d;a.idSeed={};d=a.compCache=new e.DataCollection();a.add=a.register=function(g,f){if(typeof(g)!="string"){f=g;g=f.id}var h=d.get(g);if(h&&h!=f){if(!h.isDestroyed&&h.destroy&&h.el&&e.Dom.isRemoved(h.el)){h.destroy()}}d.add(g,f)};a.remove=a.unregister=function(f){if(typeof(f)!="string"){f=f.id}d.remove(f)};a.getById=function(f){return d.get(f)};a.getByDom=function(g,f){g=e.getDom(g);if(g&&g._components){return a.getById(e.getDom(g)._components[f])}};a.get=function(f,g){if(g){return a.getByDom(f,g)}else{return a.getById(f)}};a._unload=function(){var g,f;for(g in d.map){if(d.map.hasOwnProperty(g)){f=d.map[g];if(f&&f.destroy&&!f.isDestroyed){f.destroy()}}}d.clear()};a.destroyByDom=function(h){if(h.nodeName&&h.nodeType){h=[h]}var k,g;for(var j=0,f=h.length;j<f;j++){k=h[j].compId;g=k&&d.get(k);if(g&&g.destroy&&!g.isDestroyed){g.destroy()}}};a.initComponent=function(g,f){f=f||g.getAttribute("ztype");if(!f){return}switch(f.toLowerCase()){case"input":if(e.UI){e.UI.initCtrl(g)}break;case"verify":if(e.Verify){e.Verify.initCtrl(g)}break;case"date":case"time":case"datetime":if(e.DatePicker){new e.DatePicker(g)}break;case"number":if(e.NumberField){new e.NumberField(g)}break;case"combox":if(e.Combox){new e.Combox(g)}break;case"suggest":if(e.Suggest){new e.Suggest(g)}break;default:}g=null};a.initChildren=function(n){n=e.getDom(n);var h=[],g=[],k=[],j,m;if(n.canHaveChildren){h=n.getElementsByTagName("input");g=n.getElementsByTagName("textarea");k=n.getElementsByTagName("select")}else{if(n.tagName=="INPUT"){h=[n]}else{if(n.tagName=="TEXTAREA"){g=[n]}else{if(n.tagName=="SELECT"){k=[n]}else{return}}}}var o,f;for(j=0,len=h.length;j<len;j++){m=h[j];if(e.UI){e.UI.initCtrl(m)}f=m.getAttribute("ztype");if(f){a.initComponent(m,f)}o=m.getAttribute("verify");if(o){a.initComponent(m,"verify")}}for(j=0,len=g.length;j<len;j++){m=g[j];if(e.UI){e.UI.initCtrl(m)}o=m.getAttribute("verify");if(o){a.initComponent(m,"verify")}}for(j=0,len=k.length;j<len;j++){m=k[j];if(e.UI){e.UI.initCtrl(m)}f=m.getAttribute("ztype");if(f){a.initComponent(m,f)}o=m.getAttribute("verify");if(o){a.initComponent(m,"verify")}}m=null};var c={};var b={};e.PluginManager={registerPlugin:function(g,f){b[g]=f;f.ptype=g},createPlugin:function(g,h){var f=b[g.ptype||h];if(f.init){return f}else{return new f(g)}}};e.Page.onReady(function(){a.initChildren(document.body)},1);$(document).on("pageshow",".ui-page",function(f){a.initChildren(f.target)});e.ComponentManager=a;e.compCache=d})();(function(){var a=window.Zving;a.UICompBase=function(c){this.defaultConfig=this.defaultConfig||{dom:{},bubbleEvents:[]};a.mix(this,this.defaultConfig);c=c||{};a.Observable(this);this.addEvents("disable","enable","beforeshow","show","beforehide","hide","beforerender","render","afterrender","beforedestroy","destroy","resize","move");if(a.isElement(c)||typeof c=="string"){c=this.initFromDom(c)||{}}this.initialConfig=this.initialConfig||c;a.mix(this,c);if(c.el){this.el=a.getDom(c.el);if(this.el&&this.el.nodeType){this.ownerDocument=this.el.ownerDocument;this.ownerWindow=this.ownerDocument.parentWindow;this.$el=this.ownerWindow.$(this.el)}else{if(!this.el){a.Console.error(this.ctype+"- 找不到参数"+c.el+"对应的页面元素！");console.error(this.ctype+"- 找不到参数"+c.el+"对应的页面元素！");return}}this.id=this.ctype+"_"+a.id(this.el);this.el._components=this.el._components||{};if(this.el._components[this.ctype]==this.id){console.log(this.el,"被多次初始化",this.ctype,"，请检查代码是否会造成错误。");return a.ComponentManager.getById(this.id)}this.el._components[this.ctype]=this.id;if(this.el&&!this.outerEl){this.outerEl=a.getDom(this.el.id+this.outerElIdPostfix);if(!this.outerEl){this.outerEl=this.el}this.$outerEl=this.ownerWindow.$(this.outerEl)}this.rendered=true}this.getId();if(this.statable){a.Statable(this)}a.DataGSetter(this);if(this.plugins){if(a.isArray(this.plugins)){for(var d=0,b=this.plugins.length;d<b;d++){this.plugins[d]=this.initPlugin(this.plugins[d])}}else{this.plugins=this.initPlugin(this.plugins)}}this.initComponent();if(this.renderTo){this.render(this.renderTo);delete this.renderTo}a.ComponentManager.register(this);if(this.autoShow){this.show()}};a.UICompBase.prototype={ctype:"UICompBase",id:null,disabled:false,hidden:false,floating:false,autoShow:false,rendered:false,cls:"",style:null,outerElAttrs:{tag:"div"},outerElIdPostfix:"_outer",disabledClass:"z-disabled",hiddenClass:"z-hidden",renderTpl:'<div id="{id}_body"></div>',contentTpl:null,ctCls:null,baseCls:null,cmpCls:null,statable:false,defaultAlign:"rb",initPlugin:function(b){if(b.ptype&&!a.isFunction(b.init)){b=a.PluginManager.createPlugin(b)}else{if(a.isString(b)){b=a.PluginManager.createPlugin({ptype:b})}}b.init(this);return b},initComponent:function(){if(this.listeners){this.on(this.listeners);delete this.listeners}if(this.bubbleEvents){this.enableBubble(this.bubbleEvents);delete this.bubbleEvents}},initFromDom:function(b){return{el:b}},beforerender:function(){},render:function(c,b){var d=this;if(c){c=a.getDom(c)}this.beforerender();if(this.rendered||this.fireEvent("beforerender",this)===false){return this}if(!c){if(this.el){c=(this.outerEl||this.el).parentNode}else{c=this.container||this.parentEl||document.body}}this.ownerDocument=c.ownerDocument;this.ownerWindow=c.ownerDocument.parentWindow;this.container=this.ownerWindow.Zving.getDom(c);if(this.ctCls){a.Node.addClass(this.container,this.ctCls);delete this.ctCls}this.onRender(this.container,b);this.rendered=true;if(this.autoShow){a.Node.removeClass(this.outerEl,this.hiddenClass)}if(this.cls){a.Node.addClass(this.outerEl,this.cls);delete this.cls}this.fireEvent("render",this);this.initContent();this.afterRender(this.container);this.fireEvent("afterrender",this);if(this.hidden){a.Node.addClass(this.outerEl,this.hiddenClass)}if(this.disabled){this.disable(true)}return this},updateContent:function(c,e,b){var d=this.getContentEl();if(d.innerHTML){this.ownerWindow.jQuery.cleanData(d.getElementsByTagName("*"))}if(this.contentTpl&&typeof c!=="string"){d.innerHTML=a.String.tmpl(this.contentTpl,c||{})}else{var f=a.isObject(c)?a.Dom.createHtml(c):c;a.Node.update(d,f,e,b)}},applyToMarkup:function(b){this.el=a.getDom(b);this.container=(this.outerEl||this.el).parentNode;this.ownerDocument=this.container.ownerDocument;this.ownerWindow=this.ownerDocument.parentWindow;this.$el=this.ownerWindow.$(this.el);this.render(this.container)},onRender:function(d,b){var e=this;var j,f;if(!d){d=this.container||document.body}else{this.ownerDocument=d.ownerDocument;this.ownerWindow=d.ownerDocument.parentWindow}var h=this.ownerDocument,g=this.ownerWindow;if(b!==undefined&&b!==null){if(a.isNumber(b)){b=d.children[b]}else{b=this.ownerWindow.Zving.getDom(b)}}if(!this.el&&this.outerElAttrs){if(this.outerElAttrs){if(typeof this.outerElAttrs=="string"&&!/<|&#?\w+;/.test(this.outerElAttrs)){this.outerEl=h.createElement(this.outerElAttrs)}else{j=h.createElement("div");f=this.initRenderData();var c=typeof this.outerElAttrs=="string"?this.outerElAttrs:a.Dom.createHtml(this.outerElAttrs);j.innerHTML=a.String.tmpl(c,f);this.outerEl=j.firstChild}}}if(this.outerEl){if(b){d.insertBefore(this.outerEl,b)}else{d.appendChild(this.outerEl)}if(j){a.Dom.removeNode(j);j=null}}if(this.renderTpl){f=this.initRenderData();this.outerEl.innerHTML=a.String.tmpl(this.renderTpl,f)}this.el=this.ownerWindow.Zving.getDom(this.getId());if(this.el&&!this.outerEl){this.outerEl=this.el}else{if(!this.el&&this.outerEl){this.el=this.outerEl}}if(!this.el.id){this.el.id=this.getId();this.el._components=this.el._components||{};this.el._components[this.ctype]=this.id}if(this.el!=this.outerEl){if(this.outerElIdPostfix){this.outerEl.id=this.el.id+this.outerElIdPostfix}this.$outerEl=this.ownerWindow.$(this.outerEl);this.$el=this.ownerWindow.$(this.el)}else{this.$outerEl=this.$el=this.ownerWindow.$(this.el)}if(this.baseCls){a.Node.addClass(this.outerEl,this.baseCls)}if(this.cmpCls){a.Node.addClass(this.outerEl,this.cmpCls);delete this.cmpCls}if(this.style){if(typeof this.style=="string"){this.outerEl.style.cssText=this.style}else{a.mix(this.outerEl.style,this.style)}delete this.style}},initContent:function(){var b=this.getContentEl();if(this.html){b.innerHTML=this.html;delete this.html}if(this.contentEl){var c=a.getDom(this.contentEl);a.Node.removeClass(this.hiddenClass);b.appendChild(c)}if(this.contentTpl){b.innerHTML=a.String.tmpl(this.contentTpl,this.contentRenderData||{});delete this.contentRenderData}},afterRender:function(b){if(this.height||this.width){this.setSize(this.width,this.height)}if(this.x!==undefined||this.y!==undefined){this.setPosition(this.x,this.y)}this.initDom()},applyRenderSelectors:function(){var d=this.domSelectors||{},c=this.outerEl,b;for(b in d){if(d.hasOwnProperty(b)){this[b]=$.find(d[b],c)}}},initDom:function(){this.applyRenderSelectors()},onResize:function(){},setSize:function(c,b){if(this.minWidth&&c<this.minWidth){c=this.minWidth}if(this.maxWidth&&c>this.maxWidth){c=this.maxWidth}if(this.minHeight&&b<this.minHeight){b=this.minWidth}if(this.maxHeight&&b>this.maxHeight){b=this.maxHeight}if(!this.rendered){this.width=(c!==undefined)?c:this.width;this.height=(b!==undefined)?b:this.height;return this}a.Node.setSize(this.outerEl,c,b);this.onResize(c,b);this.width=c;this.height=b;this.fireEvent("resize",this,c,b);return this},setPosition:function(b,c){if(!this.rendered){this.x=(b!==undefined)?b:this.x;this.y=(c!==undefined)?c:this.y;return this}a.Node.setPosition(this.outerEl,b,c);this.onPosition(b,c);this.x=b;this.y=c;this.fireEvent("move",this,b,c);return this},onPosition:function(){},getSize:function(){return a.Node.getSize(this.outerEl)},getId:function(){if(!this.id){var c=this.ctype.toLocaleLowerCase().replace(/\./g,"_"),b=a.rootWin.Zving.ComponentManager.idSeed;if(b[c]===undefined){b[c]=0}this.id="z-"+c+"-"+(++b[c])}return this.id},getItemId:function(){return this.itemId||this.getId()},getEl:function(){if(!this.el){this.el=(this.ownerWindow||window).Zving.getDom(this.id)}return this.el},getOuterEl:function(){return this.outerEl||this.el},getTargetEl:function(){return this.target||this.el},getContentEl:function(){return this.ownerWindow.Zving.getDom(this.id+"_body")||this.el},getBodyEl:function(){return this.ownerWindow.Zving.getDom(this.id+"_body")||this.el},getContainerEl:function(){return this.container||this.parentEl||(this.outerEl||this.el).parentNode},getOwnerCt:function(){return this.ownerCt},initRenderData:function(){this.renderData=this.renderData||{};return a.mixIf(this.renderData,{id:this.id,baseCls:this.baseCls,cmpCls:this.cmpCls,cls:this.cls})},focus:function(d,c){if(c){this.focusTask=new a.Util.DelayedTask(this.focus,this,[d,false]);this.focusTask.delay(a.isNumber(c)?c:16);return}if(this.rendered&&!this.isDestroyed){var b=this.getFocusEl?this.getFocusEl():this.el;if(Node.needsTabIndex(b)){b.tabIndex=-1}try{b.focus();if(d===true){b.select()}}catch(f){console.error(f)}}return this},blur:function(){if(this.rendered){var b=this.getFocusEl?this.getFocusEl():this.el;b.blur()}return this},disable:function(b){if(this.rendered){a.Node.addClass(this.outerEl,this.disabledClass);a.Node.disable(this.outerEl,this.maskOnDisable?true:false);this.outerEl.disabled=true}this.disabled=true;if(b!==true){this.fireEvent("disable",this)}return this},enable:function(b){if(this.rendered){a.Node.removeClass(this.outerEl,this.disabledClass);this.outerEl.disabled=false}this.disabled=false;if(b!==true){this.fireEvent("enable",this)}return this},isDisabled:function(){return this.disabled},setDisabled:function(b){return this[b?"disable":"enable"]()},show:function(){var b=this;if(this.fireEvent("beforeshow",this)===false){return this}this.hidden=false;if(this.autoRender){this.render(a.isBoolean(this.autoRender)?(document.body||document.documentElement):this.autoRender)}if(this.rendered){a.Node.removeClass(this.outerEl,this.hiddenClass);if(this.outerEl.currentStyle.display=="none"){a.Node.show(this.outerEl)}if(this.outerEl.currentStyle.visibility=="hidden"){this.outerEl.style.visibility=""}b.onShow.apply(b,arguments)}this.fireEvent("show",this);return this},onShow:a.noopFn,hide:function(){var b=this;if(this.fireEvent("beforehide",this)===false){return this}this.hidden=true;if(this.rendered){a.Node.addClass(this.outerEl,this.hiddenClass);if(this.outerEl.currentStyle.display!="none"){a.Node.hide(this.outerEl)}b.onHide.apply(b,arguments)}this.fireEvent("hide",this);return this},onHide:a.noopFn,setVisible:function(b){return this[b?"show":"hide"]()},isHidden:function(){return this.hidden},isVisible:function(){return this.rendered&&a.Node.isVisible(this.outerEl)},addClass:function(b){if(this.outerEl){a.Node.addClass(this.outerEl,b)}else{this.cls=this.cls?this.cls+" "+b:b}},removeClass:function(b){if(this.outerEl){a.Node.removeClass(this.outerEl,b)}else{if(this.cls){this.cls=this.cls.split(" ").remove(b).join(" ")}}return this},cloneConfig:function(c){c=c||{};var d=c.id||this.ctype+"_"+a.id();var b=a.mix(c,this.initialConfig);b.id=d;return b},findParentBy:function(b){var c=this.ownerCt;while(c&&!b(c,this)){c=c.ownerCt}return c||null},findParentByType:function(b){return a.isFunction(b)?this.findParentBy(function(c){return c.constructor===ctype}):this.findParentBy(function(c){return c.constructor.ctype===ctype})},clearListeners:function(){var c=this.events,d;for(var b in c){if(c.hasOwnProperty(b)){d=c[b];if(d.isEvent){d.clearListeners()}}}},getBubbleTarget:function(){return this.ownerCt},isFloating:function(){return this.floating},isDraggable:function(){return !!this.draggable},isDroppable:function(){return !!this.droppable},destroy:function(f){if(this.isDestroyed===true){return}if(this.fireEvent("beforedestroy",this)===false){return}this.destroying=true;if(this.beforeDestroy){this.beforeDestroy()}if(this.ownerCt&&this.ownerCt.remove){this.ownerCt.remove(this,false);delete this.ownerCt}if(this.focusTask&&this.focusTask.cancel){this.focusTask.cancel()}if(this.onDestroy){this.onDestroy()}a.ComponentManager.unregister(this.id);this.fireEvent("destroy",this);if(this.clearListeners){this.clearListeners()}if(this.$el){this.ownerWindow.jQuery.cleanData(this.$el)}if(this.el&&(this.el.onclick||this.el.ondblclick)){this.el.onclick=this.el.ondblclick=null}if(this.$outerEl){this.ownerWindow.jQuery.cleanData(this.$outerEl)}if(this.outerEl&&(this.outerEl.onclick||this.outerEl.ondblclick)){this.outerEl.onclick=this.outerEl.ondblclick=null}var c;for(var d in this.dom){c=this.dom[d];if(c&&(c.nodeName||c.length)){a.getDom(c).ownerDocument.parentWindow.jQuery.cleanData(typeof c.length=="number"?c:[c])}}c=null;if(this.rendered&&this.el&&this.el.ownerDocument){var b=this.el.ownerDocument.parentWindow.Zving;if(b&&(f||this.removeDomOnDestroy)){b.Dom.removeNode(this.outerEl)}}if(this.deleteMembers){this.deleteMembers("parentEl","container","autoRender","defaultConfig","dom","el","$el","outerEl","$outerEl","targetEl","events","initialConfig","ownerDocument","ownerWindow","_parent")}this.destroying=false;this.isDestroyed=true},deleteMembers:function(){var c=arguments;for(var d=0,b=c.length;d<b;++d){delete this[c[d]]}},beforeDestroy:function(){},onDestroy:function(){}}})();
/*! Tip */
(function(){var c=window.Zving,b=c.Page;function a(j,e){var h,d,f,g;if(typeof e=="object"){f=e.clock;d=e.autoClose;g=e.theme;h=e.msg}else{h=e}this.message=h;this.autoClose=d||false;this.clock=f||9;this.theme=g||"";this.targetEl=c.getDom(j);this.$targetEl=$(this.targetEl);this.id=this.ctype+"_"+c.id(this.targetEl);this.targetEl._components=this.targetEl._components||{};this.targetEl._components[this.ctype]=this.id;this.$targetEl.data("Tip",this);this.initHtml();c.ComponentManager.register(this)}a.AutoCloseTips=[];a.prototype={ctype:"Tip",initHtml:function(){var d=[];d.push('<div class="bodycontent">'+this.message+"</div>");d.push('<div class="tooltipfang"><span class="fang fangbg">◆</span><span class="fang fangfg">◆</span></div>');this.html=d.join("")},setMessage:function(d){this.message=d;this.initHtml();if(this.el){$(".bodycontent",this.el).html(d)}},show:function(f){var o=this;var k;if(f){o.setMessage(f)}if(!this.el||!this.el.parentNode){var d=document.createElement("div");d.id="comp_tip"+(++c.idSeed._seed);d.style.position="absolute";d.style.left="0px";d.style.top="0px";var j=[document.body];k=this.targetEl.parentNode;while(k&&k.tagName){if(k.tagName=="DIV"&&k.currentStyle.position!="static"&&(k.className.indexOf("ui-page")!==-1||k.currentStyle.overflowY=="auto"||k.currentStyle.overflow=="auto")){j.push(k);if(k.className.indexOf("ui-page")!==-1){break}}if(k.tagName=="BODY"){break}k=k.parentNode}k=j[j.length-1];k.appendChild(d);d.className="tooltip"+(this.theme?" tip_"+this.theme:"")+" tooltip-callout"+this.clock;d.innerHTML=this.html;this.el=d}else{k=this.el.parentNode}var h=$(k).offset();var e=this.$targetEl.offset();e.left=e.left-h.left+(k.tagName=="BODY"?0:k.scrollLeft);e.top=e.top-h.top+(k.tagName=="BODY"?0:k.scrollTop);var g=c.Node.getSize(this.targetEl);if(this.targetEl.getAttribute("ztype")&&/date|time/i.test(this.targetEl.getAttribute("ztype"))){var m=c.Node.getSize(this.targetEl.nextSibling);g.width+=m.width}c.Node.show(this.el);var s=c.Node.getSize(this.el);var r=$window.width();if(r-e.left-g.width<100){this.clock=3;if(e.left<50){this.clock=5}}var n=this.clock;var q,p;if(n==2||n==3||n==4){q=e.left-s.width}if(n==8||n==9||n==10){q=e.left+g.width}if(n==6||n==7||n==11||n==12){q=e.left}if(n==11||n==12||n==1){p=e.top+g.height}if(n==5||n==6||n==7){p=e.top-s.height}if(n==5||n==1){q=e.left+g.width-s.width}if(n==9||n==3){p=e.top+g.height/2-s.height/2}this.el.className="tooltip"+(this.theme?" tip_"+this.theme:"")+" tooltip-callout"+this.clock;this.el.style.left=Math.round(q)+"px";this.el.style.top=Math.round(p)+"px";this.el.style.zIndex=100000;if(c.isFirefox){c.Node.hide(o.el);setTimeout(function(){c.Node.show(o.el)},100)}if(this.autoClose){a.AutoCloseTips.push(this)}},hide:function(){if(this.el){c.Node.hide(this.el)}},close:function(){if(this.el){this.el.outerHTML="";this.el=null}},destroy:function(){jQuery.cleanData(this.$targetEl);this.targetEl.onmouseout=this.targetEl.onmouseover=this.targetEl.onclick=null;c.ComponentManager.unregister(this)}};a.show=function(h,e){h=c.getDom(h);if(!h){return}var m,d,f,j;if(typeof e=="string"){e={msg:e}}var k=$(h);if(!c.Node.isVisible(h)){c.Console.log((h.id?"id为"+h.id:"")+(h.name?" name为"+h.name:"")+"的页面元素处于隐藏状态，Tip无法显示");return}var g;if(k.data("Tip")){g=k.data("Tip")}else{g=new a(h,e)}g.autoClose=d;if(f){g.clock=f}g.show();if(g.el.style.left=="0px"){setTimeout(function(){g.close();g.show()},200)}if(!g.autoClose){if(!h._Tips){h._Tips=[]}h._Tips.push(g)}return g};a.getTipCount=function(d){d=c.getDom(d);if(!d._Tips){return 0}return d._Tips.length};a.close=function(e){e=c.getDom(e);if(e._Tips){for(var d=0;d<e._Tips.length;d++){if(e._Tips[d]){e._Tips[d].close()}}e._Tips=[]}};a.closeAll=function(){var d=a.AutoCloseTips;for(var e=d.length;e>0;e--){d[e-1].close();d.splice(e-1,1)}};$document.on("mousedown.tip",a.closeAll);$window.on("unload",function(){$document.off("mousedown.tip")});c.Tip=a})();
/*! MsgPop */
(function(){var f=window.Zving,c=f.isIE,a=f.isGecko,b=f.Page,d=f.Lang;var e=function(o,k,q,h,g){if(!(this instanceof e)){return new e(o,k,q,h,g)}if(!o){return}var p=f.rootWin;var j="z-"+this.ctype+(++f.idSeed._seed);var m=o.length;var n=this;n.id=j;n.width=h?h:(m<100?240:250+Math.floor(m/3));n.height=q?q:100;n.top=0;n.onLoad=null;n.title="";n.url=k?k:null;n.message=o?o:null;n.icon=null;n.timeout=g||3;n.autoShow=true;setTimeout(function(){if(n.autoShow){n.show()}},10)};e._Array=[];e.TOP=0;e.prototype.ctype="MsgPop";e.prototype.show=function(){var k=f.rootWin;var m=k.document;if(!this.parentWindow){this.parentWindow=window}var h=[];h.push('<div class="bodycontent" style="width:'+this.width+'px;">');h.push('<a href="javascript:void(0);" class="closebtn" onclick="MsgPop.close(\''+this.id+'\');"><span class="circle">●</span><span class="fork">×</span></a>');if(this.url){if(this.url.indexOf(":")==-1){h.push('<iframe src="'+f.CONTEXTPATH+this.url+'" ')}else{h.push('<iframe src="'+this.url+'" ')}h.push(' id="_MsgPopFrame_'+this.id+'" boxId="'+this.id+'" allowTransparency="true"  width="100%" height="'+this.height+'" frameborder="0" style="background-color: #transparent; border:none;"></iframe>')}else{h.push(this.message)}h.push("</div>");this.Html=h.join("");var g=k.Zving.$G("_MsgPopBoxDiv");if(!g){g=k.document.createElement("div");g.id="_MsgPopBoxDiv";g.style.cssText="position:fixed; left:50%; top:0; width:1%; height:1px; overflow:visible; z-index:10200;";if(isIE6){g.style.position="absolute"}k.document.body.appendChild(g)}if(e.TOP){g.style.top=e.TOP+"px"}this.MsgPopBoxDiv=g;var j=k.document.createElement("div");j.id=this.id;j.innerHTML=this.Html;j.className="squares msgpop";j.style.width=this.width+40+"px";g.appendChild(j);j.style.marginLeft=-j.clientWidth/2+"px";j.MsgPopInstance=this;k.MsgPop._Array.push(this.id);var n={height:Node.getSize(j).height};j.style.height="1px";j.style.width=j.firstChild.offsetWidth+"px";if(k.location.href.indexOf("/application.")==-1&&k.MsgPop._Array.length==1){n.marginTop=33}$(j).animate(n);j.style.visibility="";if(this.timeout&&this.timeout>0){e.autoClose(this.id,this.timeout)}};e.prototype.close=function(){var g=f.rootWin;this.MsgPopBoxDiv.outerHTML="";g.MsgPop._Array.remove(this.id);g=this.onLoad=this.parentWindow=this.message=null};e.getInstance=function(j){var h=f.rootWin;var g=h.Zving.$G(j);if(!g){return null}return g.MsgPopInstance};e.autoClose=function(j,h){var g=f.rootWin;if(!g.Zving.$G(j)){return}h-=1;if(e.countdown){g.Zving.$G(j+"CloseTip").innerHTML=d.get("MsgPop.Countdown").format(h)}if(h<=0){e.close(j,true)}else{e._closeHand=setTimeout(function(){e.autoClose(j,h)},1000)}};e.close=function(k,h){var g=f.rootWin;var j=function(){f.rootWin.$("#"+k).remove();f.rootWin.Zving.MsgPop._Array.remove(k);j=null};if(h){f.rootWin.$("#"+k).fadeOut("slow",j)}else{j()}};e.closeSelf=function(){if(window!=window.parent){var g=window.frameElement.getAttribute("boxId");if(g){parent.MsgPop.close(g)}}else{if(e._Array.length>0){var h=e._Array[e._Array.length-1];e.close(h)}}};if(f.rootWin!=window){e=f.rootWin.MsgPop}f.MsgPop=e})();
/*! Verify */
(function(){var z=window.Zving,$V=z.Node.getValue,Tip=z.Tip,Lang=z.Lang,Verify={};Verify.autoCloseOther=function(evt,ele){if(!ele){ele=evt.target||evt.srcElement}};Verify.getErrors=function(value,validStr){var msg=[];var anyFlag=false;var features=validStr.split("&&");for(var i=0;i<features.length;i++){var arr=features[i].split("|");var name="";var rule;if(arr.length==2){name=arr[0];rule=arr[1]}else{rule=features[i]}var op="=";if(rule.indexOf("=")<0){if(rule.indexOf(">")>0){op=">"}else{if(rule.indexOf("<")>0){op="<"}}}else{if(rule.charAt(rule.indexOf("=")-1)==">"){op=">="}else{if(rule.charAt(rule.indexOf("=")-1)=="<"){op="<="}}}var fName=null;var fValue=null;var pattern;if(rule.indexOf(op)>0){fName=rule.substring(0,rule.indexOf(op));fValue=rule.substring(rule.indexOf(op)+op.length)}else{fName=rule}if(fName=="Any"){anyFlag=true}else{if(fName=="Regex"){fValue=rule.substring(6);if(value===null||value===""||!fValue){continue}var reg=fValue;if(!reg.startsWith("^")){reg="^"+reg}if(!reg.endsWith("$")){reg+="$"}if(!new RegExp(reg).test(value)){msg.push(name)}}else{if(fName=="Script"){if(!fValue){continue}if(!eval(fValue)){msg.push(name)}}else{if(fName=="NotNull"){if(value===null||value===""){msg.push(name+Lang.get("Verify.NotNull"))}}else{if(fName=="Number"){if(value===null||value===""){continue}if(!z.String.isNumber(value)){msg.push(name+Lang.get("Verify.MustBe")+Lang.get("Verify.Number"))}}else{if(fName=="Time"){if(value===null||value===""){continue}if(!z.String.isTime(value)){msg.push(value+Lang.get("Verify.NotRight")+Lang.get("Verify.Time"))}}else{if(fName=="Int"){if(value===null||value===""){continue}if(!z.String.isInt(value)){msg.push(name+Lang.get("Verify.MustBe")+Lang.get("Verify.Int"))}}else{if(fName=="Date"){if(value===null||value===""){continue}if(!z.String.isDate(value)){msg.push(name+Lang.get("Verify.MustBeRight")+Lang.get("Verify.Date"))}}else{if(fName=="Time"){if(value===null||value===""){continue}if(!z.String.isTime(value)){msg.push(name+Lang.get("Verify.MustBeRight")+Lang.get("Verify.Time"))}}else{if(fName=="DateTime"){if(value===null||value===""){continue}if(!z.String.isDateTime(value)){msg.push(name+Lang.get("Verify.MustBeRight")+Lang.get("Verify.DateTime"))}}else{if(fName=="Email"){if(value===null||value===""){continue}pattern=/^\w+([\-+.]\w+)*@\w+([\-.]\w+)*\.\w+([\-.]\w+)*$/;if(value&&value.match(pattern)==null){msg.push(name+Lang.get("Verify.NotRight")+Lang.get("Verify.Email"))}}else{if(fName=="ZipCode"){if(value===null||value===""){continue}pattern=/^[0-9]\d{5}(?!\d)$/;if(value&&value.match(pattern)==null){msg.push(name+Lang.get("Verify.NotRight")+Lang.get("Verify.Zip"))}}else{if(fName=="CnTel"){if(value===null||value===""){continue}pattern=/^\d{3}-\d{8}|\d{4}-\d{7}$/;if(value&&value.match(pattern)==null){msg.push(name+Lang.get("Verify.NotRight")+Lang.get("Verify.FixedTelNumber"))}}else{if(fName=="CnPhone"){if(value===null||value===""){continue}pattern1=/^\d{3,4}-\d{7,8}$/;pattern2=/^\d{11}$/;if(value&&value.match(pattern1)==null&&value.match(pattern2)==null){msg.push(name+Lang.get("Verify.NotRight")+Lang.get("Verify.TelNumber"))}}else{if(fName=="CnMobile"){if(value===null||value===""){continue}pattern=/^\d{11}$/;if(value&&value.match(pattern)==null){msg.push(name+Lang.get("Verify.NotRight")+Lang.get("Verify.MobileNumber"))}}else{if(fName=="IDCardNo"){if(value===null||value===""){continue}if(!Verify.isIDCardNo(value)){msg.push(name+Lang.get("Verify.NotRight")+Lang.get("Verify.IDNumber"))}}else{if(fName=="Length"){if(value===null||value===""){continue}if(isNaN(fValue)){msg.push(Lang.get("Verify.RuleError")+Lang.get("Verify.BackOfLength")+Lang.get("Verify.Number"))}else{try{var len=parseInt(fValue,10);if(op=="="&&value.length!=len){msg.push(name+Lang.get("Verify.Length")+Lang.get("Verify.MustBe")+len+Lang.get("Verify.char"))}else{if(op==">"&&value.length<=len){msg.push(name+Lang.get("Verify.Length")+Lang.get("Verify.MustGreaterThan")+len+Lang.get("Verify.char"))}else{if(op==">="&&value.length<len){msg.push(name+Lang.get("Verify.Length")+Lang.get("Verify.MustEqualOrGreaterThan")+len+Lang.get("Verify.char"))}else{if(op=="<"&&value.length>=len){msg.push(name+Lang.get("Verify.Length")+Lang.get("Verify.MustLessThan")+len+Lang.get("Verify.char"))}else{if(op=="<="&&value.length>len){msg.push(name+Lang.get("Verify.Length")+Lang.get("Verify.MustEqualOrLessThan")+len+Lang.get("Verify.char"))}}}}}}catch(ex){msg.push(Lang.get("Verify.RuleError")+Lang.get("Verify.BackOfLength")+Lang.get("Verify.Int")+ex.message)}}}}}}}}}}}}}}}}}}}}return msg};Verify.checkOne=function(evt,ele){if(!ele){ele=evt.target||evt.srcElement}if(ele._verifyFor){ele=ele._verifyFor}if(ele.disabled==true){return}var $ele=$(ele);var validStr=ele.getAttribute("verify");if(!validStr){Verify.closeTip(null,ele);return}var condition=ele.getAttribute("condition");if(condition&&!eval(condition)){Verify.closeTip(null,ele);return}var value=$V(ele);if(ele.type=="radio"||ele.type=="checkbox"){if(ele.name){value=$NV(ele.name)}}if(value){value=(""+value).trim().replace(/\xa0/g,"\x20")}var msg=Verify.getErrors(value,validStr);if(msg.length>0){var txt=msg.join("<br>");Verify.closeTip(null,ele);var tip;ele._VerifyMsg=txt;ele._VerifyHasErr=true;if(z.Node.isVisible(ele)){if(!$ele.data("Tip")){var afterEle=$(ele).data("showTipAfter");if(afterEle){tip=new z.Tip(z.getDom(afterEle),{msg:txt,theme:"notice"})}else{tip=new z.Tip(ele,{msg:txt,theme:"notice"})}tip.AutoClose=true;$ele.data("Tip",tip)}$ele.data("Tip").setMessage(txt);$ele.data("Tip").show()}else{var $page=$(ele).closest("div.ui-page");var $tabs=$("a.z-tab");var pageurl=$page.attr("data-url");if($page.length&&$tabs.length&&pageurl){$tabs.each(function(){if(this.getAttribute("data-href")){var a=this,$a=$(a);if(pageurl.indexOf(a.getAttribute("data-href").replace(/^(\.\.\/)+/,""))!=-1){if(!$a.data("Tip")){var tip=new z.Tip(a,{msg:Lang.get("Verify.TabPageHasError"),theme:"notice"});tip.AutoClose=true;tip.Clock=9;$a.data("Tip",tip)}setTimeout(function(){$a.data("Tip").setMessage(txt);$a.data("Tip").show()},200);return}}})}if(!$tabs.length){MsgPop(Lang.get("Verify.HiddenElemHasError"))}}return true}else{if((ele.type=="radio"||ele.type=="checkbox")&&ele.name){$N(ele.name).each(function(el){Verify.closeTip(null,el)})}else{Verify.closeTip(null,ele)}}};Verify.closeTip=function(evt,ele){if(!ele){ele=evt.target||evt.srcElement}if(ele.type=="blur"){ele=ele.target||ele.srcElement}if(ele._verifyFor){ele=ele._verifyFor}if($(ele).data("Tip")){$(ele).data("Tip").hide();ele._VerifyMsg=null;ele._VerifyHasErr=null}};Verify.closeAllTip=function(ele){ele=z.getDom(ele||document.body);var $inputs;ele=z.getDom(ele||document.body);$inputs=$("input,textarea,select",ele);$inputs.each(function(){Verify.closeTip(null,this)})};Verify.hasError=function(noCheckSelector,ele,noDialog){var $inputs;ele=z.getDom(ele||document.body);if("INPUT,TEXTAREA,SELECT".indexOf(ele.tagName)!=-1){$inputs=$(ele)}else{$inputs=$("input,textarea,select",ele)}if(noCheckSelector){if(typeof noCheckSelector!="string"){z.Console.error("传入Verify.hasError的第一个参数应该为一个元素选择器字符串");return}$inputs=$inputs.not(noCheckSelector);$(noCheckSelector).each(function(){Verify.closeTip(null,this)})}var firstEle=false;for(var i=0;i<$inputs.length;i++){var el=$inputs[i];Verify.checkOne(null,el);if(!firstEle&&el._VerifyHasErr){firstEle=el}}if(firstEle){if(noDialog===true){try{firstEle.focus()}catch(e){}}else{Dialog.alert(Lang.get("Verify.HasError"),function(){try{firstEle.focus()}catch(e){}})}return true}return false};Verify.check=function(ele){return Verify.hasError(null,ele,true)};Verify._cache={};Verify.initCtrl=function(elem){ele=z.getDom(typeof elem=="string"?elem:elem.id||elem);var validStr=ele.getAttribute("verify");var ztype;if(validStr){ztype=ele.getAttribute("ztype");if(ztype){ztype=ztype.toLowerCase()}var eventTarget;if(ztype&&ztype=="select"){eventTarget=Node.nextElement(ele);eventTarget._verifyFor=ele}else{eventTarget=ele}var $eventTarget=$(eventTarget);$eventTarget.on("focus",Verify.checkOne);$eventTarget.on("focus",Verify.autoCloseOther);$eventTarget.on("keyup",Verify.checkOne);$eventTarget.on("change",Verify.checkOne);$eventTarget.on("blur",Verify.closeTip);if(!z.isIE){$(ele).on("input",Verify.checkOne,false)}var condition=ele.getAttribute("condition");if(validStr.indexOf("NotNull")>=0){ztype=ele.getAttribute("ztype");if(ztype){ztype=ztype.toLowerCase()}if(ztype=="select"){ele=$(ele).closest("div")[0]}if(/^date|time|Number$/i.test(ztype)){ele=z.getDom(ele.id||ele).nextSibling}if(ele.type=="radio"||ele.type=="checkbox"){if(ele.name){var sameNameEls=z.$N(ele.name);ele=sameNameEls[sameNameEls.length-1];sameNameEls.each(function(el){$(el).data("showTipAfter",ele)})}return}if(ele.getAttribute("showtipafter")){$(ele).data("showTipAfter",$(ele.getAttribute("showtipafter"))[0])}if(!ele.nextSibling||!ele.nextSibling.getAttribute||ele.nextSibling.getAttribute("ztype")!="Verify"){var display="";if(!z.Node.isVisible(ele)&&z.Node.isVisible(ele.parentNode)){display="display:none"}ele.insertAdjacentHTML("afterEnd","<span style='color:red;padding-left:2px;"+display+"' ztype='Verify'>*</span>")}}}};Verify.getBirthDateFromIDCardNo=function(id){if(id==null){return null}if(id.length==15){return"19"+id.substring(6,8)+"-"+id.substring(8,10)+"-"+id.substring(10,12)}if(id.length==18){return id.substring(6,10)+"-"+id.substring(10,12)+"-"+id.substring(12,14)}return null};Verify.getGenderFromIDCardNo=function(id){if(id==null){return null}if(id.length==15){return"13579".indexOf(id.substring(14,15))!=-1?"M":"F"}if(id.length==18){return"13579".indexOf(id.substring(16,17))!=-1?"M":"F"}return null};Verify.isIDCardNo=function(id){if(!id){return false}id=id.toLowerCase();if(id.length!=15&&id.length!=18){return false}var y,m,d;if(id.length==15){y=parseInt("19"+id.substring(6,8),10);m=parseInt(id.substring(8,10),10);d=parseInt(id.substring(10,12),10)}else{if(id.length==18){if(id.indexOf("x")>=0&&id.indexOf("x")!=17){return false}var verifyBit;var sum=id.charAt(0)*7+id.charAt(1)*9+id.charAt(2)*10+id.charAt(3)*5+id.charAt(4)*8+id.charAt(5)*4+id.charAt(6)*2+id.charAt(7)*1+id.charAt(8)*6+id.charAt(9)*3+id.charAt(10)*7+id.charAt(11)*9+id.charAt(12)*10+id.charAt(13)*5+id.charAt(14)*8+id.charAt(15)*4+id.charAt(16)*2;sum=sum%11;switch(sum){case 0:verifyBit="1";break;case 1:verifyBit="0";break;case 2:verifyBit="X";break;case 3:verifyBit="9";break;case 4:verifyBit="8";break;case 5:verifyBit="7";break;case 6:verifyBit="6";break;case 7:verifyBit="5";break;case 8:verifyBit="4";break;case 9:verifyBit="3";break;case 10:verifyBit="2";break}if(id.charAt(17)!=verifyBit){return false}y=parseInt(id.substring(6,10),10);m=parseInt(id.substring(10,12),10);d=parseInt(id.substring(12,14),10)}}var currentY=new Date().getFullYear();if(!y||y>currentY||y<1870){return false}if(!m||m<1||m>12){return false}if(!d||d<1||d>31){return false}return true};z.Verify=Verify})();(function(){var a=window.Zving;a.Layer=function(b){b=b||{};if(b.tagName||typeof b=="string"){b={el:b}}a.mix(this,b,{ctype:"Layer",id:"z-layer"+(++a.idSeed._seed)});var d=b.parentEl||b.renderTo||document.body;if(this.el){this.ownerDocument=this.el.ownerDocument;this.ownerWindow=this.el.ownerDocument.parentWindow}else{this.ownerDocument=d.ownerDocument;this.ownerWindow=d.ownerDocument.parentWindow;var c=this.ownerDocument.createElement("div");c.className="z-layer";c=d.appendChild(c);this.el=c}this.dom={};this.$el=this.ownerWindow.$(this.el);if(this.cls){this.el.className+=" "+this.cls}this.constrain=b.constrain!==false;this.el.style.zIndex=b.zIndex||this.getZIndex();this.el.style.position="absolute";this.$el.hide()};a.Layer.prototype={ctype:"Layer",zIndex:11000,defaultAlign:"lb",getZIndex:function(){return this.zIndex||parseInt((this.getShim()||this.el).currentStyle.zIndex,10)||11000},getShim:function(){if(!this.useShim){return null}if(this.shim){return this.shim}},remove:function(){this.destroy(true)},constrainXY:function(){if(this.constrain){var n=a.Dom.getViewport(this.ownerWindow),j=n.width,d=n.height;var o=Math.max(this.ownerDocument.documentElement.scrollTop,this.ownerDocument.body.scrollTop);var c=Math.max(this.ownerDocument.documentElement.scrollLeft,this.ownerDocument.body.scrollLeft);var q=this.$el.offset();var k=q.x,g=q.y;var b=this.shadowOffset||0;var m=this.el.offsetWidth+b,e=this.el.offsetHeight+b;var f=false;if((k+m)>j+c){k=j-m-b;f=true}if((g+e)>d+o){g=d-e-b;f=true}if(k<c){k=c;f=true}if(g<o){g=o;f=true}if(f){if(this.avoidY){var p=this.avoidY;if(g<=p&&(g+e)>=p){g=p-e-5}}q=[k,g];this.storeXY(q);a.Node.setPosition(this.el,q)}}return this},alignTo:function(c,g,e){var d=this;var f=a.Node.anchorPos(this.el,c,g||this.defaultAlign,this.reAlign,this.defaultOffsets,true);if(this.ownerWindow!=window){var b=a.Dom.getFrameOffset();f.x+=b.left;f.y+=b.top}a.Node.setPosition(this.el,f)},setSize:function(c,b){this.width=(c!==undefined)?c:this.width;this.height=(b!==undefined)?b:this.height;a.Node.setSize(this.el,c,b);this.width=c;this.height=b},show:function(){this.hidden=false;if(this.el.currentStyle.display=="none"){this.el.style.display="block"}if(this.el.currentStyle.visibility=="hidden"){this.el.style.visibility=""}},hide:function(){this.hidden=true;if(this.el.currentStyle.display!="none"){this.el.style.display="none"}},isVisible:function(){return a.Node.isVisible(this.el)},storeXY:function(b){delete this.lastLT;this.lastXY=b},destroy:function(b){jQuery.cleanData(this.$el);if(!b){a.Dom.removeNode(this.el)}var c;for(var d in this.dom){c=this.dom[d];if(c&&(c.nodeName||c.length)){this.ownerWindow.jQuery.cleanData(typeof c.length=="number"?c:[c])}}delete this.el;delete this.$el;delete this.parentEl;delete this.ownerDocument;delete this.ownerWindow}}})();
/*! Dialog */
(function(){var g=window.Zving,d=g.isIE,c=g.Page,e=g.Lang,b;var f=g.Cookie.get("zcms_skin");if(f&&f!="zvingclassic"){g.importCss("resources/dialogskins/"+f.toLowerCase()+"/default.css")}b=function(h){this.defaultConfig={okText:e.get("Common.OK"),cancelText:e.get("Common.Cancel"),buttons:[],autoRender:g.rootDoc.body};if(!(this instanceof b)){return g.ComponentManager.getByDom(g.getDom(h),"Dialog")}if(h&&h.id&&b.list[h.id]){g.Console.warn("id为 "+h.id+" 的dialog已存在。");return b.list[h.id]}if(typeof h=="string"){if(arguments.length==4){h={title:arguments[0],url:arguments[1],width:arguments[2],height:arguments[3]}}else{if(/^https?:\/\/|^[a-z]+\:|\w+\.\w+((\?[\w=&+]*)*(#[\w=&+]*)*)$/.test(h)){h={url:h}}else{if(/^\w+\d*$/.test(h)){h={id:h}}else{h={html:h}}}}}b.superclass.constructor.call(this,h)};b.disableTimeout=2000;b.isHideScrollbar=false;b.isPreventScroll=true;var a="aui";b.htmlTemplate='<div class="{clsPrefix}_outer"><table class="{clsPrefix}_border"><tbody><tr><td class="{clsPrefix}_nw"></td><td class="{clsPrefix}_n"></td><td class="{clsPrefix}_ne"></td></tr><tr><td class="{clsPrefix}_w"></td><td class="{clsPrefix}_c"><div class="{clsPrefix}_inner"><table class="{clsPrefix}_dialog"><tbody><tr><td class="{clsPrefix}_header"><div class="{clsPrefix}_titleBar"><div class="{clsPrefix}_title"></div><a class="{clsPrefix}_close" href="javascript:/*close*/;">\xd7</a></div></td></tr><tr><td style="padding:0;"><div class="{clsPrefix}_icon"><div class="{clsPrefix}_iconBg"></div></div><div class="{clsPrefix}_main"><div class="{clsPrefix}_content"></div></div></td></tr><tr><td class="{clsPrefix}_footer"><div class="{clsPrefix}_buttons"></div></td></tr></tbody></table></div></td><td class="{clsPrefix}_e"></td></tr><tr><td class="{clsPrefix}_sw"></td><td class="{clsPrefix}_s"></td><td class="{clsPrefix}_se"></td></tr></tbody></table></div>';b.htmlTemplate=b.htmlTemplate.replace(/\{clsPrefix\}/g,a);b.buttonTemplate='<button class="z-dlg-button {cls}" id="{id}" onclick="{fn}">{text}</button>';g.Class.extend(b,g.UICompBase,{id:null,ctype:"Dialog",baseCls:"z-dialog",url:"",title:"",width:null,height:null,minWidth:200,minHeight:60,top:"50%",left:"50%",onOk:null,onCancel:null,okText:e.get("Common.OK"),cancelText:e.get("Common.Cancel"),OKClass:"z-dialog-okbutton",cancelClass:"z-dialog-cancelbutton",onInit:null,onReady:null,onLoad:null,onClose:null,iconDataURL:null,message:"",showButtonRow:true,animator:true,resizable:false,modal:true,animateTarget:null,follow:null,followEl:null,closable:true,draggable:true,esc:true,autoClose:null,closeTip:"? 秒后自动关闭",padding:"20px 25px",html:'<div class="'+a+'_loading"><span>loading..</span></div>',zIndex:10100,fixed:!g.isMobile&&!g.isIE6,renderTpl:b.htmlTemplate,bottonTpl:b.buttonTemplate,highlightButtonCls:a+"_state_highlight",hidden:true,removeDomOnDestroy:true,autoShow:false,contentElClass:a+"_content",initComponent:function(){this.addEvents("move","beforeresize","activate","deactivate","beforeclose","close","afterclose");b.superclass.initComponent.apply(this);this.buttons=this.buttons||[];if(this.hidden===false){this.hidden=true;this.show()}this.opener=window;if(this.url){window.$D=this}},onRender:function(o,k){this.beforeRender();this.dom=this.dom||{};b.superclass.onRender.call(this,o,k);this.$el.css("position",this.fixed?"fixed":"absolute");var p=this.ownerWindow.Zving.getDom("z-dialog-proxy");if(!p){p=g.Dom.createNode({id:"z-dialog-proxy",className:"z-dlg-proxy"},this.ownerDocument);this.ownerDocument.body.appendChild(p)}this.proxy=this.ownerWindow.Zving.getDom(p);this.$proxy=this.ownerWindow.$(p);if(this.modal){var n=this.ownerWindow.Zving.getDom("_DialogShim");if(!n){n=this.ownerWindow.Zving.Dom.createNode({id:"_DialogShim",cls:"z-dlg-shim "+a+"_state_lock"},this.ownerDocument);this.ownerDocument.body.appendChild(n);if(g.isIE6){var m="Math.max(document.documentElement.scrollLeft, document.body.scrollLeft)",j="Math.max(document.documentElement.scrollTop, document.body.scrollTop)",h="(document.documentElement)";n.style.position="absolute";n.style.setExpression("left","eval("+m+') + "px"');n.style.setExpression("top","eval("+j+') + "px"')}else{n.style.position="fixed"}n.style.position=this.fixed?"fixed":"absolute"}this.shim=this.ownerWindow.Zving.getDom(n);this.$shim=this.ownerWindow.$(n);this.$shim.on("click",function(q){if(q.stopPropagation){q.stopPropagation()}else{q.cancelBubble=true}})}},beforeRender:function(){},initContent:function(){var h=this.getContentEl();if(this.html){h.innerHTML=this.html;delete this.html}if(this.contentEl){this.updateContent(this.contentEl)}if(this.tpl){h.innerHTML=g.String.tmpl(this.tpl,this.data||{});delete this.data}},updateContent:function(h,n,m){var q=this.getContentEl();if(h&&h.nodeType==1){this.contentEl=h;var j=this.ownerWindow.Zving.getDom(this.contentEl);var r=j.style.display,k=j.previousSibling,p=j.nextSibling,t=j.parentNode;var s=this;this._elemBack=function(){if(k&&k.parentNode){k.parentNode.insertBefore(j,k.nextSibling)}else{if(p&&p.parentNode){p.parentNode.insertBefore(j,p)}else{if(t){t.appendChild(j)}}}j.style.display=r;s._elemBack=null};g.Node.removeClass(j,this.hiddenClass);this.ownerWindow.jQuery.cleanData(q.getElementsByTagName("*"));q.innerHTML="";q.appendChild(j)}else{if(this.tpl&&typeof h!=="string"){this.ownerWindow.jQuery.cleanData(q.getElementsByTagName("*"));q.innerHTML=g.String.tmpl(this.tpl,h||{})}else{var o=g.isObject(h)?g.Dom.createHtml(h):h;g.Node.update(q,o,n,m)}}},afterRender:function(){this.dom={wrap:this.el,header:true,title:true,main:true,icon:true,iconBg:true,content:true,footer:true,buttons:true,close:true};var k=this.el.getElementsByTagName("*"),h=k.length;for(var j=0;j<h;j++){var m=k[j].className.split(a+"_")[1];if(m){m=m.split(" ")[0];if(m&&this.dom[m]){this.dom[m]=this.ownerWindow.Zving.getDom(k[j]);this.dom["$"+m]=this.ownerWindow.$(k[j])}}}if(this.closable===false){this.dom.$close.hide()}if(this.iconDataURL){if(g.isIE&&g.ieVersion<8&&this.iconStandin){this.dom.iconBg.innerHTML=this.iconStandin}else{this.dom.iconBg.style.backgroundImage="url("+this.iconDataURL+")"}}else{this.dom.$icon.hide()}this.dom.$title.css("cursor",this.draggable?"move":"auto");this.dom.$content.css("padding",this.padding);this.setTitle(this.title);this.initIframe();this.initButtons();this.setSize(this.width,this.height);if(this.autoClose){this.time(this.autoClose)}if(this.followEl){this.followTo(this.followEl)}else{this.setPosition(this.left,this.top)}this.initEvents();this.initResizable();this.initDraggable();if(this.onInit){this.onInit.call(this,window)}},_toNumber:function(h,k){if(!h&&h!==0||typeof h==="number"){return h}var j=h.length-1;if(h.lastIndexOf("px")===j){h=parseInt(h,10)}else{if(h.lastIndexOf("%")===j){h=parseInt(k*h.split("%")[0]/100,10)}}return h},followTo:function(h){var j=g.Dom.computePositionEx(h,this.el);Node.setPosition(this.el,j)},reposition:function(){this.setPosition("50%","50%")},setPosition:function(t,s){if(!this.rendered){this.x=(t!==undefined)?t:this.x;this.y=(s!==undefined)?s:this.y;return this}var m=g.isIE6?false:this.fixed,q=g.isIE6&&this.fixed,w=g.rootWin.document,h=g.Dom.getViewport(g.rootWin),r=h.width,k=h.height,n=Math.max(w.documentElement.scrollLeft,w.body.scrollLeft),z=Math.max(w.documentElement.scrollTop,w.body.scrollTop),p=m?0:n,j=m?0:z,u=Math.max(w.documentElement.scrollWidth,w.body.scrollWidth),o=Math.max(w.documentElement.scrollHeight,w.body.scrollHeight);if(t||t===0){this._x=t.toString().indexOf("%")!==-1?t:null;t=this._toNumber(t,r-this.el.offsetWidth);if(typeof t=="number"){t=q?(t+=n):t+p;this.$el.css("left",Math.max(t,p)+"px")}else{if(typeof t=="string"){this.$el.css("left",t)}}}if(s||s===0){this._y=s.toString().indexOf("%")!==-1?s:null;s=this._toNumber(s,k-this.el.offsetHeight);if(typeof s=="number"){s=q?(s+=z):s+j;this.$el.css("top",Math.max(s,j)+"px")}else{if(typeof s=="string"){this.$el.css("top",s)}}}this.onPosition(t,s);this.x=t;this.y=s;this.fireEvent("move",this,t,s);return this},onPosition:function(h,j){if(h!==undefined&&j!==undefined){this._autoPositionType()}},_autoPositionType:function(){this[this.fixed?"_setFixed":"_setAbsolute"]()},_setFixed:function(){if(g.isIE6){var o=g.rootDoc,n=parseInt(this.$el.css("left"),10)||0,m=parseInt(this.$el.css("top"),10)||0,j=Math.max(o.documentElement.scrollLeft,o.body.scrollLeft),h=Math.max(o.documentElement.scrollTop,o.body.scrollTop),p="Math.max(document.documentElement.scrollLeft, document.body.scrollLeft)",k="Math.max(document.documentElement.scrollTop, document.body.scrollTop)";this._setAbsolute();this.el.style.setExpression("left","eval("+(n+p)+') + "px"');this.el.style.setExpression("top","eval("+(m+k)+') + "px"')}else{this.el.style.position="fixed"}},_setAbsolute:function(){if(g.isIE6){this.el.style.removeExpression("left");this.el.style.removeExpression("top")}this.el.style.position="absolute"},_clickCancel:function(){if(this.onCancel){if(this.onCancel.call(this,window)!==false){this.close()}}else{this.close()}},_clickClose:function(){if(this.onBeforeClose){if(this.onBeforeClose.call(this,window)!==false){this.close()}}else{this.close()}},getTitle:function(){return this.dom.title.innerHTML},setTitle:function(h){if(h===undefined){h=this.title}else{this.title=h}if(this.title===false){this.dom.title.innerHTML="";this.dom.$title.hide();this.$el.addClass(a+"_state_noTitle")}else{this.dom.title.innerHTML=h;this.dom.$title.show();this.$el.removeClass(a+"_state_noTitle")}return this},initIframe:function(){if(!this.url){return}var j=this,h=j.ownerDocument.createElement("iframe");h.src=g.Url.relative2Absolute(j.url);h.id=h.name=j.id+"_dialog_frame";h.style.cssText="border:none 0;border-width: 0;width:100%;height:100%;";h.setAttribute("frameborder","0",0);h.setAttribute("ownerdialogid",j.id);j.dom.iframe=j.ownerWindow.Zving.getDom(h);j.dom.$content.addClass(a+"_state_full");j.dom.content.appendChild(h);j.innerFrame=h;j.innerWin=h.contentWindow;window.$D=j;window.$DW=h.contentWindow;h=null;j.onOk=j.onOk||j.onOK;if(typeof j.onOk=="function"){j._OKFn=j.onOk;j.onOk=function(k){if(j.okButton){j.okButton.disabled=true}j.enableOkButtonTimer=setTimeout(function(){if(j.okButton){j.okButton.disabled=false}},b.disableTimeout);return j._OKFn.call(j,k||window.event,j.innerWin)}}if(typeof j.onCancel=="function"){j._CancelFn=j.onCancel;j.onCancel=function(k){return j._CancelFn.call(j,k||window.event,j.innerWin)}}if(!g.isGecko){j.$innerFrame=j.ownerWindow.$(j.innerFrame);j.$innerFrame.on("load.dialog",function(){j.onIframeLoad.call(j)})}else{j.innerFrame.onload=function(){j.onIframeLoad.call(j)}}j.content=null;j.$content=null},onIframeReady:function(){this.dom.$loadingEl=this.dom.$content.find("."+a+"_loading");this.dom.$loadingEl.hide();if(this.onReady){this.onReady.call(this,this.innerWin);this.onReady=null}},onIframeLoad:function(){this.dom.$loadingEl=this.dom.$content.find("."+a+"_loading");this.dom.$loadingEl.hide();if(this.onLoad){this.onLoad.call(this,this.innerWin);this.onLoad=null}},getContentEl:function(){return this.dom.content||(this.dom.content=this.$el.find("."+this.contentElClass)[0])},initButtons:function(){var j=this;if(this.onOK&&!this.onOk){this.onOk=this.onOK}if(this.onOk){this.buttons.push({text:this.okText,fn:this.onOk,id:this.id+"-OKButton",cls:this.OKClass,focus:true})}if(this.onCancel){this.buttons.push({text:this.cancelText,fn:this._clickCancel,id:this.id+"-cancelButton",cls:this.cancelClass,focus:(this.onOk?false:true)})}if(this.buttons.length<1){this.dom.$buttons.hide()}else{for(var h=0;h<this.buttons.length;h++){this.addButton(this.buttons[h])}}},disableButton:function(h){this.ownerWindow.$("#"+h).disable()},enableButton:function(h){this.ownerWindow.$("#"+h).enable()},addButton:function(k,r,q,j,t,s){var m;if(typeof k!="object"){m={text:r,fn:q,id:(k||this.id+"-button"+this.buttons.length),cls:s||"",focus:!!t}}else{m=k}var o,p=this;if(this.dom&&this.dom.buttons){var n=p.ownerDocument.createElement("button");if(m.text){n.value=m.text;n.innerText=m.text}if(m.id){n.id=m.id;if(n.id==p.id+"-OKButton"){p.okButton=n}else{if(n.id==p.id+"-cancelButton"){p.cancelButton=n}}}if(m.cls){n.className="z-dlg-button "+m.cls}p.dom.buttons.appendChild(n);var h=p.ownerWindow.$(n);if(m.fn){h.on("click",$.proxy(m.fn,p))}if(m.focus){h.addClass(p.highlightButtonCls);setTimeout(function(){try{n.focus()}catch(u){}},1)}return this.dom.buttons[j?"lastChild":"firstChild"]}else{this.buttons[j?"push":"unshift"](m)}},initEvents:function(){var h=this;h.manager=h.manager||b.Manager;h.manager.register(h);h.dom.$close.on("mousedown",$.proxy(h._clickClose,h))},time:function(h){var j=this;if(this.closed){clearTimeout(this._timer);return}if(h){this.autoClose=h;this._timer=setTimeout(function(){j.time()},1000);return}this.autoClose--;if(this.title!==false){this.setTitle(this.closeTip.format(this.autoClose))}if(this.autoClose<=0){this._clickClose()}else{this._timer=setTimeout(function(){j.time()},1000)}},initResizable:function(){if(this.resizable){this.resizer=new g.Resizable({el:this.el,minWidth:200,minheight:100,handles:this.resizeHandles,resizeElement:this.resizerAction,handleCls:"z-window-handle"});this.beforerresize=function(){this.fireEvent("beforeresize")}}},initDraggable:function(){if(this.dom.header&&this.draggable&&g.rootWin.Zving.SimpleDrag){this.dd=new g.rootWin.Zving.SimpleDrag({dragEl:this.el,handleEl:this.dom.header,capture:true})}},content:function(h){if(h===undefined){return this.dom.content}if(typeof h=="string"){this.updateContent(h);return}if(g.isElment(h)){var n=h.style.display,m=h.previousSibling,k=h.nextSibling,j=h.parentNode;this._elemBack=function(){if(m&&m.parentNode){m.parentNode.insertBefore(h,m.nextSibling)}else{if(k&&m.parentNode){k.parentNode.insertBefore(h,k)}else{if(j){j.appendChild(h)}}}h.style.display=n};if(this.dom.content.innerHTML){this.ownerWindow.jQuery.cleanData(this.dom.content.getElementsByTagName("*"));this.dom.content.innerHTML=""}this.dom.content.appendChild(h);g.Node.show(h)}},onEsc:function(h){g.stopEvent(h);this._clickCancel()},setShimSize:function(){if(this.modal){var k=false;if(!g.Node.isVisible(this.shim)){k=true}if(k){this.$shim.css("visibility","hidden");this.$shim.show()}g.Node.setSize(this.shim,"100%","100%");var j=this.shim.offsetHeight;var h=g.Dom.getViewport(this.ownerWindow).height;if(h>j){g.Node.setSize(this.shim,undefined,h)}if(k){g.Node.hide(this.shim);this.$shim.css("visibility","visible")}}},onWindowResize:function(){this.setShimSize();this.doConstrain()},beforeShow:function(){},show:function(h){if(!this.rendered){this.render(this.autoRender)}if(this.hidden===false){this.toFront();return this}if(this.fireEvent("beforeshow",this)===false){return this}this.hidden=false;this.beforeShow();this.animateTarget=h||this.animateTarget;if(this.animateTarget){this.animShow()}else{this.afterShow()}if(this.modal){if(!g.Node.isVisible(this.shim)){this.setShimSize();if(this.animator){g.rootWin.Node.setOpacity(this.shim,3);this.$shim.show();this.$shim.fadeIn()}else{this.$shim.show()}}}return this},afterShow:function(h){this.$proxy.hide();this.$el.show();if(this.monitorResize||this.modal||this.constrain){if(g.rootWin.Zving.EventManager){g.rootWin.Zving.EventManager.onWindowResize(this.onWindowResize,this)}}this.doConstrain();this.doLayout();this.toFront();this.onShow();this.fireEvent("show",this)},animShow:function(){this.$proxy.show();g.Node.setBox(this.proxy,g.Node.getBox(this.animateTarget));g.Node.setOpacity(this.proxy,0);var h=this.getBox();this.$el.css("display","none");this.$proxy.animate(g.mix(h,{opacity:0.5}),this.afterShow)},onShow:g.noopFn,toFront:function(h){if(this.manager.bringToFront(this)){if(!h||!h.getTarget().focus){this.focus()}}return this},toBack:function(){this.manager.sendToBack(this);return this},setActive:function(k){if(k){var h=g.rootWin.Zving.Dialog.front,j=g.rootWin.Zving.Dialog.front.lastZIndex;this.setZIndex(j);if(this.modal&&this.shim){this.$shim.show()}this.addClass(a+"_state_focus");this.fireEvent("activate",this)}else{this.removeClass(a+"_state_focus");this.fireEvent("deactivate",this)}},hide:function(k,h,j){if(this.hidden||this.fireEvent("beforehide",this)===false){return this}if(h){this.on("hide",h,j)}this.hidden=true;if(this.modal){}this.animateTarget=k||this.animateTarget;if(this.animateTarget){this.animHide()}else{this.$el.hide();this.afterHide()}return this},afterHide:function(){this.$proxy.hide();if(this.monitorResize||this.modal||this.constrain){g.rootWin.Zving.EventManager.removeResizeListener(this.onWindowResize,this)}this.onHide();this.fireEvent("hide",this)},animHide:function(){g.Node.setOpacity(this.proxy,0.5);this.$proxy.show();var h=this.getBox(false);g.Node.setBox(this.proxy,h);this.$el.hide();this.$proxy.animate(g.mix(g.Node.getBox(this.animateTarget),{opacity:0}),this.afterHide)},onHide:g.noopFn,doConstrain:function(){if(this.container.nodeName=="BODY"){return}var m;if(this.constrain){var k=this.getSize();m={right:-(k.width-50),bottom:-(k.height-25)}}var p=g.Node.getConstrainToXY(this.el,this.container,true,m);if(p){var o=g.isIE6?false:this.fixed;if(o){var n=g.rootWin.document,h=Math.max(n.documentElement.scrollLeft,n.body.scrollLeft),j=Math.max(n.documentElement.scrollTop,n.body.scrollTop);p[0]=p[0]-h;p[1]=p[1]-j}this.setPosition(p[0],p[1])}},doLayout:g.noopFn,close:function(){if(this.isDestroyed===true){return}if(this.fireEvent("beforeclose",this)!==false){if(this.hidden){this.doClose()}else{this.hide(null,this.doClose,this)}}},doClose:function(){if(this.onClose){this.onClose.call(this,this.innerWin);this.onClose=null}this.fireEvent("close",this);this.destroy()},beforeDestroy:function(){if(this.enableOkButtonTimer){clearTimeout(this.enableOkButtonTimer)}if(this.rendered&&this.dom){this.destroyIframe();if(this.dom.$loadingEl){this.ownerWindow.jQuery.cleanData(this.dom.$loadingEl)}if(this.dom.$close){this.dom.$close.off()}this.okButton=this.cancelButton=null;this.ownerWindow.jQuery.cleanData(this.dom.buttons.getElementsByTagName("BUTTON"));this.buttons.length=0;if(this.proxy){this.$proxy=this.proxy=null}if(this.shim){this.$shim=this.shim=null}if(this.contentEl){delete this.contentEl}if(this.dd&&this.dd.proxyEl){g.rootWin.Zving.Dom.removeNode(this.dd.proxyEl)}if(this._elemBack){this._elemBack();this._elemBack=null}}},destroyIframe:function(){var h=this;if(!h.dom||!h.dom.iframe){return}window.$DW=null;h.innerWin=h.innerDoc=null;if(!g.isGecko){h.$innerFrame.off("load.dialog")}else{h.innerFrame.onload=null}h.innerFrame.src="about:blank";g.Dom.removeNode(h.dom.iframe);h.$innerFrame=h.innerFrame=null},onDestroy:function(){if(this.dd){this.dd.destroy();delete this.dd}if(this.manager){this.manager.unregister(this)}this._CancelFn=this._OKFn=this.onOk=this.onOK=this.onCancel=this.onLoad=this.onReady=this.onClose=null;b.superclass.onDestroy.call(this)},setZIndex:function(h){if(h===undefined){h=this.zIndex}if(this.modal){this.$shim.css("z-index",h)}this.el.style.zIndex=(++h);this.zIndex=h;h+=5;this.lastZIndex=h;return this},setSize:function(j,k){this.onSetSize(j,k)},onSetSize:function(j,k){if(this.url){j=j||"61.8%";k=k||"61.8%"}this.dom.$main.css("min-width",this.minWidth+"px");if(g.isIE6||g.isIE7||(document.documentMode&&document.documentMode<8)){this.dom.$main.css("width",this.minWidth+"px")}if(j){this._width=j.toString().indexOf("%")!==-1?j:null;var n=g.Dom.getViewport(g.rootWin).width-this.el.offsetWidth+this.dom.main.offsetWidth;j=this._toNumber(j,n);if(typeof j=="number"){this.$el.css("width","auto");this.dom.$main.css("width",Math.max(this.minWidth,j)+"px");this.$el.css("width",this.el.offsetWidth+"px")}else{if(typeof j=="string"){this.dom.main.style.width=j;if(j=="auto"){this.$el.css("width","auto")}}}}if(k){this._height=k.toString().indexOf("%")!==-1?k:null;var m=g.Dom.getViewport(g.rootWin).height-this.el.offsetHeight+this.dom.main.offsetHeight;k=this._toNumber(k,m);if(typeof k=="number"){this.dom.$main.css("height",Math.max(this.minHeight,k)+"px")}else{if(typeof k=="string"){this.dom.$main.css("height",k)}}}this.fireEvent("resize",this);return this},dragstart:function(h){h.proxy=this.proxy}});g.mix(b.prototype,{shake:function(){var h=this.el.style,k=[4,8,4,0,-4,-8,-4,0],j=function(){h.marginLeft=k.shift()+"px";if(k.length<=0){h.marginLeft=0;clearInterval(timerId)}};k=k.concat(k.concat(k));timerId=setInterval(j,13);return this}});g.mix(b,{alert:function(k,j,h){if(h===false){return b.warn(k,j)}return new b({autoShow:true,iconDataURL:"data:image/gif;base64,R0lGODlhIgAiANUAAAAAAP///+X4jO36r/H7w6C8FqK+GKTAGqXBG6bCHKfDHajEHqvHIa3JI7DMJrPPKbbSLLjULrvXMb3ZM7/bNcHdN8PfOcfjPczoQs3pQ8/rRdLuSNPvSdXxS9j0TtfzTdn1T9z2V932Xt32ZOD2cuT4eeX4huv6oe/6tf+nEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAACkALAAAAAAiACIAAAb/wJRwSBwSBgQU6kgoOp9Fwmn0CVmvn9GpCe0STJ+sVTQaiazUj4nbJaLCpNDI89FgMJqPZxQihVFtQyYgHiEiHRUOBwiMCAcOFR1nHiAmgSUfJCMcEguNBgcHBo0LEhwjfiVdJWgZDY0IBhAbGxCjjQ0ZfCGqTgIgmhcKsAkQRBAJsAoXqCACUXojGcOwBx1EHYvKunRsKWAhHAywjNbY2rAMHCFqRpkiFOSMBcZDEAXyCBQiflwnVh2oyTMQoUOHCLfkKehg5YSQMiMq5PtkoOJERhUgpiBQxYODi6BCibrooNCHI1Y+oCOXwIJBgxaS5TtQJQQSQxou0iSi8qKGxTNJ5GDQeW1ItosY+CgRSvQcUqUEcDY1upLczxAo2VVtZI7qRJpWkHT8OLOokKP5SrJrAlFiWaf5MpYR8i9EwLdeFTIM4XDju3jyup7dqo/fSUFVxAU2mwJtunXt3O2ZRk5w46oKuB0m8iuYQEcfeK5c1uyZE1ZyXHF9MKH1hAfocu3q9QSTJk6eYlXczajUqVSBBhU6lGjlo0iTKgUS8iaTHDp28ETr82e5ETBiDJU5IyfMGutRptS8wk6LN/BRkChhYj0IADs=",iconStandin:"i",html:""+k,cancelText:e.get("Common.OK"),onCancel:function(){if(j){j()}}})},warn:function(j,h){return new b({autoShow:true,iconDataURL:"data:image/gif;base64,R0lGODlhIgAiAOYAAAAAAP/////58v/Ysv/ZtP/atv/cuf/dvP/hw//mzf/p0//t2//v3//x4//z5//06f/37//48f/Sqf/Sqv/Vrv/Wr//WsP/Ztf/ev//fwP/gwv/hxP/q1v/r2P/w4v/y5v/17P/27v/Kn//LoP/Ppf/38P+/kP/FmP/Gmf+5iP+8jP+iaf+qc/+uef+xfv98NP+DP/+LSf+TVP+UVv+aXv9VAP9XAv9YBP9bCP9eDf9jE/9kFv9mF/9nGf9oHf9uIv90Kv9zLf93Lv94NP+KUP+MU/+SW/+mef+sg/+0jv+1kP/CpP/Msv/Pt//dzP/u5f/z7f/ezv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAFIALAAAAAAiACIAAAf/gFKCg4SFhoeIiYQRCAMIEYqRhwsDlY6SmIIQlhaVD5mSGpUnIpUYoIoOlRQ9OSSVDaiIB5U0NTUxlQWyhgyVIji3NiaVHbyDApYwt7dClhDHUgqVKczMLpUaxyCWP0RRglFEPRSVDrwZlSw1SoRKNTSVB7IflRM6NUyETDU4pQOxQBmoJOOWvkH8cOkCRWkAihu3khBKIozYAA6YNlV6wQwJISTMgFgKIanRABfWihAqYo1FtkgPKlnoYW3IE0FPhljjUW7AuUQYKq2wVsMHOClRfBCNN2AeogaVSOQgumOJoCU7iPqrxABRgUoxiN46AgXKEbE1YFQicIhDJRM2gtDKtaaiEkZC3CoBmcu3hshKIAilG7AObRAngpoEketyQIZBqgbck2uEkBG5OiaYE0RrgC3KlufOkCfF1wBgcw8LcrJY7tYBDBJUatG3NrMWlRKYrlRhhO/fwIML/y2Bq5TBlpIrX87c0oVBDDY0n079godDJbJr3869+/Zo4MMjCgQAOw==",iconStandin:"!",html:""+j,cancelText:e.get("Common.OK"),onCancel:function(){if(h){h()}}})},confirm:function(k,j,h){return new b({autoShow:true,iconDataURL:"data:image/gif;base64,R0lGODlhIgAiANUAAAAAAP/////Wff/Wfv/Zhv/aiv/cjv/vzf/x0/2oBP6pBf+qBv+qB/+rCv+tD/+uEf+vFv+yGv+yHv+1JP+2J/+2Kf+3Kv+6Nv+/RP/CSv/FVf/HWv/IXf/Obf/Sev/SfP/Tff/Vfv/Yhv/Xh//Zjf/bk//cl//dmv/enf/foP/go//hp//jrP/krf/ms//ouv/qwP/sxv/sx//z2v/LaP/alP/14////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAADcALAAAAAAiACIAAAb/wJtwSBweYDMEYgY7FJ/Q4kG2Mq2uWKvMGe0eXiZTS5VSXcmqVvjF7RIRYVdqdUKNPJ4R6rRKucIIbkMvKidlJRwWCguMCwoWHCVkJyovgn8uKyQZD40JjJ+MDxkkK5hdmWYgE40LDhiwGBcOjRMgK2YuUC4qmR2djA0lUDUMoh2mvVImfCDACwwxXSzGCw+3JyZtN2ApJBGtNIIajREkKSaWQgcmvButCzZENRg1RCytG73aQlQpJc8WQCBig5EEgq0elJgjQ8iKFis4wGMAAdYHDNBYEKEBj8PDFTfYFaIAryQDjUQkwKNASRuMPigWlWx0sghHeApQzEGCa8TMzFb2iFT4OcJMkisefjJyUGToTw9XlCBVuiAEEQNUoa5Y0pPqACICqBZdwQSmzJkiiIhQmnOnyBMkf5ogYkIpSxX8PkqkypeRR4j9+gDsS1Uhw3XtVLybSYAIgZ/6/rTp9o2x45nm0KlD3Cwgo8ZDHsO7RocfEV6+PBcgUmA0MtS7cK1Y1ehs7Vq3cqFqp4lTYVKm2gkiZEgFIkWtHkWaVEmQEDjt5tS5k2dPnz8mAjlfB0YMmjNl1KTbtj0kFStYrmghX57IkSRLmmwPAgA7",iconStandin:"?",html:k,onOk:function(){if(!j){return this.close()}if(j.call(this,window)!==false){this.close()}},onCancel:h||g.noopFn})},prompt:function(m,k,h){h=h||"";var j;return new b({autoShow:true,html:['<div style="margin-bottom:5px;font-size:12px">',m,"</div>","<div>",'<input type="text" value="',h||"",'" style="width:18em;padding:3px 2px" />',"</div>"].join(""),onShow:function(){j=this.dom.$content.find("input")[0];j.select();j.focus()},onOk:function(n){return k&&k.call(this,j.value,n)}})},tips:function(j,h){return new b({autoShow:true,title:false,modal:false,html:'<div style="padding: 0 1em;">'+j+"</div>",autoClose:h||2})},WaitID:null,wait:function(j){var n=0,k;var m=new b({autoShow:true,html:j,onCancel:function(){return false}});var h=function(){if(!m||m.destroying===true){if(k){clearTimeout(k)}return}n++;m.cancelButton.innerText=e.get("Dialog.WaitMessage")+"("+n+")...";m.waitTimer=k=setTimeout(h,1000)};m.waitTimer=k=setTimeout(h,1000);m.on("beforeclose",function(){clearTimeout(k)});return m},getInstance:function(h){return b.Manager.get(h)}});b.list={};b.accessList=[];b.front=null;if(window!=g.rootWin){b.list=g.rootWin.Zving.Dialog.list;b.accessList=g.rootWin.Zving.Dialog.accessList;b.front=g.rootWin.Zving.Dialog.front}b.Manager=function(){var o=function(q){if(b.accessList.length==1){b.front=g.rootWin.Zving.Dialog.front=q}};var p=function(s){if(b.isHideScrollbar){var r=g.rootDoc.getElementsByTagName(g.rootDoc.compatMode=="BackCompat"?"BODY":"HTML")[0];r._styleOverflow=r.style.overflow;if(!d){var q=r.scrollTop;r.style.overflow="hidden";r.scrollTop=q}else{r.style.overflow="hidden"}}if(b.isPreventScroll){Event.lockScroll()}};var h=function(s){if(b.accessList.length<2){if(g.rootWin.Zving.getDom("_DialogShim")){g.rootWin.$("#_DialogShim").hide()}if(b.isHideScrollbar){var r=g.rootDoc.getElementsByTagName(g.rootDoc.compatMode=="BackCompat"?"BODY":"HTML")[0];if(r._styleOverflow!==undefined){if(!d){var q=r.scrollTop;r.style.overflow=r._styleOverflow;r.scrollTop=q}else{r.style.overflow=r._styleOverflow}}}Event.unlockScroll()}Event.unlockScroll()};var k=function(r,q){return(!r._lastAccess||r._lastAccess<q._lastAccess)?-1:1};var n=function(){var s=b.accessList,q=s.length;if(q>0){s.sort(k);var r=s[0].manager.zseed;for(var t=0;t<q;t++){var u=s[t];if(u&&!u.hidden){u.setZIndex(r+(t*10))}}}j()};var m=function(q){if(q!==g.rootWin.Zving.Dialog.front){if(g.rootWin.Zving.Dialog.front){g.rootWin.Zving.Dialog.front.setActive(false)}b.front=g.rootWin.Zving.Dialog.front=q;if(q){q.setActive(true)}}};var j=function(){for(var q=b.accessList.length-1;q>=0;--q){if(!b.accessList[q].hidden){m(b.accessList[q]);return}}m(null)};return{zseed:10100,listenKeydown:function(q,s){q=g.getEvent(q);var r=q.target;if(q.keyCode==27){if(s&&s.ctype=="dialog"){if(r.nodeName&&/^textarea$/i.test(r.nodeName)&&r.defaultValue!=r.value&&r.value.length>2&&!confirm("侦测文本框中的内容已经被修改，你确定要放弃修改吗？")){return}s.onEsc(q)}else{if(g.rootWin.Zving.Dialog.front&&g.rootWin.Zving.Dialog.front.esc){g.rootWin.Zving.Dialog.front.onEsc(q)}}}},closeAll:function(q){if(b.accessList.length>0){b.accessList.each(function(r){if(q){if(r.opener==window){r.close()}}else{r.close()}});return true}return false},register:function(q){b.list[q.id]=q;b.accessList.push(q);q.on("hide",j);q.on("show",p);q.on("beforeclose",h)},unregister:function(q){delete b.list[q.id];q.un("hide",j);q.un("show",p);q.un("beforeclose",h);b.accessList.remove(q)},get:function(q){return typeof q==="object"?q:b.list[q]},bringToFront:function(q){q=this.get(q);if(q!=g.rootWin.Zving.Dialog.front){q._lastAccess=new Date().getTime();n();o(q);return true}return false},sendToBack:function(q){q=this.get(q);q._lastAccess=-(new Date().getTime());n();return q},getActive:function(){return g.rootWin.Zving.Dialog.front}}}();c.onReady(function(){if(g.restricted||!window.frameElement){return}var h;try{h=window.frameElement.getAttribute("ownerdialogid")}catch(k){g.Console.error("没有权限：可能因为跨域，对话框不能与父窗口交互。")}if(!h){return}if(g.Misc&&g.Misc.inputFocus){g.Misc.inputFocus()}var j;if(g.Config.namespace=="window"){j=g.rootWin.Dialog.list[h]}else{j=g.rootWin.Zving.Dialog.list[h]}if(!j){return}window.ownerDialog=j;window.dialogOpener=j.opener;if(j.getTitle()===""&&document.title){if(j.title!==false){j.setTitle(document.title)}}if(j.onIframeReady){j.onIframeReady(window);j.onIframeReady=null}},4);$document.on("keydown",b.Manager.listenKeydown);$window.on("unload",function(){$document.off("keydown",b.Manager.listenKeydown);b.Manager.closeAll(true);window.ownerDialog=window.dialogOpener=null;if(window==g.rootWin){$("#_DialogShim").off()}});g.Dialog=b})();(function(){var g=window.Zving,d=g.Node,f,b,c,a;function e(h,j){return("000000000000000000000"+h).slice(-j)}f=function(h){this.defaultConfig={_childCals:[],container:g.rootDoc.body};if(!(this instanceof f)){return g.ComponentManager.getByDom(g.getDom(h),"Calendar")}f.superclass.constructor.call(this,h)};g.Class.extend(f,g.UICompBase,{ctype:"Calendar",date:new Date(),selectedDate:null,startDay:0,pages:1,rangeSelect:false,minDate:false,maxDate:false,multiSelect:false,multi:null,navigator:true,popup:true,closable:true,showTime:false,triggerType:"click",disabled:null,range:null,rangeLinkage:true,notLimited:false,removeDomOnDestroy:true,zIndex:10800,_handleDate:function(){var j=this,h=j.date;j.weekday=h.getDay();j.day=h.getDate();j.month=h.getMonth();j.year=h.getFullYear();return this},initComponent:function(){var h=this;if(typeof this.targetEl=="string"){this.targetEl=g.getDom(this.targetEl)}if(typeof this.triggerEl=="string"){this.triggerEl=g.getDom(this.triggerEl)}if(this.targetEl){if(this.targetEl.value&&/\d/.test(this.targetEl.value)){this.date=this._time=this.selectedDate=g.DateTime.parseDate(/^(\d+:)+/.test(this.targetEl.value)?"1970-01-01 "+this.targetEl.value:this.targetEl.value)}var j=this.targetEl.getAttribute("mindate");if(j){if(j=="now"){this.minDate=new Date()}else{if(/\d/.test(j)){this.minDate=g.DateTime.parseDate(/^(\d+:)+/.test(j)?"1970-01-01 "+j:j)}}}var k=this.targetEl.getAttribute("maxdate");if(k){if(k=="now"){this.maxDate=new Date()}else{if(/\d/.test(k)){this.maxDate=g.DateTime.parseDate(/^(\d+:)+/.test(k)?"1970-01-01 "+k:k)}}}}this._handleDate();f.superclass.initComponent.call(this);if(h.popup&&h.targetEl){h.$targetEl=$(h.targetEl);h.$targetEl.on("click.calendar",function(){h.expand()});if(h.triggerEl&&h.targetEl!=h.triggerEl){h.$triggerEl=$(h.triggerEl);h.$triggerEl.on(this.triggerType,function(){h.toggle()})}}},onRender:function(j,h){var k=this;if(this.targetEl.value&&/\d/.test(this.targetEl.value)){this.date=this._time=this.selectedDate=g.DateTime.parseDate(/^(\d+:)+/.test(this.targetEl.value)?"1970-01-01 "+this.targetEl.value:this.targetEl.value)}if(!j){j=this.parentEl||document.body}this.ownerDocument=j.ownerDocument;this.ownerWindow=j.ownerDocument.parentWindow;if(this.ownerWindow==g.rootWin){this.showOnRootWindow=true}else{this.showOnRootWindow=false}this.layer=new g.Layer({cls:"z-cal-call",parentEl:j,zIndex:this.zIndex});if(!k.popup){this.layer.el.style.position="relative"}this.outerEl=this.el=this.layer.el;this.$el=this.layer.$el;this.el.calendarId=g.pageId+k.id;k._parseParam();k._childCals=k._childCals||[];k._childCals.length=k.pages;for(i=0;i<k.pages;i++){var m=k._getChildCalParam(i);k._childCals[i]=new f.Page(m);k._childCals[i].render(k.el)}},_parseParam:function(k){var j=this,h;if(k===undefined||k===null){k={}}for(h in k){j[h]=k[h]}if(typeof j.triggerType==="string"){j.triggerType=[j.triggerType]}j.startDay=j.startDay%7;if(j.startDay<0){j.startDay+=7}j._handleDate();if(j.multiSelect){j.rangeSelect=false;j.range=null;j.selectedDate=null;if(j.multi){for(h=0;h<j.multi.length;h++){if(j.multi[h] instanceof Date){j.multi[h]=j._handleDate2String(j.multi[h])}}}}return this},update:function(k){var j=this;j._parseParam(k);for(var h=0;h<j._childCals.length;h++){j._childCals[h].update(j._getChildCalParam(h))}},_getChildCalParam:function(m){var n=this;var k,j,q;var h=false;var p=false;if(n.range){if(n.range.start){h=true}if(n.range.end){p=true}}if(h&&!n.rangeLinkage){q=[n.range.start.getFullYear(),n.range.start.getMonth()]}else{q=[n.year,n.month]}if(m===0){k=true}else{if(!n.rangeLinkage){k=true;if(p&&(m+1)==n.pages){q=[n.range.end.getFullYear(),n.range.end.getMonth()]}else{q=n._computeNextMonth(q)}}else{k=false;q=n._computeNextMonth(q)}}if(!n.rangeLinkage){j=true}else{j=m==(n.pages-1)}var o=n._childCals[m];if(!n.rangeLinkage&&o&&(o.year!=q[0]||o.month!=q[1])){q=[o.year,o.month]}return{_parent:n,ownerWindow:n.ownerWindow,year:q[0],month:q[1],prevArrow:k,nextArrow:j,showTime:n.showTime}},initDom:function(){this.initEvents()},initEvents:function(){},toggle:function(){var h=this;if(!this.rendered){this.render(this.parentEl||this.container)}if(h.isExpanded()){h.collapse()}else{h.expand()}},collapse:function(){if(!this.isExpanded()){return}this.hide();if(g.rootWin!=window){g.rootWin.$(g.rootDoc).off("mousewheel.calendar")}$document.off("mousewheel.calendar");if(this.popup){g.AllDocumentsEvent.un("mousedown.calendar")}this.fireEvent("collapse",this)},collapseIf:function(h){var j=this;if(!j.popup||this.isDestroyed){return this}var k=h.target;if(k==j.targetEl||k==j.outerEl){return}if((d.hasClass(k,"z-next")||d.hasClass(k,"z-prev"))&&k.tagName=="A"){return}if($.contains(j.outerEl,k)||$.contains(j.targetEl,k)){return}j.collapse()},expand:function(){var h=this;if(h.disabled){return}if(!h.rendered){h.render(h.parentEl||h.container)}if(h.isExpanded()){return}h.show();var j=g.Dom.computePositionEx(h.targetEl,h.layer.el);d.setPosition(h.layer.el,j);if(g.rootWin!=window){g.rootWin.$(g.rootDoc).on("mousewheel.calendar",function(k){h.collapseIf(k)})}$document.on("mousewheel.calendar",function(k){h.collapseIf(k)});if(h.popup){g.AllDocumentsEvent.on("mousedown.calendar",function(k){h.collapseIf(k)})}h.fireEvent("expand",h)},isExpanded:function(){return this.layer&&this.layer.isVisible()},_handleDate2String:function(m){var j=m.getFullYear();var k=m.getMonth();var h=m.getDate();return j+"-"+(k>8?(k+1):"0"+(k+1))+"-"+(h>9?h:"0"+h)},_handleString2Date:function(j){var h=j.toString().split("-");if(h.length==3){date=new Date(parseInt(h[0],10),(parseInt(h[1],10)-1),parseInt(h[2],10));if(date instanceof Date&&(date!="Invalid Date")&&!isNaN(date)){return date}}},_getHeadStr:function(h,j){var k=Lang.getCurrentLang();if(Lang.getCurrentLang().startsWith("zh-")){return h.toString()+"年"+(Number(j)+1).toString()+"月"}else{return h.toString()+"-"+(Number(j)+1).toString()}},_monthAdd:function(){var h=this;if(h.month==11){h.year++;h.month=0}else{h.month++}h.date=new Date(h.year.toString()+"/"+(h.month+1).toString()+"/1");return this},_monthMinus:function(){var h=this;if(h.month===0){h.year--;h.month=11}else{h.month--}h.date=new Date(h.year.toString()+"/"+(h.month+1).toString()+"/1");return this},_yearAdd:function(){var h=this;h.year++;h.date=new Date(h.year.toString()+"/"+(h.month+1).toString()+"/1");return this},_yearMinus:function(){var h=this;h.year--;h.date=new Date(h.year.toString()+"/"+(h.month+1).toString()+"/1");return this},_computeNextMonth:function(h){var k=h[0],j=h[1];if(j==11){k++;j=0}else{j++}return[k,j]},_handleOffset:function(){var m=this,n=["日","一","二","三","四","五","六"],j="<span>{day}</span>",p=m.startDay,o="",h=[];for(var k=0;k<7;k++){h[k]=g.String.tmpl(j,{day:n[(k+p)%7]})}o=h.join("");return{day_html:o}},_handleRange:function(k){var j=this,h;j.range=j.range||{start:null,end:null};if((j.range.start===null&&j.range.end===null)||(j.range.start!==null&&j.range.end!==null)){j.range.start=k;j.range.end=null;j.update()}else{if(j.range.start!==null&&j.range.end===null){j.range.end=k;if(j.range.start.getTime()>j.range.end.getTime()){h=j.range.start;j.range.start=j.range.end;j.range.end=h}j.fireEvent("rangeSelect",j.range);j.update();if(j.popup&&j.closable){j.collapse()}}}return this},beforeDestroy:function(){var j=this;j.$targetEl.off("click.calendar");j.$triggerEl.off();j.$targetEl=j.targetEl=j.$triggerEl=j.triggerEl=null;g.AllDocumentsEvent.un("mousedown.calendar");if(g.rootWin!=window){g.rootWin.$(g.rootDoc).off("mousewheel.calendar")}$document.off("mousewheel.calendar");for(var h=0;h<this._childCals.length;h++){this._childCals[h].destroy()}this._childCals.length=0;delete this._childCals;if(this.layer){this.layer.destroy();delete this.layer}}});f.Page=function(h){this._parent=h.parent;this.month=Number(h.month);this.year=Number(h.year);this.prevArrow=h.prevArrow;this.nextArrow=h.nextArrow;this.el=null;this.timmer=null;this.id="";this.constructor.superclass.constructor.call(this,h)};g.Class.extend(f.Page,g.UICompBase,{renderTpl:['<div class="z-cal-hd">','<a href="javascript:void(0);" class="z-prev-year {prev}">&laquo;</a><a href="javascript:void(0);" class="z-prev-month {prev}">&#8249;</a>','<a href="javascript:void(0);" class="z-title">{title}</a>','<a href="javascript:void(0);" class="z-next-month {next}">&#8250;</a><a href="javascript:void(0);" class="z-next-year {next}">&raquo;</a>',"</div>",'<div class="z-cal-bd">','<div class="z-whd">',"{day}","</div>",'<div class="z-dbd z-clearfix">',"{ds}",'<div style="clear:both;"></div>',"</div>","</div>",'<div class="z-setime hidden">',"</div>",'<div class="{notlimited}"><a href="#" class="z-cal-notLimited {notlimitedCls}">不限</a></div>','<div class="z-multi-select {multiSelect}"><button class="z-multi-select-btn">确定</button></div>','<div class="z-cal-ft {showtime}">','<div class="z-cal-time">',"时间：00:00:00","</div>","</div>"].join(""),ctype:"Calendar.Page",cls:"z-cal-box",nav_html:["<p>",g.Lang.get("DateTime.Month"),'<select value="{the_month}">','<option class="m1" value="1">01</option>','<option class="m2" value="2">02</option>','<option class="m3" value="3">03</option>','<option class="m4" value="4">04</option>','<option class="m5" value="5">05</option>','<option class="m6" value="6">06</option>','<option class="m7" value="7">07</option>','<option class="m8" value="8">08</option>','<option class="m9" value="9">09</option>','<option class="m10" value="10">10</option>','<option class="m11" value="11">11</option>','<option class="m12" value="12">12</option>',"</select>","</p>","<p>",g.Lang.get("DateTime.Year"),'<input type="text" value="{the_year}" onfocus="this.select()"/>',"</p>","<p>",'<button class="ok">'+g.Lang.get("Common.OK")+"</button>",'<button class="cancel">'+g.Lang.get("Common.Cancel")+"</button>","</p>"].join(""),initComponent:function(){if(typeof this.targetEl=="string"){this.targetEl=g.getDom(this.targetEl)}if(typeof this.triggerEl=="string"){this.triggerEl=g.getDom(this.triggerEl)}this.constructor.superclass.initComponent.call(this)},initRenderData:function(){this.renderData=this.renderData||{};var k=this,j={},h;k.HTML="";j.prev="";j.next="";j.title="";j.ds="";j.notlimited="";j.notlimitedClass="";if(!k.prevArrow){j.prev="hidden"}if(!k.nextArrow){j.next="hidden"}if(!k._parent.showTime){j.showtime="hidden"}if(!k._parent.notLimited){j.notlimited="hidden"}if(!k._parent.multiSelect){j.multiSelect="hidden"}if(k._parent.showTime&&k._parent.notLimited){j.notlimitedCls="z-cal-notLimited-showTime"}if(k._parent.notLimited&&!k._parent.selectedDate){j.notlimitedCls+=" z-cal-notLimited-selected"}j.title=k._parent._getHeadStr(k.year,k.month);k.createDS();j.ds=k.ds;j.day=k._parent._handleOffset().day_html;return g.mix(this.renderData,j)},update:function(k){var j=this;j._parseParam(k);renderData=this.initRenderData();var h=j.dom.foot.innerHTML;this.ownerWindow.jQuery.cleanData(this.outerEl.getElementsByTagName("*"));j.outerEl.innerHTML=g.String.tmpl(this.renderTpl,renderData);j.dom.foot=this.ownerWindow.$(".z-cal-ft",j.el)[0];if(j._parent.showTime){this.ownerWindow.jQuery.cleanData(j.dom.foot.getElementsByTagName("*"));j.dom.foot.innerHTML=h;j.timmer.resume()}},_parseParam:function(k){var j=this,h;if(k===undefined||k===null){k={}}for(h in k){j[h]=k[h]}return this},initDom:function(){var h=this;h.el=this.ownerWindow.Zving.getDom(h.el.id);h.dom.foot=this.ownerWindow.$(".z-cal-ft",h.el)[0];if(h._parent.showTime){h.timmer=new b({container:h.dom.foot,_parent:h._parent,ownerWindow:this.ownerWindow});h.timmer.render()}this.initEvents()},initEvents:function(){var h=this;if(!h._parent.multiSelect){h.$el.on("click","div.z-dbd a",function(j){h._dbd_onClick(j)})}h.$el.on("click","a.z-prev-month",function(j){h._prevMonth_onClick(j)});h.$el.on("click","a.z-next-month",function(j){h._nextMonth_onClick(j)});h.$el.on("click","a.z-prev-year",function(j){h._prevYear_onClick(j)});h.$el.on("click","a.z-next-year",function(j){h._nextYear_onClick(j)});if(h._parent.navigator){h.$el.on("click","a.z-title",function(j){h._title_onClick(j)})}h.$el.on("click",".z-setime",function(j){h._setime_onClick(j)});if(h._parent.notLimited){h.$el.on("click",".z-cal-notLimited",function(j){h._notLimited_onClick(j)})}if(h._parent.multiSelect){h.$el.on("mousedown","div.z-dbd a",function(j){h._dbd_onMouseDown(j)});h.$el.on("mouseup","div.z-dbd a",function(j){h._dbd_onMouseUp(j)});h.$el.on("click",".z-multi-select-btn",function(j){h._multiSelectBtn_onClick(j)})}},_dbd_onClick:function(k){var h=this;k.preventDefault();var j=k.currentTarget;if(j.tagName!="A"){return}if(d.hasClass(j,"z-null")){return}if(d.hasClass(j,"z-disabled")){return}var m=new Date(h.year,h.month,Number(j.innerHTML));h._parent.dt_date=m;h._parent.fireEvent("select",{date:m});if(h._parent.popup&&h._parent.closable&&!h._parent.showTime&&!h._parent.rangeSelect){h._parent.collapse()}if(h._parent.rangeSelect){h._parent._handleRange(m)}h._parent.update({selectedDate:m})},_prevMonth_onClick:function(j){var h=this;j.preventDefault();if(!h._parent.rangeLinkage){h._monthMinus()}h._parent._monthMinus().update();h._parent.fireEvent("monthChange",{date:new Date(h._parent.year+"/"+(h._parent.month+1)+"/01")})},_nextMonth_onClick:function(j){var h=this;j.preventDefault();if(!h._parent.rangeLinkage){h._monthAdd()}h._parent._monthAdd().update();h._parent.fireEvent("monthChange",{date:new Date(h._parent.year+"/"+(h._parent.month+1)+"/01")})},_prevYear_onClick:function(j){var h=this;j.preventDefault();if(!h._parent.rangeLinkage){h._yearMinus()}h._parent._yearMinus().update();h._parent.fireEvent("monthChange",{date:new Date(h._parent.year+"/"+(h._parent.month+1)+"/01")})},_nextYear_onClick:function(j){var h=this;j.preventDefault();if(!h._parent.rangeLinkage){h._yearAdd()}h._parent._yearAdd().update();h._parent.fireEvent("monthChange",{date:new Date(h._parent.year+"/"+(h._parent.month+1)+"/01")})},_title_onClick:function(n){var m=this;try{m.timmer.hidePopup();n.preventDefault()}catch(j){}var h=m.$el.find(".z-setime");var k=g.String.tmpl(m.nav_html,{the_month:m.month+1,the_year:m.year});h.html(k);h.removeClass("hidden");h=null;m.$el.find(":text").off("keydown.calendar").on("keydown.calendar",function(q){input=this;if(q.keyCode==38){input.value=Number(q.target.value)+1;input.select()}if(q.keyCode==40){input.value=Number(q.target.value)-1;input.select()}if(q.keyCode==13){var p=m.$el.find(".z-setime select").val();var o=m.$el.find(".z-setime input").val();m.$el.find(".z-setime").addClass("hidden");if(!m.Verify().isYear(o)){return}if(!m.Verify().isMonth(p)){return}m._parent.update({date:new Date(o+"/"+p+"/01")});m._parent.fireEvent("monthChange",{date:new Date(o+"/"+p+"/01")})}})},_setime_onClick:function(o){var m=this;o.preventDefault();var n=o.target;var k=o.currentTarget;if(d.hasClass(n,"ok")){var j=$("select",k).val(),h=$("input",k).val();$(k).addClass("hidden");if(!m.Verify().isYear(h)){return}if(!m.Verify().isMonth(j)){return}m._parent.update({date:new Date(h+"/"+j+"/01")});m._parent.fireEvent("monthChange",{date:new Date(h+"/"+j+"/01")})}else{if(d.hasClass(n,"cancel")){$(k).addClass("hidden")}}},_notLimited_onClick:function(j){var h=this;j.preventDefault();h._parent.range={start:null,end:null};h._parent.fireEvent("select",{date:null});if(h._parent.popup&&h._parent.closable){h._parent.collapse()}h._parent.update({selectedDate:null})},_dbd_onMouseDown:function(k){var h=this;k.preventDefault();var j=k.currentTarget;if(j.tagName!="A"){return}if(d.hasClass(j,"z-null")){return}if(d.hasClass(j,"z-disabled")){return}var m=new Date(h.year,h.month,Number(k.target.innerHTML))},_dbd_onMouseUp:function(k){var h=this;k.preventDefault();var j=k.currentTarget;if(j.tagName!="A"){return}if(d.hasClass(j,"z-null")){return}if(d.hasClass(j,"z-disabled")){return}var m=new Date(h.year,h.month,Number(k.target.innerHTML))},_multiSelectBtn_onClick:function(j){var h=this;j.preventDefault()},_monthAdd:function(){var h=this;if(h.month==11){h.year++;h.month=0}else{h.month++}},_monthMinus:function(){var h=this;if(h.month===0){h.year--;h.month=11}else{h.month--}},_yearAdd:function(){var h=this;h.year++},_yearMinus:function(){var h=this;h.year--},_getNumOfDays:function(h,j){return 32-new Date(h,j-1,32).getDate()},_isDisabled:function(h,j){if(h&&h.length>0){for(var k=0;k<h.length;k++){var m=h[k];if(j.getFullYear()==m.getFullYear()&&j.getMonth()==m.getMonth()&&j.getDate()==m.getDate()){return true}}}return false},isInMulit:function(m,j){if(m&&m.length>0){for(var k=0;k<m.length;k++){var h=m[k].split("-");if(j.getFullYear()==parseInt(h[0],10)&&j.getMonth()==(parseInt(h[1],10)-1)&&j.getDate()==parseInt(h[2],10)){return true}}}return false},createDS:function(){var o=this,t="",n=(7-o._parent.startDay+new Date(o.year+"/"+(o.month+1)+"/01").getDay())%7,q=o._getNumOfDays(o.year,o.month+1),m=o._parent.selectedDate,p=new Date(),h;var k;for(k=0;k<n;k++){t+='<a href="javascript:void(0);" class="z-null">0</a>'}for(k=1;k<=q;k++){var r="";var j=new Date(o.year,o.month,k);if((o._parent.minDate&&new Date(o.year,o.month,k+1)<o._parent.minDate)||(o._parent.maxDate&&j>o._parent.maxDate)||o._isDisabled(o._parent.disabled,j)){r="z-disabled"}else{if(o._parent.range&&j>=o._parent.range.start&&j<=o._parent.range.end){r="z-range"}else{if((m&&m.getFullYear()==o.year&&m.getMonth()==o.month&&m.getDate()==k)||o.isInMulit(o._parent.multi,j)){r="z-selected"}}}if(p.getFullYear()==o.year&&p.getMonth()==o.month&&p.getDate()==k){r+=" z-today"}t+="<a "+(r?"class="+r:"")+' href="javascript:void(0);">'+k+"</a>"}o.ds=t;return t},Verify:function(){var j=function(m){if(!/^\d+$/i.test(m)){return false}m=Number(m);return !(m<1||m>31)},h=function(m){if(!/^\d+$/i.test(m)){return false}m=Number(m);return !(m<100||m>10000)},k=function(m){if(!/^\d+$/i.test(m)){return false}m=Number(m);return !(m<1||m>12)};return{isDay:j,isYear:h,isMonth:k}},beforeDestroy:function(){if(this.timmer){this.timmer.destroy();delete this.timmer}if(this.rendered){this.ownerWindow.jQuery.cleanData(this.el.getElementsByTagName("*"))}delete this._parent}});a=function(h){this.defaultConfig={container:g.rootDoc.body};if(!(this instanceof a)){return g.ComponentManager.getByDom(g.getDom(h),"TimePicker")}this.constructor.superclass.constructor.call(this,h)};g.Class.extend(a,f,{ctype:"TimePicker",date:new Date(),onRender:function(j,h){var k=this;if(!j){j=this.parentEl||document.body}this.ownerDocument=j.ownerDocument;this.ownerWindow=j.ownerDocument.parentWindow;if(this.ownerWindow==g.rootWin){this.showOnRootWindow=true}else{this.showOnRootWindow=false}this.layer=new g.Layer({cls:"z-cal-call",parentEl:j,zIndex:this.zIndex});if(!k.popup){this.layer.el.style.position="relative"}this.outerEl=this.el=this.layer.el;this.$el=this.layer.$el;this.el.calendarId=g.pageId+k.id;k._parseParam();k._childCals=k._childCals||[];k._childCals.length=k.pages;for(i=0;i<k.pages;i++){var m=k._getChildCalParam(i);m.container=k.el;k._childCals[i]=new b(m);k._childCals[i].render(k.el)}},beforeDestroy:function(){a.superclass.beforeDestroy.call(this)}});b=function(h){this.container=h.container;this._parent=h._parent;this.ownerWindow=this._parent.ownerWindow;this.ownerDocument=this._parent.ownerDocument;this.calendarWrap=h._parent.el;this.$calendarWrap=h._parent.$el;if(typeof this._parent._time=="undefined"){this._parent._time=new Date()}this.time=this._parent._time;this.status="s";this.ctime=Dom.html2Node('<div class="z-cal-time">'+g.Lang.get("DateTime.Time")+':<span class="h">h</span>:<span class="m">m</span>:<span class="s">s</span><!--[[arrow--><div class="cta"><button class="u"><b></b></button><button class="d"><b></b></button></div><!--arrow]]--></div>',this._parent.ownerDocument);this.button=Dom.html2Node('<button class="ct-ok">'+g.Lang.get("Common.OK")+"</button>",this._parent.ownerDocument);this.popupannel=Dom.html2Node('<div class="z-selectime hidden"></div>',this._parent.ownerDocument);this.h_a=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"];this.m_a=["00","10","20","30","40","50"];this.s_a=["00","10","20","30","40","50"];this.constructor.superclass.constructor.call(this,h)};g.Class.extend(b,g.UICompBase,{ctype:"TimeSelector",initComponent:function(){if(typeof this.targetEl=="string"){this.targetEl=g.getDom(this.targetEl)}if(typeof this.triggerEl=="string"){this.triggerEl=g.getDom(this.triggerEl)}this.constructor.superclass.initComponent.call(this)},onRender:function(){var h=this;h.container.innerHTML="";h.container.appendChild(h.ctime);h.container.appendChild(h.button);h.container.appendChild(h.popupannel);h.$ctime=h.ownerWindow.$(h.ctime);h.$button=h.ownerWindow.$(h.button);h.update()},initDom:function(){this.initEvents()},initEvents:function(){var h=this;this.$calendarWrap.on("click.timeselector","div.z-selectime a.x",function(j){h.hidePopup()});this.$calendarWrap.on("click.timeselector","div.z-selectime a.item",function(m){var k=m.currentTarget;var j=Number(k.innerHTML);h.set(h.status,j);h.hidePopup()});this.$calendarWrap.on("click.timeselector","button.ct-ok",function(){var j=typeof h._parent.dt_date=="undefined"?h._parent.date:h._parent.dt_date;j.setHours(h.getTime("h"));j.setMinutes(h.getTime("m"));j.setSeconds(h.getTime("s"));h._parent.fireEvent("timeSelect",{date:j});if(h._parent.popup&&h._parent.closable){h._parent.collapse()}});this.$calendarWrap.on("click.timeselector","div.z-cal-time button.u",function(){h.hidePopup();h.add()});this.$calendarWrap.on("click.timeselector","div.z-cal-time button.d",function(){h.hidePopup();h.minus()});this.$calendarWrap.on("mousewheel.timeselector","div.z-cal-time",function(j,k){if(k>0){h.add()}else{if(k<0){h.minus()}}j.preventDefault();j.stopPropagation()});this.$calendarWrap.on("click.timeselector","div.z-cal-time span.h",function(){var j=h.parseSubHtml(h.h_a);h.status="h";h.showPopup(j)});this.$calendarWrap.on("click.timeselector","div.z-cal-time span.m",function(){var j=h.parseSubHtml(h.m_a);h.status="m";h.showPopup(j)});this.$calendarWrap.on("click.timeselector","div.z-cal-time span.s",function(){var j=h.parseSubHtml(h.s_a);h.status="s";h.showPopup(j)})},resume:function(){this.$ctime=this.$calendarWrap.find("div.z-cal-time");this.$button=this.$calendarWrap.find("button.ct-ok");this.ctime=this.$ctime.get(0);this.button=this.$button.get(0)},parseSubHtml:function(h){var k="";for(var j=0;j<h.length;j++){k+='<a href="javascript:void(0);" class="item">'+h[j]+"</a>"}k+='<a href="javascript:void(0);" class="x">x</a>';return k},showPopup:function(j){var k=this;this.popupannel=this.$calendarWrap.find("div.z-selectime").get(0);this.popupannel.innerHTML=j;d.removeClass(this.popupannel,"hidden");var h=k.status;k.$ctime.find("span").removeClass("on");switch(h){case"h":k.$ctime.find(".h").addClass("on");break;case"m":k.$ctime.find(".m").addClass("on");break;case"s":k.$ctime.find(".s").addClass("on");break}},_getPopupannel:function(){this.popupannel=this.$calendarWrap.find("div.z-selectime").get(0);return this.popupannel},hidePopup:function(){d.addClass(this.popupannel,"hidden")},update:function(){var o=this;var n=e(o.getTime("h"),2);var j=e(o.getTime("m"),2);var k=e(o.getTime("s"),2);o._parent._time=o.time;o.$ctime.find(".h").html(n);o.$ctime.find(".m").html(j);o.$ctime.find(".s").html(k);return o},set:function(h,j){var k=this;j=Number(j);switch(h){case"h":k.time.setHours(j);break;case"m":k.time.setMinutes(j);break;case"s":k.time.setSeconds(j);break}k.update()},getTime:function(h){var j=this;var k=j.time;switch(h){case"h":return k.getHours();case"m":return k.getMinutes();case"s":return k.getSeconds()}},add:function(){var k=this;var h=k.status;var j=k.getTime(h);j++;k.set(h,j)},minus:function(){var k=this;var h=k.status;var j=k.getTime(h);j--;k.set(h,j)},beforeDestroy:function(){if(this.rendered){this.ownerWindow.jQuery.cleanData(this.calendarWrap.getElementsByTagName("*"));this.ownerWindow.jQuery.cleanData(this.$calendarWrap);this.ownerWindow.jQuery.cleanData(this.$ctime);this.ownerWindow.jQuery.cleanData(this.$button);this.$calendarWrap=this.calendarWrap=this.popupannel=this.$ctime=this.ctime=this.$button=this.button=null}delete this.container;delete this._parent}});c=function(n,k){if(!(this instanceof c)){return g.ComponentManager.getByDom(g.getDom(config),"DatePicker")}this.targetEl=n=g.getDom(n);this.id=this.ctype+"_"+(++g.idSeed._seed);n._components=n._components||{};n._components[this.ctype]=this.id;g.ComponentManager.register(this);var j;if(n.type!="text"){n=d.prevElement(n);j=n}var h;if(g.isIE&&g.ieVersion<8){h={date:g.CONTEXTPATH+"framework/images/Calendar.gif",time:g.CONTEXTPATH+"framework/images/TimeSelector.gif",datetime:g.CONTEXTPATH+"framework/images/DateTime.gif"}}else{h={date:"data:image/gif;base64,R0lGODlhEgASAPcAAAAAAP////r7/+3x//L1/8DR/93m/+Xs/+nv/+vw/+zx//P2//f5/2yDum2Eu5e1/5m3/5u3/5y5/566/6C8/6O9/6S+/6a//6nC/6vD/63F/67G/7fL/7fM/7zP/8HT/8XW/8jY/8nZ/8za/9He/9Tg/9bi/9jj/93n/9/o/+Dp/+Lq//H1/26Fu3CHvHSKvneNwHuRwn+UxYKXxoSZx7LJ/7XL/4+fwb/T/87d/9fj/+Xt/+nw/4SWu4OVuoSWuoWXu4mavoqbvpKiw5GhwuDq/36dxn+exoOiyYimzF2DrluAqk5ukWKIsmaLtmqQu2+Vvk5xlU5wk0xsjnWbw4Kr03uhx4Kq0YGoz3+lzIGmzIiv1YSpz4qv1Yis0lB1l36p0oGr04qx1m6Rr2yOq3GVsmqLprrL2bnK2LzM2rrK2MDP3OHp8HifvHWat3uiwLXI1rPG1MTT38bV4MXU38TT3t/o797n7uPr8UZ4mrLG1LnL2L7P28PT3sjX4cvZ4zxkfDhdcjRWajRWadPf5tLe5dfi6Nbh5+vy9vH2+fD1+DlieDhfdDVabjNVZ0psfUtsfenx9fD2+e/1+Extfefw9GiTo9Pq8ujx9OX29tdZNNhcN9lbOdpcOtpdO9pePN5wVOB1WcZrXMhvYMVpWsRoWdvb25Cw/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKcALAAAAAASABIAAAj/AE8JHEiwoMGDCE+B2SKmixcuWqxQgfLESRMlS/IIDMOCgQAGLHgUMTHiQwcNFiR8MXWqygAWCwgo2IGihIgCNjJUiBCF5ZUdPBIgOJDiRA4QHmpgoABBCkssBlSsUIFCB4kQODhsuDDhAROWWWTMoEFjhowYMF64aOGgQYMpLN8k4oNIDp4/hg7NsXOmkp5JlFi2uUFkyBAiN5KM2uSJ1BEfPiCxdCNpT6Q1bPxcCvWpE6hMfx+xLBNEiGkhQZCI0sSplBHIok+NUQQHUxo7dAgRqnMHjd9JsckAGU68R48fkJPHNjMpTiU1d/oUKtSn9+/YlgAtYhSokaBBjsKLDg/P8pSp8+jTqy+f8GBAADs=",time:"data:image/gif;base64,R0lGODlhEgASAPeUAN/n7/z08/78/DlngZGrufXc1Pf0/Njd9Pbj3fvw7/vw7UFxi+ji+ZK225qj4tnl8mx9wJih4vPu+2KHnPzx+ufi+eXh+PLs+6PA3+ft93aIzpGsua+265Sd47fO5aGr6aSu6rbN592BakNyjb3P6Nnk9PXy/Kqy68fJ8bHG573H75Ctw5241OPp9ouU3MbV7Zye4qux6/Tu+6rE4KGn6WGNtq/I4uOOi2SJn6jA5NnV9eitnHSGyq6w7GmXvczT88DJ75avwHikz+Do9pG03dJZP9He8OehmG+Axezy+GqQpzxrhzxrhcXY7LXN579LNJO3272679vl8jpnhPrs6oux1vnl5Prn5vru6qS255ac4NPe8YWO1Yu02sHW67jL5qPB4ZOb3GWJoG+dxYSW2r3O2I6y1qi46m+Bxejv9v////vu+lKBo7O+7dZqU9/o9b9MNImb41iEq5CquG9/wubt9mqXwIuV17PI6Orh+MbW64+03cfE8tHd6Et3mH+P1f78/v78+1iDq4Cn1NnX9frs66bA326byOPs9by776zH4VqKrfTRzeXd9+KZheLo9dzY9tTP88NKMZu42wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAJQALAAAAAASABIAAAjYACkJHEiwoMGDCA0i8mCmiqISCSmlmaRHSoY6RjDYAXAwiY0WBzg4iADixwsfHAsaGoIiCgMZEiz0OIFnRcEHXw4kUmOFkQABgGioGFOG4IwtMSoIwOIGgYIbkciAUUJQyKMwJhIEgiPiyZE8dJqMIHjozZ0LVAoUkbQjQSMIXhYQZEGig45CCBwVUHCFDw8oOAj2GQQExpoAiANQ4HJm0YaCclJ80ALJgAFCLuIQGWAQgKAcbf6gQaIhy54pBA4C8FOjQQgnXdgMSJ0wiJglTCbMici7d8KAADs=",datetime:"data:image/gif;base64,R0lGODlhEgASAPcAAAAAAP////zx+vvu+v78/vTu++rh+PLs+/Pu+/f0/OXd9/Xy/Oji+efi+eXh+NTP89zY9tnV9b2678fE8tnX9by775ye4q6w7Jac4KGn6YWO1YuU3JSe3pGc2pag3pKc2I+b1nqJx3eGw3qIxJKg2pqn3J2o183R4fr7/3qKx5ej0pai0KGt2rjE7cnO4NDU4u3x/87V7PL1/4+gz8DR/93m/+Xs/+nv/+vw/+zx//P2//f5/5e1/5m3/5u3/5y5/566/6C8/6O9/6S+/6a//6nC/6vD/63F/67G/7fL/7fM/5io0bzP/8HT/8XW/8jY/8nZ/8za/9He/9Tg/9bi/9jj/93n/9/o/+Dp/+Lq/8fO3/H1/3eNwHuRwn+UxYKXxoSZx7LJ/7XL/4+fwb/T/87d/9fj/+Xt/+nw/4WXu4mavoqbvpKiw5GhwuDq/154pWqAqMzW6XuQtKW62l2DrluAqk5ukWKIsmaLtmqQu2+Vvk5xlU5wk0xsjnWbw4Kr03uhx4Kq0YGoz3+lzIGmzIiv1YSpz4qv1Yis0lB1l36p0oGr04qx1m6Rr2yOq3GVsmqLprzM2rrK2MDP3OHp8HifvHWat3uiwLXI1rPG1MTT38XU39/o797n7uPr8UZ4mrnL2L7P28PT3sjX4cvZ4zxkfDhdcjRWajRWadfi6Ovy9vH2+fD1+DlieDhfdDVabunx9fD2+e/1+Ofw9GiTo+jx9P78+/Xc1Pbj3fru6uKZheitnPvw7d2BasNKMb9LNL9MNNJZP9ZqU/rs6uehmPTRzfz08/vw7/nl5Prn5vrs6+OOi/78/Nvb2////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAM4ALAAAAAASABIAAAj/AJ0JHEiwoMGDCJ0pKsToECJDhAD50ZMHzx06dT4JXLRlB4odW9C4oRKliZIjQ34kaubsD4wtOmTkOGNlChQaYowI8bGHZaAzaHDcsHGlShknTMIUCdKDD0tBNbBkwWLFjJQnZJIgIQKEhx2Wg7x8AQPmi5cuXJaU8MCBxIw+LC+tCqVKkydSqWJIYFAAgYMLclhWGtOGDZs2Y+ZUCICsGDNmBDK8cGYpFihYkyiNatGAWS5huHgte8DC2SM1a1KvUdNhwTFbwHr9ImZghLNGrDDVisRp04cDw24F87XrmAIRzhylWc4cRARluHTd4pVswgpnkGRlmiWpk6g4FgYYLRtvTIAGF85olWrlytSrU6jgYICQIAGFDW9YOmvGvz//EyakEIIKWvCXUEIBAQA7"}}ztype=k||n.getAttribute("ztype");ztype=ztype.toLowerCase();if(!j){if(!n.nextSibling||n.nextSibling.tagName!=="IMG"||n.nextSibling.src.indexOf(h[ztype])==-1){n.insertAdjacentHTML("afterEnd",'<img class="z-datepicker-trigger" src="'+h[ztype]+'" align="absmiddle" width=18 vspace=1 style="margin-left:-20px; cursor:pointer;"/>');if(g.isIE6&&n.parentNode.tagName=="TD"){n.parentNode.style.position="relative"}}j=n.nextSibling}this.triggerEl=j;var m=this.$targetEl=$(n);if(ztype=="date"){n.value=n.value.replace(/\s(\d{1,2}(:|.))+(\d{1,2})?$/,"");this.picker=new f({targetEl:n,triggerEl:j});this.picker.on("select",function(p){var o=g.Date.format(p.date,"yyyy-MM-dd");if(this.targetEl.value!=o){this.targetEl.value=o;this.$targetEl.change()}})}else{if(ztype=="datetime"){this.picker=new f({targetEl:n,triggerEl:j,showTime:true});this.picker.on("timeSelect",function(p){var o=g.Date.format(p.date,"yyyy-MM-dd hh:mm:ss");if(this.targetEl.value!=o){this.targetEl.value=o;this.$targetEl.change()}})}else{if(ztype=="time"){this.picker=new a({targetEl:n,triggerEl:j,showTime:true});this.picker.on("timeSelect",function(p){var o=g.Date.format(p.date,"hh:mm:ss");if(this.targetEl.value!=o){this.targetEl.value=o;this.$targetEl.change()}})}}}m=n=j=null;this.initEvents()};c.prototype={ctype:"DatePicker",initEvents:function(){var h=this;if(h.targetEl.disabled===true){h.disable()}d.onPropertyChange(h.targetEl,"disabled",h.syncDisabled,h)},syncDisabled:function(h,j){if(this.ignoreNextDisabledSync){this.ignoreNextDisabledSync=false;return}this.setDisabled(j);return j},setDisabled:function(h){return this[h?"disable":"enable"]()},disable:function(){if(this.triggerEl){g.Node.addClass(this.triggerEl,"grayscale");this.triggerEl.style.opacity=0.5}if(this.targetEl&&!this.targetEl.disabled){this.targetEl.disabled=true}this.picker.disable();this.disabled=true},enable:function(){if(this.triggerEl){g.Node.removeClass(this.triggerEl,"grayscale");this.triggerEl.style.opacity=1}if(this.targetEl&&this.targetEl.disabled){this.targetEl.disabled=false}this.picker.enable();this.disabled=false},destroy:function(){jQuery.cleanData(this.$targetEl);this.picker.destroy();this.picker=this.triggerEl=null;this.$targetEl=this.targetEl=null;g.ComponentManager.unregister(this)}};g.Calendar=f;g.TimeSelector=b;g.DatePicker=c;g.TimePicker=a})();
/*! DataList */
(function(){var h=window.Zving,m=h.getDom,g=h.Node,f=h.Server,b=h.Constant,e=h.Lang,j=h.CONTEXTPATH,d=h.Misc,c;function k(p){var n=p.getElementsByTagName("input");for(var o=0;o<n.length;o++){if((n[o].type=="checkbox"||n[o].type=="radio")&&n[o].value){return n[o]}}}c=function(n){this.defaultConfig={_rows:[]};if(!(this instanceof c)){return h.ComponentManager.getByDom(h.getDom(n),"DataList")}h.DataGSetter(this,"params","param");c.superclass.constructor.apply(this,arguments)};c.BackendMethod="com.zving.framework.ui.control.DataListUI.doWork";h.Class.extend(c,h.UICompBase,{ctype:"DataList",cls:"z-datalist",outerElAttrs:"ul",renderTpl:"<li>{content}</li>",recordsSelected:[],initComponent:function(){var n=this;h.Statable(this);this.addEvents("beforeupdate","update","loaddata");c.superclass.initComponent.apply(this);if(this.el){this.initDom()}},initFromDom:function(p){var o=this;var n=m(p);if(n.tagName!="INPUT"){Console.log("因参数el传入错误,DataList初始化失败!<br>可能存在的原因是DataList的id与页面元素id冲突");return}this.setParemFormEl(n);return{el:n}},setParemFormEl:function(n){if(n.getAttribute("method")){this.setParam(b.Method,n.getAttribute("method"))}if(n.getAttribute("size")){this.setParam(b.Size,Number(n.getAttribute("size")))}if(n.getAttribute("sortend")){this.sortable=true}if(n.getAttribute("dragclass")){this.dragHandle=n.getAttribute("dragclass")}if(n.getAttribute("autopagesize")=="true"){this.autoPageSize=true}if(n.getAttribute("autofill")=="true"){this.setParam(b.AutoFill,"true")}if(n.getAttribute("page")=="true"){this.setParam(b.Page,"true")}},initDom:function(){var o=this;var n=o.el;var p=n.id;o.dom={};o.initEvents();o.initPagebar();if(o.autoPageSize){h.Page.onLayout(function(){if(!o.el||!o.el.parentNode||!o.el.parentNode.offsetParent){return}o.computePageSize();o.resumePagebar()})}o.sortableInit();o.initEvents4Rows()},initEvents:function(){},_getRowElByChkbox:function(p){var q=this;var r=q.getListContainer();var o=p,n;while(o&&o.tagName&&o!=r){if(typeof o._is_datalist_row!="undefined"){n=o;break}o=o.parentNode}return n},_unSelectOtherRows:function(q,p){var t=this;t.recordsSelected=[p.value];var r=t.getListNodes();for(var o=0,n=r.length;o<n;o++){var u=r[o];if(u!=q){var s=k(u);if(s){if(s.type=="checkbox"&&s.checked===true){s.checked=false;$(s).trigger("change")}h.Node[s.checked?"addClass":"removeClass"](u,"selected")}}}r=null},_chkboxonchange:function(y,z){var u=this;var x=z.checked;var p=u._getRowElByChkbox(z);if(x){if(z.type=="radio"){u._unSelectOtherRows(p,z)}else{var w=h.getDom(u.el.id+"_AllCheck");if(w){var r=false;var u=this;var t=u.getListNodes();for(var q=0,o=t.length;q<o;q++){var n=t[q];if(n!=p&&!k(n).checked){r=true;break}}w.checked=!r}}if(this.recordsSelected.indexOf(z.value)===-1){this.recordsSelected.push(z.value)}}else{var w=h.getDom(u.el.id+"_AllCheck");if(w&&w.checked){w.checked=false}h.Node.removeClass(p,"selected");var s=this.recordsSelected.indexOf(z.value);if(s!==-1){this.recordsSelected.splice(s,1)}}h.Node[z.checked?"addClass":"removeClass"](p,"selected")},initEvents4Rows:function(){var u=this;var t=u.getListContainer();var o=this.$listContainer=$(t);var q=t.getElementsByTagName("INPUT");var x=[],w;for(var n=0,r=q.length;n<r;n++){w=q[n];if(w.value&&(w.type=="checkbox"&&w.value!=="all"||w.type=="radio")){x.push(w)}}q=w=null;var p=$(x);this.$checkboxs=p;p.each(function(){var z=this,y=u._getRowElByChkbox(z);if(y){h.Node[this.checked?"addClass":"removeClass"](y,"selected");$(z).on("change",function(A){u._chkboxonchange(A,this)})}});if(!o.data("attachMouseDownEvent")){var s=u.getListNodes();if(p.length&&p.length<=s.length+1){o.data("attachMouseDownEvent",true).off("mousedown.datalist").on("mousedown.datalist",function(y){if(!y||!y.srcElement||(y.which===1&&/^(INPUT|LABEL)/.test(y.srcElement.tagName))){return}var B=y.srcElement,A;while(B&&B.tagName&&B!=y.currentTarget){if(typeof B._is_datalist_row!="undefined"){A=B;break}B=B.parentNode}if(A){var z=k(A);if(z){if(!z.checked){z.checked=true;$(z).trigger("change")}h.Node[z.checked?"addClass":"removeClass"](A,"selected")}if(z.type=="radio"||!y.ctrlKey){u._unSelectOtherRows(A,z)}}})}s=null}o=t=null},restore:function(){this.initEvents4Rows()},gotoPage:function(n){var o=this;o.setParam(b.PageIndex,n);o.loadData(null,null,true,true)},previousPage:function(){this.gotoPage(this.getParam(b.PageIndex)-1)},nextPage:function(){this.gotoPage(this.getParam(b.PageIndex)+1)},firstPage:function(){this.gotoPage(0)},lastPage:function(){var q=this;var p=q.getParam(b.PageTotal);var o=q.getParam(b.Size);var n=Math.ceil(Number(p)/Number(o));this.gotoPage(n-1)},clear:function(){var n=this.getListNodes();if(n.length){n.remove();this.$listNodes=$listNodes=null}},getTotalCount:function(){return this.getParam(b.Total)},getTotalPage:function(){var o=this;var n=o.getParam(b.Size);return h.isNumber(n)?Math.ceil(o.getTotalCount()/n):o.getParam(b.PageIndex)},getCurrentPage:function(){return this.getParam(b.PageIndex)},initPagebar:function(){var o=this.el;var s=o.id;var n=h.getDom("_PageBar_"+s);if(n){this.dom.pagebarWrap=n;var p=$(n);var q=p.find(".pageSizeGroup");if(q.length){var r=q.find("ul");q.hover(function(){r.show()},function(){r.hide()})}}},resumePagebar:function(){var F=this;var p=F.el;if(!p){console.log(location.pathname+"数据表格"+F.id+"不存在");return}var z=p.id;var q=m("_PageBar_"+z);if(!q){return}this.dom.pagebarWrap=q;var r=$(q);var w=r.find(".pagebar");var x=Number(F.getParam(b.PageIndex));var s=Number(F.getParam(b.PageTotal));var D=Number(F.getParam(b.Size));var C=Math.floor(s/D);if(s%D===0){C--}var o=r.find(".first")[0];var E=r.find(".previous")[0];var A=r.find(".next")[0];var B=r.find(".last")[0];r.find(".js_total").html(s);r.find(".js_pageSize").html(Math.min(s,D));r.find(".js_totalPages").html(1+C);r.find(".js_pageIndex").html(1+x);var y=r.find("input.gotopage");if(y.length){y.val(1+x).width(Math.max(String(1+x).length*7+1,15))}if(r.attr("pagebartype")!="2"){var u=r.find(".tfoot-fl");if(u.length){var t=u.find(".pageInfo");var n=u.find(".pageInfo_trigger");if(!t[0]._inited){if(t[0].offsetWidth+w[0].offsetWidth>u[0].parentNode.clientWidth){t.show();t[0]._width=t[0].clientWidth;t.hide();u.hoverIntent(function(){t.show().width(1).animate({width:t[0]._width},function(){t.css("overflow","visible");n.hide()})},function(){t.animate({width:1},function(){t.hide();n.show()})});t[0]._inited=true;n.show()}}}}o._innerHTML_bak=o._innerHTML_bak||o.innerHTML;E._innerHTML_bak=E._innerHTML_bak||E.innerHTML;A._innerHTML_bak=A._innerHTML_bak||A.innerHTML;B._innerHTML_bak=B._innerHTML_bak||B.innerHTML;if(!/^<.*>$/.test(o._innerHTML_bak)){o._innerHTML_bak="<a onclick=\"Zving.DataList.firstPage('"+z+'\');" href="javascript:void(0);">'+e.get("DataGrid.FirstPage")+"</a>";E._innerHTML_bak="<a onclick=\"Zving.DataList.previousPage('"+z+'\');" href="javascript:void(0);">'+e.get("DataGrid.PrevPage")+"</a>"}if(!/^<.*>$/.test(B._innerHTML_bak)){A._innerHTML_bak="<a onclick=\"Zving.DataList.nextPage('"+z+'\');" href="javascript:void(0);">'+e.get("DataGrid.NextPage")+"</a>";B._innerHTML_bak="<a onclick=\"Zving.DataList.lastPage('"+z+'\');" href="javascript:void(0);">'+e.get("DataGrid.LastPage")+"</a>"}if(x<=0){o.innerHTML=o.innerText;E.innerHTML=E.innerText}else{if(o.innerHTML.trim()==o.innerText.trim()){o.innerHTML=o._innerHTML_bak;E.innerHTML=E._innerHTML_bak}}if(x>=C){A.innerHTML=A.innerText;B.innerHTML=B.innerText}else{if(A.innerHTML.trim()==A.innerText.trim()){A.innerHTML=A._innerHTML_bak;B.innerHTML=B._innerHTML_bak}}},computePageSize:function(){var n=this.el;if(!n||!n.parentNode){n=null;return}var E=$(n);var w=n.id;if(!this.autoPageSize){return false}var p,y,C,q,u,r;var B=this.getListNodes();if(!B.length){return}p=B.length;r=B[0];if(/^(th|td|tr|tb|tf)/i.test(r.nodeName)){q=g.getParent(r,"table");C=true}else{q=r.parentNode}y=q.parentNode;var x=q.offsetHeight;var D=y.clientHeight;var o=x/p;var t;t=Math.floor(D/o);var z=this.getParam(b.Size);var F=this.getParam(b.PageTotal);var s=Math.min(z,F);var A;if(/^(block|table|list)/.test($(r).css("display"))&&$(r).css("float")=="none"){A=p;if(A<=t){return}while(A>t){if(C){B.filter(q.rows[A-1]).remove()}else{B.last().remove()}A--;s--}this.setParam(b.Size,s)}this.$listNodes=B=q=null},sortableInit:function(){var p=this.el;if(this.sortable){var o=window["eval"](p.getAttribute("sortend"));var n=this.dragHandle;var q=p.getAttribute("listNodes");if(!q){q=this.getListNodes()}if(q.length){this._sortable(n,q,o)}}},getListNodes:function(){var o=this.el;var z=$(o),w,t=[],u;if(z.attr("listnodes")){this.$listNodes=$(z.attr("listnodes"))}else{if(h.isIE&&o.parentNode.nodeType==1&&(o.parentNode.nodeName=="CAPTION"||!o.parentNode.nodeName)){w=h.Node.nextElement(o.parentNode)}else{if(o.nextSibling.nodeType==8&&o.nextSibling.nodeValue.startsWith("_ZVING_DATALIST_END")){return[]}w=h.Node.nextElement(o)}if(w){if(/^(th|td|tr|tb|tf)/i.test(w.nodeName)){u=h.Node.getParent(w,"table");t=[];for(var s=0,q=u.rows.length;s<q;s++){var y=u.rows[s];if(y.getAttribute("ztype")!="head"){t.push(y)}}}else{u=w.parentNode;var x=u.children;t=[];for(var s=0,q=x.length;s<q;s++){if(!/^(input|script|hr|img|br)$/i.test(x[s].nodeName)){t.push(x[s])}}}for(var r=0,p=t.length;r<p;r++){t[r]._is_datalist_row=r}}this.$listNodes=$(t);t=null}return this.$listNodes},getRowIndex:function(p){var o=this.getListNodes();var n=o.index(p);return n},getListContainer:function(){var p=this.el;var o=$(p);var n,s,r,q;if(!o.data("listContainer")){if(o.attr("listcontainer")){this.listContainer=$(o.attr("listcontainer")).get(0)}else{n=this.getListNodes();if(n.length){q=n[0];s=q.parentNode}else{s=p.parentNode}this.listContainer=s}}return this.listContainer},_sortable:function(n,s,o){var q=this;var p=q.el;var t=q.getListContainer(p);var r={};if(n){r.handle=n}if(s){r.items=s}if(o){r.start=function(u,w){w.item.data("originalIndex",q.getRowIndex(w.item))};r.stop=function(){o.apply(this,Array.prototype.slice.call(arguments).concat(p))}}r.helper=function(u,x){var w=x[0].outerHTML;w=w.replace(/^(<\w+)([^>]*)>/igm,'$1 style="background-color:#ffe; border: 1px solid #ddd">').replace(/ id="/igm,' sortable_id="');return w};r.axis="y";this.$listContainer=$(t);this.$listContainer.sortable(r)},setSortable:function(p){var n=this;var o=n.getListContainer(el);n.$listContainer=$(o);if(n.$listContainer.data("sortable")){n.$listContainer.sortable("destroy")}n.$listContainer.sortable({disabled:!p})},showLoading:function(){var s=this;var n=s.el;var q=s.getListContainer();var t=m("#_LoadingBGDiv");var y=m("#_LoadingIconDiv");if(!t){t=document.createElement("div");t.id="_LoadingBGDiv";g.hide(t);t.style.cssText="background-color:#FCFCFC;position:absolute;z-index:800;opacity:0.2;filter:alpha(opacity=20);";document.body.appendChild(t);t=$(t);y=document.createElement("div");y.id="_LoadingIconDiv";g.hide(y);y.style.cssText="padding-top:5px;background-color:#ffc;position:absolute;z-index:801;height:20px;width:120px";document.body.appendChild(y);y.innerHTML="　<img src='"+j+"framework/images/loadingGreen15px.gif'><font color=green> "+e.get("DataGrid.Loading")+"　</font>"}var r=$(t);var p=$(y);if(/^(tbody)/i.test(q.nodeName)){q=q.parentNode}if(!h.Node.isVisible(q)){return}var u=$(q).offset();var x=q.offsetWidth,o=q.offsetHeight;if(u.top||u.left){r.css({top:u.top+"px",left:u.left+"px",width:x+"px",height:o+"px"});p.css({top:u.top+(h.isIE?2:0)+"px",left:u.left+(h.isIE?2:0)+"px"})}r.show();p.show()},hideLoading:function(){$("#_LoadingBGDiv").hide();$("#_LoadingIconDiv").hide()},changePageSize:function(n){this.setParam(b.Size,n);this.loadData(null,null,null,true);this.autoPageSize=false},loadData:function(p,u,q,t){var r=this;var o=r.el;var w=$(o);var n=o.id;if(r.isDataLoading){return}r.isDataLoading=true;if(!u){u={}}else{if(u instanceof h.DataCollection){u=h.mix({},u.map)}}h.mix(u,r.params);if(!t){u[b.PageTotal]=-1}r.showLoading();var s=h.getDom(r.el.id+"_AllCheck");if(s&&s.checked){s.checked=false}h.Server.sendRequest(c.BackendMethod,u,function(B){setTimeout(r.hideLoading,200);if(B._ZVING_STATUS===0&&B._ZVING_MESSAGE){r.isDataLoading=false;Dialog.alert(B._ZVING_MESSAGE);return}var D=B.HTML;if(!D||D.length<10){h.Console.error("用于渲染数据列表的数据错误：",B);r.isDataLoading=false;return}if(h.isIE&&r.$listContainer){if(r.$listContainer.data("sortable")){r.$listContainer.sortable("destroy")}}if(this.$listNodes){this.$listNodes.off();this.$listNodes=null}var x=o.parentNode;r.fireEvent("beforeupdate");while(x){if(x.tagName&&!(h.isIE&&/^(table|tbody|tr)$/i.test(x.tagName))){var F=x.innerHTML;var A=F.indexOf("<!--_ZVING_DATALIST_START_"+n+"-->");var z=F.indexOf("<!--_ZVING_DATALIST_END_"+n+"-->");z=F.indexOf("-->",z)+3;F=F.substring(0,A)+D+F.substring(z);F=F.replace(new RegExp(" "+$.expando+'="\\d+"',"igm"),"");jQuery.cleanData(x.getElementsByTagName("*"));x.innerHTML=F;break}x=x.parentNode}o=null;r.el=o=m(n);o._components=o._components||{};o._components[r.ctype]=r.id;x=o.parentNode;while(x){if(x.tagName){break}x=x.parentNode}h.ComponentManager.initChildren(x);r.isDataLoading=false;var C=x.getElementsByTagName("script");for(i=0;i<C.length;i++){h.Util.globalEval(C[i].text)}r.restore();if(p){p.call(r,B)}r.fireEvent("loaddata");r.resumePagebar();r.sortableInit();if(r.afterUpdate){r.afterUpdate()}r.fireEvent("update");if(r.recordsSelected&&r.recordsSelected.length){var y=[];var E=r.recordsSelected[r.recordsSelected.length-1];if(r.$listNodes){r.$listNodes.each(function(H,I){var G=k(I);if(G&&r.recordsSelected.indexOf(G.value)!==-1){y.push(G)}})}y.sort(function(H,G){return H.value===E?1:(G.value===E?-1:0)});$.each(y,function(H,G){G.checked=true;$(G).trigger("change")})}o=w=null;x=null;p=null},null,null,"json")},beforeDestroy:function(){if(this.dom.pagebarWrap){jQuery.cleanData(this.dom.pagebarWrap.getElementsByTagName("*"))}if(this.$checkboxs){jQuery.cleanData(this.$checkboxs);delete this.$checkboxs}if(this.$listNodes){this.$listNodes.each(function(){this.onclick=this.ondblclick=null});jQuery.cleanData(this.$listNodes);delete this.$listNodes}if(this.$listContainer){if(this.$listContainer.data("sortable")){this.$listContainer.sortable("destroy")}jQuery.cleanData(this.$listContainer);delete this.$listContainer}if(this.listContainer){jQuery.cleanData([this.listContainer]);delete this.listContainer}}});var a="gotoPage,firstPage,previousPage,nextPage,lastPage,getParam,setParam,loadData,showLoading,hideLoading,getRowIndex,getListNodes,changePageSize";a.split(",").each(function(n){c[n]=function(q){var p=h.toArray(arguments,1);var o=h.ComponentManager.getByDom(q,"DataList");if(o){return o[n].apply(o,p)}}});c.init=function(n){n=m(n);var o=h.ComponentManager.getByDom(n,"DataList");o.initFromDom(n)};h.DataList=c})();
/*! Uploader */
(function(){var z=window.Zving,Uploader;Uploader=function(config){if(!(this instanceof Uploader)){return z.ComponentManager.getByDom(z.getDom(config),"Uploader")}if(typeof config=="string"){this.id=config;var el=document[config];if(!el){z.Console.error("不存在id为 "+config+" 的uploader控件，请核对id！");return}if(!z.isIE&&el.tagName=="OBJECT"){var embed=el.getElementsByTagName("EMBED")[0];if(embed){el=embed}}this.ele=el}else{if(!config||typeof config=="object"){z.mix(this,config,{id:"ZUploader_"+(++z.idSeed._seed),width:250,height:25,allowType:"gif,jpg,png,bmp,psd,ai,jpeg,tif,tiff,avi,mpg,flv,mpeg,rm,rmvb,mov,wmv,wmp,mp4,mp3,wma,wav,zip,rar,tar,gz,z,iso,cab,jar,doc,docx,xls,xlsx,ppt,pptx,pdf,fla,swf,js,css,shtml,html,htm,txt"});if(this.renderTo){this.render(this.renderTo);delete this.renderTo}}}z.ComponentManager.register(this)};Uploader.BackendMethod_Sumbit="com.zving.framework.ui.control.UploadUI.submit";Uploader.BackendMethod_getSessionID="com.zving.framework.ui.control.UploadUI.getSessionID";Uploader.BackendMethod_GetTaskStatus="com.zving.framework.ui.control.UploadUI.getTaskStatus";Uploader.swfPath=z.JSLIBPATH+"components/ZUploader2.swf";Uploader.prototype={ctype:"Uploader",getString:function(){var flashVars="";if(this.allowType){flashVars+="fileType="+this.allowType}if(this.fileCount){flashVars+="&fileCount="+this.fileCount}if(this.fileMaxSize){flashVars+="&fileMaxSize="+this.fileMaxSize}if(this.barColor){flashVars+="&barColor="+this.barColor}var opt={id:this.id,width:this.width,height:this.height,swfPath:Uploader.swfPath,flashVars:flashVars};var html=[];if(z.isIE){html.push('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"');html.push(' id="{id}" name="{id}" width="{width}" height="{height}" style="vertical-align:middle;">');html.push('	<param name="movie" value="{swfPath}">')}else{html.push('<object type="application/x-shockwave-flash" data="{swfPath}"');html.push(' id="{id}" name="{id}" width="{width}" height="{height}" style="vertical-align:middle;">')}html.push('	<param name="quality" value="high">');html.push('	<param name="wmode" value="transparent">');html.push('	<param name="allowScriptAccess" value="always">');html.push('	<param name="allowNetworking" value="all">');html.push('	<param name="FlashVars" value="{flashVars}">');html.push("</object>");html=html.join("");html=z.String.tmpl(html,opt);return html},render:function(container){container=z.getDom(container);$(container).append(this.getString());this.ele=document[this.id];Zving.Uploader.checkVersion();return this},sendRequest:function(method,dc,func,id,noSession,resultDataFormat){var me=this;if(!window._ZUploaderSessionID){z.Server.sendRequest(Uploader.BackendMethod_getSessionID,{},function(res){if(!res||!res.sessionID){throw new Error("没有取到sessionID，文件无法上传。")}Uploader.setSessionID(res.sessionID);me.sendRequest(method,dc,func,id,noSession,resultDataFormat)});return}this.setSessionID();if(!Uploader.CallbackList){Uploader.CallbackList={}}Uploader.CallbackList[this.id]=func;if(this.hasFile()){if(dc&&typeof(dc)=="object"&&dc.map){this.ele.addPostParam(dc.toQueryString())}else{if(dc&&typeof(dc)=="object"&&!dc.map){this.ele.addPostParam($.param(dc))}}this.ele.setMethod(method);this.ele.doUpload();setTimeout(function(){Uploader.getTaskStatus(me.ele.getTaskID(),me.id)},1000)}else{if(dc&&typeof(dc)=="object"&&dc.map){dc.add("_ZVING_METHOD",method)}else{if(dc&&typeof(dc)=="object"&&!dc.map){dc._ZVING_METHOD=method}}z.Server.sendRequest(Uploader.BackendMethod_Sumbit,dc,function(response){if(func){func(response)}},id,noSession,resultDataFormat)}},hasFile:function(){return this.ele.hasFile()},hasError:function(){return this.ele.hasError()},getFileNames:function(){return this.ele.getFileNames()},setFileNames:function(arr){return this.ele.setFileNames(arr)},setSessionID:function(sessionID){if(sessionID){return this.ele.setSessionID(sessionID)}return this.ele.setSessionID(Uploader.getSessionID())},onFileSelect:function(func){this.ele._OnFileSelect=func},destroy:function(){delete this.onFileSelect;delete this.ele;z.ComponentManager.unregister(this)}};Uploader.onRequestComplete=function(id,xml){if(!Uploader.CallbackList){return}var func=Uploader.CallbackList[id];if(!func){return}var dc=new z.DataCollection();dc.parseXML(z.toXMLDOM(xml));dc.Status=dc.get("_ZVING_STATUS");dc.Message=dc.get("_ZVING_MESSAGE");if(dc.get("_ZVING_SCRIPT")){eval(dc.get("_ZVING_SCRIPT"))}dc=dc.map;if(dc._ZVING_STATUS!==undefined){dc.Status=dc._ZVING_STATUS}if(dc._ZVING_MESSAGE!==undefined){dc.Message=dc._ZVING_MESSAGE}if(func){func(dc)}};Uploader.getTaskStatus=function(taskID,id){var dc={TaskID:taskID};z.Server.sendRequest(Uploader.BackendMethod_GetTaskStatus,dc,function(response){if(document[id]){document[id].setStatusStr(response.StatusMsg)}if(!/^(Error|Finished)/.test(response.StatusMsg)){setTimeout(Uploader.getTaskStatus(taskID,id),1000)}})};Uploader.resize=function(id,fileCount){var h=24;if(fileCount>1){fileCount=fileCount>10?10:fileCount;h=28+24*fileCount}document[id].height=h};Uploader.afterFileSelect=function(id,fileNames){var func=document[id]._OnFileSelect;if(func){func(""+fileNames)}};Uploader.getAction=function(){var url=z.CONTEXTPATH+"ZUploader.zhtml";return url};Uploader.getSessionID=function(){return window._ZUploaderSessionID};Uploader.setSessionID=function(sessionID){return window._ZUploaderSessionID=sessionID};Uploader.checkVersion=function(){var _FlashVersionOK=false;var _FlashVersion=(function(){var f="",n=navigator,ii;if(n.plugins&&n.plugins.length){for(ii=0;ii<n.plugins.length;ii++){if(n.plugins[ii].name.indexOf("Shockwave Flash")!=-1){f=n.plugins[ii].description.split("Shockwave Flash ")[1];break}}}else{if(window.ActiveXObject||z.isIE11){for(ii=10;ii>=2;ii--){try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){f=ii+".0";break}}catch(e){}}}}return f})();if(_FlashVersion){_FlashVersion=_FlashVersion.substr(0,_FlashVersion.indexOf("."));if(_FlashVersion>=10){_FlashVersionOK=true}}if(!_FlashVersionOK){var alertNoFlashPlugin=Lang.get("Uploader.NoFlashPlugin").format(_FlashVersion);document.write(alertNoFlashPlugin)}};var MultiUploader=function(){this.Uploaders=[];this.id="z_MultiUploader_"+(++z.idSeed._seed),z.ComponentManager.register(this)};MultiUploader.prototype={ctype:"MultiUploader",addUploader:function(uploader){if(typeof uploader=="string"){uploader=new Uploader(uploader)}this.Uploaders.push(uploader)},hasError:function(uploader){for(var i=0;i<this.Uploaders.length;i++){if(this.Uploaders[i].hasError()){return true}}return false},sendRequest:function(method,dc,func){var me=this;if(!window._ZUploaderSessionID){z.Server.sendRequest(Uploader.BackendMethod_getSessionID,{},function(res){if(!res||!res.sessionID){throw new Error("没有取到sessionID，文件无法上传。")}Uploader.setSessionID(res.sessionID);me.sendRequest(method,dc,func)});return}var taskID=new Date().getTime()+""+Uploader.getSessionID();var total=0,i=0;for(i=0;i<this.Uploaders.length;i++){if(this.Uploaders[i].hasError()){return}if(this.Uploaders[i].hasFile()){total+=this.Uploaders[i].getFileNames().length}}for(i=0;i<this.Uploaders.length;i++){this.Uploaders[i].ele.setTaskID(taskID);this.Uploaders[i].ele.setTotal(total)}for(i=0;i<this.Uploaders.length;i++){if(this.Uploaders[i].hasFile()){this.Uploaders[i].sendRequest(method,dc,function(response){if(response._ZVING_MESSAGE||response._ZVING_STATUS){func(response)}},null,null,"json")}}},destroy:function(){for(i=0;i<this.Uploaders.length;i++){this.Uploaders[i].destroy&&this.Uploaders[i].destroy()}this.Uploaders.length=0;delete this.Uploaders;z.ComponentManager.unregister(this)}};z.MultiUploader=MultiUploader;z.Uploader=Uploader})();(function(){var f=window.Zving,b=f.Node,e,d,a,c;e=function(g){f.mix(this,g);f.Observable(this);this.getId();this.initComponent()};f.Class.extend(e,f.UICompBase,{ctype:"fieldEditor.Label",isLabel:true,isFormField:true,renderTpl:"<label></label>",initDom:function(){var g=this;g.inputEl=g.el.firstChild;g.$inputEl=$(g.inputEl);if(g.value){g.inputEl.innerHTML=g.value}},isDirty:function(){return false},isValid:function(){return true},validate:function(){return true},setValue:function(h){var g=this;g.setRawValue(h);g.value=h;g.checkValueChange();return g},setRawValue:function(h){var g=this;if(g.inputEl){g.inputEl.innerHTML=g.value}g.rawValue=h;return h},getValue:function(){return this.value},resetOriginalValue:function(){this.originalValue=this.getValue();this.checkDirty()},checkValueChange:function(){if(!this.suspendCheckValueChange){var j=this,h=j.getValue(),g=j.lastValue;if(String(h)!=String(g)&&!j.isDestroyed){console.log("编辑器的值改变了",h,g);j.lastValue=h;j.fireEvent("change",j,h,g);j.onChange(h,g)}}},onChange:function(h,g){if(this.validateOnChange){this.validate()}this.checkDirty()},isDirty:function(){var g=this;return !g.disabled&&g.getValue()!=g.originalValue},checkDirty:function(){var g=this,h=g.isDirty();if(h!==g.wasDirty){g.fireEvent("dirtychange",g,h);g.onDirtyChange(h);g.wasDirty=h}},onDirtyChange:f.noopFn,setWidth:function(g){this.width=g;if(this.inputEl){this.inputEl.style.width=g+"px"}}});d=function(g){var h=this;f.mix(this,g);if(typeof this.verify=="string"){this.validator=function(j){return f.Verify.getErrors(j,h.verify)}}f.Observable(this);h.addEvents("specialkey","autosize","keydown","keyup","keypress");this.getId();h.initComponent()};d.renderTpl='<input type="text" value="{value}" class="inputText" autocomplete="off"/>';f.Class.extend(d,f.UICompBase,{ctype:"fieldEditor.Text",isFormField:true,checkValueChangeEvents:f.isIE&&(!document.documentMode||document.documentMode<9)?"change propertychange":"change input textInput keyup dragdrop",hasFocus:false,renderTpl:d.renderTpl,validateOnBlur:true,validateOnChange:true,suspendCheckValueChange:0,initComponent:function(){var g=this;g.initValue()},initValue:function(){var g=this;g.originalValue=g.lastValue=g.value;g.suspendCheckValueChange++;g.setValue(g.value);g.suspendCheckValueChange--},onChangeEvent:50,initEvents:function(){var g=this,j=g.inputEl,h=g.$inputEl;if(g.selectOnFocus||g.emptyText){h.on("mousedown",function(k){g.onMouseDown(k)})}if(g.maskRe||(g.vtype&&g.disableKeyFilter!==true)){h.on("keypress",function(k){g.onMouseDown(k)})}if(j){h.on("keydown",function(k){g.fireKey(k)});g.onChangeEvent=function(k){if(g.onChangeTask){clearTimeout(g.onChangeTask)}g.onChangeTask=setTimeout(function(){g.checkValueChange()},g.checkValueChangeBuffer)};h.on(g.checkValueChangeEvents,g.onChangeEvent)}if(g.enableKeyEvents){h.on("keyup",function(k){g.onKeyUp(k)});h.on("keydown",function(k){g.onKeyDown(k)});h.on("keypress",function(k){g.onKeyPress(k)})}},isEqual:function(h,g){return String(h)==String(g)},checkValueChange:function(){if(!this.suspendCheckValueChange){var j=this,h=j.getValue(),g=j.lastValue;if(String(h)!=String(g)&&!j.isDestroyed){console.log("编辑器的值改变了",h,g);j.lastValue=h;j.fireEvent("change",j,h,g);j.onChange(h,g)}}},onChange:function(h,g){if(this.validateOnChange){this.validate()}this.autoSize()},initDom:function(){var g=this;g.inputEl=g.el.firstChild;g.$inputEl=$(g.inputEl);if(g.value){g.inputEl.value=g.value}},afterRender:function(){this.initDom();this.autoSize();this.initEvents()},onMouseDown:function(h){var g=this;if(!g.hasFocus){g.$inputEl.one("mouseup",function(j){j.preventDefault()})}},onKeyDown:function(g){this.fireEvent("keydown",this,g)},onKeyUp:function(g){this.fireEvent("keyup",this,g)},onKeyPress:function(g){this.fireEvent("keypress",this,g)},reset:function(){},setValue:function(h){var g=this;g.setRawValue(h);g.value=h;g.checkValueChange();return g},setRawValue:function(h){var g=this;if(g.inputEl&&g.inputEl.value!=String(h)){g.inputEl.value=String(h)}g.rawValue=h;return h},getValue:function(){var g=this,h=g.inputEl;if(h){return h.value}return g.value},validate:function(){var g=this,h=g.isValid();if(h!==g.wasValid){g.wasValid=h;g.fireEvent("validitychange",g,h)}return h},isValid:function(){var h=this,g=h.disabled,j=h.forceValidation||!g;return j?h.validateValue(h.inputEl.value):g},validateValue:function(h){var g=this,k=g.getErrors(h),j=!k||!k.length;if(!g.preventMark){if(j){g.validTip&&g.validTip.hide()}else{if(!g.validTip){g.validTip=new f.Tip(g.inputEl,{theme:"notice"})}g.validTip.show(k.join("<br>"))}}return j},getErrors:function(j){var h=this;var g=this.validator;if(g){return g.call(h,j)}return[]},autoSize:function(){var g=this;if(g.grow&&g.rendered){g.autoSizing=true;g.updateLayout()}},setWidth:function(g){this.width=g;if(this.inputEl){this.inputEl.style.width=g+"px"}},fireKey:function(g){if(f.Event.isSpecialKey(g)){this.fireEvent("specialkey",this,g)}},getFocusEl:function(){return this.inputEl},beforeDestroy:function(){if(this.$inputEl){this.ownerWindow.jQuery.cleanData(this.$inputEl);delete this.inputEl;delete this.$inputEl}delete this.validator}});c=function(g){var h=this;f.mix(this,g);if(typeof this.verify=="string"){this.validator=function(j){return f.Verify.getErrors(j,h.verify)}}f.Observable(this);h.addEvents("specialkey","autosize","keydown","keyup","keypress");this.getId();h.initComponent()};f.Class.extend(c,d,{ctype:"fieldEditor.Number",isFormField:true,afterRender:function(){var g=this;g.inputEl=g.el.firstChild;g.$inputEl=$(g.inputEl);if(g.value){g.inputEl.value=g.value}g.$inputEl.on("keydown",function(h){g.fireKey(h)});this.NumberField=new NumberField(g.inputEl)}});a=function(g){var h=this;f.mix(this,g);if(typeof this.verify=="string"){this.validator=function(j){return f.Verify.getErrors(j,h.verify)}}f.Observable(this);h.addEvents("specialkey","autosize","keydown","keyup","keypress");this.getId();h.initComponent()};f.Class.extend(a,d,{ctype:"fieldEditor.Datetime",isFormField:true,afterRender:function(){var j=this;j.inputEl=j.el.firstChild;j.$inputEl=$(j.inputEl);if(j.value){j.inputEl.value=j.value}j.$inputEl.on("keydown",function(k){j.fireKey(k)});var g={date:"framework/images/Calendar.gif",time:"framework/images/TimeSelector.gif",datetime:"framework/images/DateTime.gif"};ztype="datetime";j.inputEl.insertAdjacentHTML("afterEnd",'<img class="z-datepicker-trigger" src="'+f.CONTEXTPATH+g[ztype]+'" align="absmiddle" width=18 vspace=1 style="margin-left:-22px; cursor:pointer;"/>');var h=j.inputEl.nextSibling;this.picker=new Calendar({targetEl:j.inputEl,triggerEl:h,showTime:true});this.picker.on("timeSelect",function(m){var k=f.Date.format(m.date,"yyyy-MM-dd hh:mm:ss");if(this.targetEl.value!=k){this.targetEl.value=k;this.$targetEl.change()}})}});f.fieldEditor=f.fieldEditor||{};f.fieldEditor.Label=e;f.fieldEditor.Text=d;f.fieldEditor.Datetime=a;f.fieldEditor.Number=c})();
/*! Combox */
(function(){var f=window.Zving,c=f.isIE,b=f.isGecko,j=f.getDom,e=f.Node,h=f.CONTEXTPATH,g;g=function(k){if(!(this instanceof g)){return f.ComponentManager.getByDom(f.getDom(k),"Combox")}this.defaultConfig={data:[]};this.params={};g.superclass.constructor.apply(this,arguments);if(typeof this.verify=="string"){this.validator=function(m){return f.Verify.getErrors(m,me.verify)}}};g.BackendMethod="com.zving.framework.ui.CodeSourceUI.getData";g.expanded=null;g.renderTpl='<input id="{id}" name="{name}" ztype="select" type="text" tabindex="-1" autocomplete="off" class="inputText" style="position:absolute;z-index:-1;" value="{value}"><input id="{id}_textField" name="{name}_text" type="text" autocomplete="off" class="inputText" style="vertical-align: middle; cursor: default;" value=""><a id="{id}_spinner" class="z-combox-spinner" href="javascript:void(0);" style="position:relative; left:-17px; margin-right:-15px; cursor:pointer; width:13px; height:15px;vertical-align:middle;"><b></b></a><div id="{id}_list" class="optgroup" style="text-align:left;display:none;"><div id="{id}_ul" style="left:-1px; width:-1px;"></div></div>';g.itemTpl='<a value="?" hidefocus href="javascript:void(0);" class="?">?</a>';function a(m){for(var k=0;k<m.length;k++){m[k].value=m[k].getAttribute("value");if(f.isIE){m[k].text=m[k].innerText}}}f.Class.extend(g,f.UICompBase,{ctype:"Combox",cls:"z-combox",disabledClass:"z-combox-disabled",style:"display:inline-block; *zoom: 1;*display: inline;vertical-align:middle;height:auto;width:auto;position:relative;border:none 0;margin:0;padding:0;white-space: nowrap",renderTpl:g.renderTpl,itemTpl:g.itemTpl,zIndex:10900,editable:false,maxListHeight:280,minListWidth:55,selectedIndex:0,showFilterInput:16,validateOnBlur:true,validateOnChange:true,suspendCheckValueChange:0,suspendCheckSelectedIndexChange:0,suspendCheckDisabledChange:0,hasFocus:false,isFormField:true,initComponent:function(){var k=this;g.superclass.initComponent.apply(this);this.addEvents("specialkey","expand","collapse","beforeselect","select","itemclick","spinnerclick");k.initValue();if(this.el&&!k.originEL){k.setParemFormEl();this.initDom();k.originEL={}}},initValue:function(){var k=this;k.originalValue=k.lastValue=k.value},initRenderData:function(){this.renderData=this.renderData||{};return f.mixIf(this.renderData,{id:this.id,name:this.name||this.id,value:this.value||"",cls:this.cls})},initFromDom:function(p){var t=this,n=j(p);if(n.id){this.id=this.ctype+"_"+n.id}else{this.getId()}if(n.name){this.name=n.name}if(n.tagName=="SELECT"&&!n.comboxId){if(n.id&&f.getDom(n.id)!==n){alert("页面内有多个id为"+n.id+"的元素，导致zSelect控件不能正常初始化，请更正。");return}if(n.id){this.id=n.id}var s=this.data=[],k=n.options;for(var q=0,r=k.length;q<r;q++){var m=k[q],u=(m.hasAttribute?m.hasAttribute("value"):m.getAttributeNode("value").specified)?m.value:m.text;if(m.selected&&f.isEmpty(t.value,true)){t.value=this.startValue=u}s.push([u,m.text])}this.el=null;t.setParemFormEl(n);t.originEL=n;t.originEL.id="";t.originEL.name="";t.render(n.parentNode,n);t.afterRenderFormSelect();n=this.el}else{}return{el:n}},afterRender:function(k){var m=this;this.initDom();this.simulateSelect()},afterRenderFormSelect:function(){var r=this;var m=r.originEL.style.cssText;var s=/\bwidth\s*:\s*([\d\.\-]+[%\w]*)\s*;?\s*(\b|$)/i;var o=s.exec(m);var q;if(o&&o[1]){q=o[1]}else{if(r.originEL.options.length>0){q=r.originEL.clientWidth-2}q=q||(f.isIE?115:118)}r.setWidth(q);var n={onclick:function(){r.listenerClick()},onchange:1,verify:f.Verify.initCtrl};var k;for(var p in n){k=r.originEL.getAttribute(p);if(k){r.el.setAttribute(p,k);r.originEL.removeAttribute(p);if(typeof n[p]=="function"){n[p](r.el)}}}r.originEL.style.display="none"},setParemFormEl:function(k){k=k||this.el;if(k.getAttribute("listurl")){this.url=k.getAttribute("listurl")}if(k.getAttribute("listwidth")){this.listWidth=parseInt(k.getAttribute("listwidth"),10)}if(k.getAttribute("listheight")){this.listHeight=parseInt(k.getAttribute("listheight"),10)}if(k.getAttribute("selectedindex")){this.selectedIndex=parseInt(k.getAttribute("selectedindex"),10)}if(k.getAttribute("startvalue")){this.startValue=k.getAttribute("startvalue")}if(k.getAttribute("autowidth")=="true"){this.autoWidth=true}if(k.getAttribute("lazy")=="true"){this.lazyLoad=true}if(k.getAttribute("input")=="true"){this.editable=true}if(k.disabled===true||k.getAttribute("disabled")=="true"){this.disabled=true}if(k.getAttribute("defaultblank")=="true"){this.defaultBlank=true}if(k.getAttribute("code")){this.setParam("CodeType",k.getAttribute("code"))}if(k.getAttribute("method")){this.setParam("Method",k.getAttribute("method"))}if(k.getAttribute("conditionField")){this.setParam("ConditionField",k.getAttribute("conditionField"))}if(k.getAttribute("conditionValue")){this.setParam("ConditionValue",k.getAttribute("conditionValue"))}},setParam:function(n,m,k){this.params[n]=m;if(k!==undefined){this[n]=k}},getParam:function(k){return this.params[k]},initDom:function(){var m=this;var k=m.el;var n=k.id;if(k!=f.getDom(n)){f.Console.error("页面中存在多个id为"+n+"的元素，导致zSelect控件不能正常初始化，请更正。");return}k.style.visibility="hidden";m.dom={};m.$el=$(m.el);m.outerEl=j(n+"_outer");m.$outerEl=$(m.outerEl);if(f.isIE6&&m.outerEl.parentNode.tagName=="TD"){m.outerEl.parentNode.style.position="relative"}m.dom.textField=j(n+"_textField");m.dom.$textField=$(m.dom.textField);m.dom.spinner=j(n+"_spinner");m.dom.$spinner=$(m.dom.spinner);m.inputEl=k;m.$inputEl=m.$el;if(k.value){m.value=k._value=k.value;m.selectedIndex=k._selectedIndex=k.selectedIndex=m.findIndexByValue(m.value)}if(m.dom.textField.value===""){if(m.value){m.setText(m.findTextByValue(m.value))}else{if(m.data.length>0){if(m.selectedIndex==-1||m.selectedIndex>m.data.length){this.el.selectedIndex=this.el._selectedIndex=this.selectedIndex=0}k.value=k._value=m.value=m.data[m.selectedIndex][0];m.text=m.dom.textField.value=m.data[m.selectedIndex][1]}}}if(m.autoWidth){m.contractWidth()}if(m.disabled){m.disable()}m.initEvents()},simulateSelect:function(){var m=this;m.initList();if(f.isIE){m.el.options=f.toArray(m.el.options)}var k=m.el.options;k.add=function(n){if(typeof n=="object"&&(n.value||n.text)){m.add(n.value,n.text)}}},listenerClick:function(){var k=this;k.on("itemclick",function(m){k.$el.click()});k.on("click",function(m){k.$el.click()})},initEvents:function(){var k=this;k.dom.$textField.on("selectstart contextmenu",function(m){if(!k.editable){m.preventDefault()}});k.dom.$textField.on("focus",function(m){if(!k.disabled){k.onFocus();k.expand()}if(!k.editable){m.preventDefault()}});k.dom.$textField.on("blur",function(m){if(!k.disabled){k.onBlur()}});k.dom.$textField.on("keydown",function(m){if(m.keyCode==f.Event.keys.tab){k.onTabKey();k.fireEvent("specialkey",k,m)}else{if(f.Event.isSpecialKey(m)){if(!k.isExpanded()&&m.keyCode==f.Event.keys.down){k.onDownArrow(m)}else{if(m.keyCode==f.Event.keys.esc){k.onEscKey(m)}else{if(m.keyCode==f.Event.keys.enter){k.onEnterKey(m)}else{k.textField_onKeyDown(m)}}}k.fireEvent("specialkey",k,m)}m.stopPropagation();m.preventDefault()}});k.dom.$textField.on("keyup",function(m){if(!k.disabled){k.textField_onKeyUp(m)}});k.dom.$textField.on("mousedown",function(m){if(!k.disabled){k.focus();k.onTextFieldMouseDown(m);if(!k.hasFocus){k.dom.$textField.one("mouseup",function(n){n.preventDefault()})}k.fireEvent("mousedown",m)}});k.dom.$spinner.on("mousedown",function(m){k.onTriggerMouseDown(m)});if(k.editable){k.dom.textField.readOnly=false}else{k.dom.textField.readOnly=true}if(k.disabled){k.dom.textField.tabIndex=-1}else{k.dom.textField.tabIndex=undefined}e.onPropertyChange(k.el,"disabled",k.checkDisabledChange,k);e.onPropertyChange(k.el,"selectedIndex",k.checkSelectedIndexChange,k);e.onPropertyChange(k.el,"value",k.checkValueChange,k)},onDownArrow:function(k){if(!this.isExpanded()){this.onTriggerMouseDown(k)}},onEnterKey:function(k){if(this.isExpanded()){this.onTriggerMouseDown(k)}},setInput:function(k){this.editable=k;if(!k){me.dom.textField.style.MozUserSelect="none";this.removeClass("z-combox-editable")}else{me.dom.textField.style.MozUserSelect="";this.addClass("z-combox-editable")}},initList:function(){var m=this;if(m.list||m.isDestroyed||m.destroying){return}m.list=new f.Layer({id:f.pageId+"_"+m.id+"_list",cls:"z-menu",shadow:m.shadow,parentEl:f.rootDoc.body,zIndex:m.zIndex});var p=m.listWidth||Math.max(m.dom.textField.offsetWidth,m.minListWidth);m.list.setSize(p);var o=m.list.el;o.style.left="-999px";o.style.top="-999px";if(m.syncFont!==false){o.style.fontSize=m.dom.$textField.css("fontSize")}if(m.url){o.innerHTML=m.getDropListString();var n=m.dom.iframe=m.list.el.getElementsByTagName("IFRAME")[0];var q=function(){var r=f.rootWin.$(".z_loading",m.list.el);if(r.length){r.hide()}if(m.onLoad){m.onLoad.call(m,n.contentWindow);m.onLoad=null}m.innerWin=n.contentWindow;n.contentWindow.ownerCombox=m;n.contentWindow.comboxOpener=window;n.contentWindow.SelectedText=m.text=m.dom.textField.value;n.contentWindow.SelectedValue=m.value=m.el.value;n.contentWindow.SelectorID=m.id;m.resetListSize()};var k=function(){if(m.onLoad){m.onLoad.call(m,m.innerWin);m.onLoad=null}};n.onready=q;if(!f.isGecko){f.rootWin.$(n).on("load.select",function(){k()})}else{n.onload=function(){k()}}}else{o.innerHTML=m.getDropListString();m.el.options=o.getElementsByTagName("A");m.el.length=m.el.options.length;a(m.el.options);this.list.$el.on("click","a",function(r){m.onItemClick(r)});if(m.hasFilterInput){m.initFilterInput()}}o=null},resetListSize:function(){},updateDropList:function(k){if(!this.list){this.initList()}k=k||this.data;this.list.$el.html(this.getDropListString(k));if(this.hasFilterInput){this.initFilterInput()}},updateListHtml:function(k){k=k||this.data;this.list.dom.$listGroup.html(this.getListString(k))},initFilterInput:function(){var k=this;k.list.dom.$filterInput=k.list.$el.find("input.filterInput");k.list.dom.$listGroup=k.list.$el.find("div.optgroup");k.list.dom.listGroup=k.list.dom.$listGroup.get(0);k.list.dom.$filterInput.on("keyup",function(m){k.filterInput_onKeyUp(m)});k.list.dom.$filterInput.on("keydown",function(m){k.filterInput_onKeyDown(m)})},filterInput_onKeyUp:function(k){var m=this;var n=k.keyCode;if(n===8||n>31){var o=m.list.dom.$filterInput.val();if(o!=m.lastFilterStr){m.lastFilterStr=o;m.filter(m.list.dom.$filterInput.val())}}},resumeList:function(){var k=this;if(!k.url){k.el.options=this.list.el.getElementsByTagName("A");k.el.length=k.el.options.length;a(k.el.options)}},getDropListString:function(n){var m=this;if(m.url){return'<div class="z_loading"><span>loading..</span></div><iframe id="'+m.id+'_combox_frame" ownercomboxid="'+m.id+'" class="combox-iframe" width="100%" height="'+(m.listHeight||280)+'" frameborder="0" src="about:blank" style="border: 0px solid #667788;"></iframe>'}n=n||this.data;var k=[];if(m.showFilterInput&&n.length>m.showFilterInput){k.push('<div class="filter"><input class="filterInput" style="margin:1px 0 1px 1px;width:'+(m.list.width?m.list.width-10+"px":"96%")+';" type="text"/></div>');m.hasFilterInput=true}else{m.hasFilterInput=false}k.push('<div class="optgroup">');k.push(m.getListString(n));k.push("</div>");return k.join("")},getListString:function(n){n=n||this.data;var k=[];for(var m=0;m<n.length;m++){k.push(this.itemTpl.format(n[m][0],this.value==n[m][0]?"selected":"",n[m][1]===undefined?n[m][0]:n[m][1]))}return k.join("")},filterInput_onKeyDown:function(m){var n=m.keyCode;var k=m.target;if(n===f.Event.keys.esc||n==f.Event.keys.tab){me.collapse()}},textField_onKeyDown:function(n){var p=this,m=p.dom.textField;var q=n.keyCode;var k=n.target;if(!p.filteredData){p.filteredData=[];for(var o=0;o<p.data.length;o++){p.filteredData.push(p.data[o].concat(o))}}var r=false;p.pressingCount=0;if(q===f.Event.keys.down||q===f.Event.keys.up){if(p.pressingCount++===0){r=true;if(q===f.Event.keys.down){if(p.innerWin&&p.innerWin.nextItem){p.innerWin.nextItem()}else{p.selectNext(true)}}else{if(p.innerWin&&p.innerWin.previousItem){p.innerWin.previousItem()}else{p.selectPrev(true)}}}else{if(p.pressingCount==3){p.pressingCount=0}}n.preventDefault()}else{r=false}if(f.isChrome){if(p._keyTimer){clearTimeout(p._keyTimer)}p._keyTimer=setTimeout(function(){p._keyTimer=undefined},500)}},textField_onKeyUp:function(k){var m=this;this.pressingCount=0},getInput:function(){return j(this.id+"_textField")},getSpinner:function(){return j(this.id+("_spinner"))},onItemClick:function(m){var p=this;var k=m.currentTarget;var n=k.getAttribute("value"),o=k.innerText;p.setValue(n,o);if(p.fireEvent("itemclick",this,n)!==false){this.collapse()}m.preventDefault()},loadData:function(n,k){var m=this;if(!k){k={}}else{if(k instanceof f.DataCollection){k=f.mix({},k.map)}}f.mix(k,m.params);Server.sendRequest(g.BackendMethod,k,function(p){var o=p.DataTable;m.clear();if(o){var x=o.Values;var s=x.length;var q=[];if(m.el.getAttribute("defaultblank")!="false"){q.push(["",""])}var t="true"==m.el.getAttribute("showvalue");for(var r=0;r<s;r++){var w=x[r][1],u=x[r][0];if(t){w=u+"-"+w}q.push([u,w])}m.data=q;m.lazyLoad=null;m.updateDropList();m.resumeList()}m.fireEvent("loaddata");m.setSelectedIndex(0);m.DataSource=o;if(n){n()}},null,null,"json")},clear:function(){var k=this;if(this.list){this.list.$el.html("")}this.el.length=this.data.length=0;this.el.options=[];this.suspendCheckValueChange++;k.originEL.value=k.value=k.lastValue=k.el.value=this.dom.textField.value="";k.suspendCheckValueChange--;this.suspendCheckSelectedIndexChange++;this.selectedIndex=this.el.selectedIndex=-1;k.suspendCheckSelectedIndexChange--},showBox:function(k,m){},reset:function(){},getText:function(){return this.dom.textField.value},getLabel:function(){return this.dom.textField.value},remove:function(k){if(k<0||k>=this.data.length){f.Console.error("can't remove the item that index="+k+"!");return}this.data.splice(k,1);if(this.selectedIndex>k){this.selectedIndex=this.el.selectedIndex=this.selectedIndex-1}this.updateDropList();this.resumeList()},add:function(k,n,m){if(f.isArray(k)){n=k[1]||n;k=k[0]}this.addBatch([k,n],m)},addBatch:function(k,m){m=m===undefined?this.data.length:m;this.data.splice(m,0,k);if(this.selectedIndex>m){this.selectedIndex=this.el.selectedIndex=this.selectedIndex+k.length}this.updateDropList();this.resumeList()},validate:f.fieldEditor.Text.prototype.validate,isValid:f.fieldEditor.Text.prototype.isValid,validateValue:f.fieldEditor.Text.prototype.validateValue,getErrors:f.fieldEditor.Text.prototype.getErrors,getValue:function(){var k=this,m=k.el;if(m){return m.value}return k.value},setValue:function(k,n,m){var o=this;if(k==o.value){return}if(!o.list){o.initList()}if(f.isArray(k)){n=k[1]||n;k=k[0]}k=String(k);if(o.el&&o.el.value!=k){this.suspendCheckValueChange++;o.el.value=k;n=n||o.findTextByValue(k);o.setText(n);if(o.originEL){o.originEL.value=o.el.value}this.suspendCheckValueChange--;if(!m){o.evalOnChange()}}o.value=k;o.checkValueChange()},onValueChange:function(n,m){var p=this;var o=this.findTextByValue(n);this.suspendCheckSelectedIndexChange++;var k=this.findIndexByValue(n);this.setSelectedIndex(k);if(!this.url){if(k==-1){v="";o=""}this.setText(o);this._selectUI()}p.suspendCheckSelectedIndexChange--},checkValueChange:function(k,n,p){if(!this.suspendCheckValueChange){var q=this,o=q.getValue(),m=q.lastValue;if(o!=m&&!q.isDestroyed){q.lastValue=o;q.fireEvent("change",q,o,m);q.onValueChange(o,m)}}},evalOnChange:function(k){k=k||this.el;var m=k.onchange;if(typeof m=="function"){setTimeout(function(){m.call(k)},1)}},setText:function(k){k=String(k);if(this.dom.textField&&this.dom.textField.value!=k){this.dom.textField.value=k}this.text=k},checkSelectedIndexChange:function(k){var n=this;if(!n.suspendCheckSelectedIndexChange){var m=n.getSelectedIndex();var o=n.lastSelectedIndex;if(m!=o&&!n.isDestroyed){n.lastSelectedIndex=m;n.fireEvent("selectedindexchange",n,m,o);n.onSelectedIndexChange(m,o)}}},onSelectedIndexChange:function(o,p){var n=this;this.setSelectedIndex(o);var k,m;if(o==-1||o>n.data.length){k="";m=""}else{k=n.findValueByIndex(o);m=n.findTextByIndex(o)}n.suspendCheckValueChange++;n.setValue(k);n.setText(m);n._selectUI();n.suspendCheckValueChange--},getSelectedIndex:function(){var k=this,m=k.inputEl;if(m){return m.selectedIndex}return k.selectedIndex},setSelectedIndex:function(m,k){var n=this;if(this.el&&this.el.selectedIndex!==m){this.suspendCheckSelectedIndexChange++;this.el.selectedIndex=m;n.suspendCheckSelectedIndexChange--}this.selectedIndex=m;this.checkSelectedIndexChange()},setSelectedIndexEx:function(k){var m=this;this.suspendCheckSelectedIndexChange++;this.el.selectedIndex=this.selectedIndex=k;m.suspendCheckSelectedIndexChange--},setValueEx:function(k,m){var n=this;this.suspendCheckValueChange++;n.originEL.value=n.el.value=n.value=k;n.text=n.dom.textField.value=m;n.contractWidth();n.suspendCheckValueChange--},setUrl:function(k){this.url=k;this.el.setAttribute("listurl",k)},checkDisabledChange:function(k){if(!this.suspendCheckDisabledChange){var m=this;var n=m.isDisabled();var o=m.lastDisabled;if(n!=o&&!m.isDestroyed){m.lastDisabled=n;m.fireEvent("disabledchange",m,n,o);m.onDisabledChange(n,o)}}},onDisabledChange:function(m,n){var k=this;this.suspendCheckDisabledChange++;this.setDisabled(m);k.suspendCheckDisabledChange--},setDisabled:function(k){var m=this;k=!!k;if(m.el&&m.el.disabled!=k){m.suspendCheckDisabledChange++;m.el.disabled=true;m.suspendCheckDisabledChange--}this.disabled=k;this[k?"disable":"enable"]();this.checkDisabledChange()},isDisabled:function(){var k=this,m=k.inputEl;if(m){return m.disabled}return k.disabled},disable:function(){console.log("combox disable");this.disabled=true;e.addClass(this.outerEl,this.disabledClass);this.dom.textField.tabIndex=-1},enable:function(){this.disabled=false;e.removeClass(this.outerEl,this.disabledClass);this.dom.textField.disabled=false;this.dom.textField.tabIndex=undefined},findTextByValue:function(k){k=String(k);var n=this.data;for(var m=0;m<n.length;m++){if(String(n[m][0])==k){return n[m][1]===undefined?k:n[m][1]}}return""},findValueByIndex:function(k){if(k>-1&&k<this.data.length){return this.data[k][0]}return""},findTextByIndex:function(k){if(k>-1&&k<this.data.length){return this.data[k][1]}return""},findIndexByValue:function(k){k=String(k);var n=this.data;for(var m=0;m<n.length;m++){if(String(n[m][0])==k){return m}}return -1},restrictHeight:function(){if(f.isIE6){if(this.list.el.offsetHeight>this.maxListHeight){this.list.el.style.height=this.maxListHeight}else{if(this.list.el.style.height!="auto"){this.list.el.style.height="auto"}}}},isExpanded:function(){return this.list&&this.list.isVisible()},selectByValue:function(m){if(!f.isEmpty(m,true)){var k=this.findIndexByValue(m);if(k!=-1){this.select(k);return true}}return false},select:function(k){this.setSelectedIndex(k,true)},_selectUI:function(k){k=k||this.selectedIndex;if(this.list&&!this.url){var m=this.list.$el.find("a").eq(k);if(m.length){m.addClass("selected").siblings().removeClass("selected");if(!this.list.hidden){}}m=null}},selectNext:function(k){var p=this;var n=p.data.length;var o=p.filteredData;var q=p.filteredData.length;if(n<1){return}if(k&&q<1){return}if(k&&q==1){p.select(o[0][2]);return}if(n==1){p.select(0);return}if(k){if(p.selectedIndex<o[0][2]||p.selectedIndex>=o[q-1][2]){p.select(o[0][2]);return}for(var m=0;m<q;m++){if(o[m][2]>p.selectedIndex){p.select(o[m][2]);return}}}if(p.selectedIndex<0||p.selectedIndex>=n-1){p.select(0);return}else{p.select(p.selectedIndex+1)}},selectPrev:function(k){var p=this;var n=p.data.length;var o=p.filteredData;var q=p.filteredData.length;if(n<1){return}if(k&&q<1){return}if(k&&q==1){p.select(o[0][2]);return}if(n==1){p.select(0);return}if(k){if(p.selectedIndex<=o[0][2]||p.selectedIndex>o[q-1][2]){p.select(o[q-1][2]);return}for(var m=q-1;m>=0;m--){if(o[m][2]<p.selectedIndex){p.select(o[m][2]);return}}}},filter:function(r){var p=this;var m=p.list.dom.listGroup.getElementsByTagName("a");p.filteredData=[];var k=m.length;r=String(r).toLowerCase().trim();for(var o=0;o<k;o++){var n=m[o];var q=p.data[o][1];if(typeof p.data[o][3]=="undefined"&&f.rootWin.getSpell){p.data[o][3]=f.rootWin.getSpell(p.data[o][1],true)+p.data[o][1].toLowerCase()}if(p.data[o][3].indexOf(r)>=0){n.style.display="";p.filteredData.push([p.data[o][0],p.data[o][1],o]);p.data[o][2]=undefined}else{n.style.display="none";p.data[o][2]=true}n=null}m=null},filterData:function(n,m){n=String(n).trim();var k=[];Array.each(m||this.data,function(o){if(String(o[1]).indexOf(n)>=0){k.push(o)}});return k},verifyInput:function(){var m=this;var k=m.dom.textField.value.trim();return m.filterData(k).length>0},clearFilter:function(){var m=me.list.dom.listGroup.getElementsByTagName("a");var k=m.length;for(var n=0;n<k;n++){m[n].style.display=""}},collapse:function(){var k=this;if(!this.list){this.initList()}if(!this.isExpanded()){return}this.list.hide();if(g.expanded==k){g.expanded=null}f.AllDocumentsEvent.un("mousedown.combox");if(f.rootWin!=window){f.rootWin.$(f.rootDoc).off("mousewheel.combox")}$document.off("mousewheel.combox");this.fireEvent("collapse",this)},collapseIf:function(k){var o=this;if(k.type=="unload"&&!f.restricted&&window.frameElement){if(window.frameElement.className=="combox-iframe"){return}}var n=k.target||k.srcElement;if(n){if(!f.isDocument(n)&&$&&$(n).closest(".z-combox").length){return}}var m;try{if(f.isDocument(n)){m=n.parentWindow.frameElement}else{m=n.ownerDocument.parentWindow.frameElement}if(m&&m.className=="combox-iframe"){return}}catch(p){}if(!o.isDestroyed&&!$.contains(o.outerEl,n)&&!$.contains(o.list.el,n)){o.collapse()}},expand:function(){var m=this;if(m.lazyLoad){m.loadData(function(){m.lazyLoad=null;m.expand()});return}if(!m.list){m.initList()}else{var o=m.listWidth||Math.max(m.dom.textField.offsetWidth,m.minListWidth);m.list.setSize(o)}if(m.isExpanded()||!m.hasFocus){return}m.list.show();if(g.expanded){g.expanded.collapse()}g.expanded=m;if(m.url&&(m.dom.iframe.src=="about:blank"||f.Url.relative2Absolute(m.url)!=m.dom.iframe._src)){var k=f.Url.relative2Absolute(m.url);m.dom.iframe._src=k;m.dom.iframe.src=k}else{if(isIE6&&m.list.el.clientHeight>300){m.list.el.children[0].style.height="280px"}}if(m._scrollSelector&&m.url&&m.dom.iframe.src!=="about:blank"){m.dom.iframe.contentWindow.$(m._scrollSelector).eq(0).scrollTop(m._scrollTop)}var n=f.Dom.computePositionEx(m.outerEl,this.list.el);e.setPosition(this.list.el,n);f.AllDocumentsEvent.on("mousedown.combox",function(p){m.collapseIf(p)});$window.on("unload",function(){if(f.AllDocumentsEvent){f.AllDocumentsEvent.un("mousedown.combox")}});if(f.rootWin!=window){f.rootWin.$(f.rootDoc).on("mousewheel.combox",function(p){m.collapseIf(p)})}$document.on("mousewheel.combox",function(p){m.collapseIf(p)});this.fireEvent("expand",this)},onTriggerMouseDown:function(k){if(this.disabled){return}if(this.isExpanded()){this.collapse()}else{this.onFocus({});this.expand();this.dom.textField.focus()}},onEscKey:function(k){this.collapse()},onTabKey:function(k){this.collapse()},onTextFieldMouseDown:function(k){if(this.disabled){return}if(!this.isExpanded()){this.onFocus({});this.expand()}},onFocus:function(){var k=this;if(this.focusClass){this.addClass(this.focusClass)}if(!this.hasFocus){this.hasFocus=true;k.value=k.el.value;this.fireEvent("focus",this)}},onBlur:function(){if(this.focusClass){this.removeClass(this.focusClass)}this.hasFocus=false;var k=this.getValue();if(String(k)!=String(this.lastValue)){this.fireEvent("change",this,k,this.lastValue)}this.fireEvent("inputblur",this)},contractWidth:function(){if(!this.autoWidth){return}var m=f.Dom.html2Node('<div style="position:absolute; visibility:hidden; font-size:12px;white-space:nowrap;">'+this.dom.textField.value+"</div>");this.outerEl.appendChild(m);var k=m.offsetWidth;this.setWidth(k+20);f.Dom.removeNode(m)},setWidth:function(k){this.width=k;if(this.el){k=k+"px";this.el.style.width=k;this.dom.textField.style.width=k}},setLinkAge:function(n,m){if(this.DataSource){if(this.selectedIndex<0){e.setValue(m,null)}else{var k=this.DataSource.Rows[this.selectedIndex-(this.data[0][1]===""?1:0)];if(k){e.setValue(m,k.get(n))}}}},getFocusEl:function(){return this.dom.textField},beforeDestroy:function(){var k=this;if(k.url){if(k.dom.iframe){k.dom.iframe.onready=null;k.dom.iframe.onload=null;f.rootWin.$(k.dom.iframe).off("load")}}k.dom.$textField.off();k.dom.$spinner.off();if(k.el.onchange){k.el.onchange=null}if(k.el.options){k.el.options.add=null;k.el.options=null}f.AllDocumentsEvent.un("mousedown.combox");if(f.rootWin!=window){f.rootWin.$(f.rootDoc).off("mousewheel.combox")}$document.off("mousewheel.combox");if(this.list){this.list.$el.off("click");if(k.list.dom.$filterInput){k.list.dom.$filterInput.off()}this.list.destroy();delete this.list}delete k.originEL}});var d="add,clear,disable,enable,getParam,setParam,loadData,filter,setValue,setValueEx,setSelectedIndex,setSelectedIndexEx,setLinkAge,verifyInput";d=d.split(",");for(i=0;i<d.length;i++){g[d[i]]=(function(k){return function(n){var m=f.toArray(arguments,1);var o=f.ComponentManager.getByDom(n,"Combox");if(o){return o[k].apply(o,m)}}})(d[i])}g.setReturn=function(o,m,r,k){var s=window.SelectorID;var p=f.rootWin;var q=window.ownerCombox;if(!q||q.ctype!="Combox"){return}var n=q.el.value;q.setValueEx(m,o);q._scrollSelector=""+(k||"body");q._scrollTop=r;if(n!=m){q.evalOnChange()}if(c){q.ownerDocument.parentWindow.focus()}q.collapse()};g.resume=function(k){};g.initCtrl=function(k){k=f.getDom(k);if(k!=f.getDom(k.id)){f.Console.error("页面中存在多个id为"+k.id+"的元素，导致zSelect控件不能正常初始化，请更正。");return}if(k.tagName=="INPUT"&&k.getAttribute("ztype")=="select"&&!k.z_Selector){g.resume(k)}};f.Page.onReady(function(){if(f.restricted||!window.frameElement){return}var k;try{ownercomboxid=window.frameElement.getAttribute("ownercomboxid")}catch(m){f.Console.error("没有权限：可能因为跨域，对话框不能与父窗口交互。")}if(!ownercomboxid){return}window.frameElement.onready(window)},4);f.fieldEditor=f.fieldEditor||{};f.fieldEditor.Combox=g;f.Combox=g;f.Selector=g;f.importCss("resources/combox.css")})();(function(){Zving.Switchable={};Zving.Switchable.tabs_onClick=function(b,d,c){var a=$(b);if(a.hasClass("current")){return false}a.$panelItems=a.$panelItems||$(c);a.$menuItems=a.$menuItems||$(d);for(i=0;i<a.$menuItems.length;i++){Node.removeClass(a.$menuItems[i],"current");a.$panelItems.eq(i).hide();if(a.$menuItems[i]==b){Node.addClass(a.$menuItems[i],"current");a.$panelItems.eq(i).show()}}a=b=null};Zving.Switchable.accordion_onClick=function(b,d,c){var a=$(b);if(a.hasClass("current")){return false}a.$panelItems=a.$panelItems||$(c);a.$menuItems=a.$menuItems||$(d);for(i=0;i<a.$menuItems.length;i++){Node.removeClass(a.$menuItems[i],"current");a.$panelItems.eq(i).hide();if(a.$menuItems[i]==b){Node.addClass(a.$menuItems[i],"current");a.$panelItems.eq(i).show()}}a=b=null}})();
/*! Suggest */
(function(){var k=window.Zving,d=k.Dom,p;var e="key",j="value",q="result",n="odd",c="even",f="z-suggest-key",b="z-suggest-result",m="z-suggest-closebtn",h="Zving.Suggest.callback";p=function(r){this.defaultConfig=this.defaultConfig||{dom:{},_dataCache:{},parentEl:k.rootDoc.body};if(!(this instanceof p)){return k.ComponentManager.getByDom(k.getDom(r),"Suggest")}this.constructor.superclass.constructor.apply(this,arguments)};p.layerTemplate='<div class="z-suggest-content">    {result}</div><div class="z-suggest-footer"><a class="z-suggest-close-btn">\xd7</a></div>';p.resultTemplate='<li><span class="z-suggest-key">?</span><span class="z-suggest-result">?</span></li>';k.Class.extend(p,k.UICompBase,{ctype:"Suggest",cls:"z-suggest-container",dataSource:null,delay:200,hidden:true,closeBtn:false,closeBtnText:k.Lang.get("Common.Close"),defaultSplitMin:40,callbackName:"callback",callbackFn:h,queryName:"q",query:"",resultFormat:"%result%",showResult:true,dataType:0,getDataByAJAX:true,charset:"utf-8",renderTpl:p.layerTemplate,resultTpl:p.resultTemplate,removeDomOnDestroy:true,initFromDom:function(r){r=k.getDom(r);if(!r){return}this.id=k.pageId+"-"+this.ctype+k.id(r);r._components=r._components||{};r._components[this.ctype]=this.id;var s={targetEl:r,textInput:r,dataSource:r.getAttribute("suggestsource")};return s},initComponent:function(){this.addEvents("beforeStart","itemSelect","beforeSubmit","beforeDataRequest","dataReturn","updateFooter","beforeShow");p.superclass.initComponent.apply(this);var r;var s=this.dataSource;if(typeof s=="string"){r=this.callbackFn;if(!this.getDataByAJAX){s+=(s.indexOf("?")===-1)?"?":"&";this.dataSource=s+this.callbackName+"="+(r)}if(this.dataType===2){this.dataType=0}if(r!=h){a(r)}}else{this.dataSource=s;this.dataType=2}this._initTextInput()},initRenderData:function(){this.renderData=this.renderData||{};return k.mixIf(this.renderData,{id:this.id,cls:this.cls})},afterRender:function(){var s=this.el,r;this.dom.content=s.firstChild;this.dom.footer=s.lastChild;this._initContainerEvent();this._initContainer();this.initEvent()},_initTextInput:function(){var r=this;this.dom.$input=$(this.textInput);this.dom.$input.attr("autocomplete","off");this.dom.$input.on("keydown",$.proxy(r.textInput_onKeyDown,r));this.dom.$input.on("keyup",$.proxy(r.textInput_onKeyUp,r));this.dom.$input.on("blur",$.proxy(r.textInput_onBlur,r))},textInput_onKeyDown:function(r){var u=this,s=u.textInput;var t=k.getEvent(r),w=t.keyCode;var x=false;u.pressingCount=0;if(w==35||w==36){if(!s.value){k.stopEvent(t);return}}if(w===27){u.hide();s.value=u.query}else{if(w>32&&w<41){if(!s.value){s.blur()}else{if(w===40||w===38){if(u.pressingCount++===0){if(u._isRunning){u.stop()}x=true;u._selectItem(w===40)}else{if(u.pressingCount==3){u.pressingCount=0}}k.preventEvent(t)}}}else{if(w===13){s.blur();if(x){if(s.value==u._getSelectedItemKey()){if(u.fireEvent("itemSelect")===false){return}}}u._submitForm()}else{if(!u._isRunning){u.start()}x=false}}}if(k.isChrome){if(u._keyTimer){clearTimeout(u._keyTimer)}u._keyTimer=setTimeout(function(){u._keyTimer=undefined},500)}},textInput_onKeyUp:function(r){this.pressingCount=0},textInput_onBlur:function(r){var s=this;s.stop();setTimeout(function(){if(!s._focusing){s.hide()}},0)},_initContainer:function(){$(this.el).css({position:"absolute",background:"none repeat scroll 0 0 white",border:"1px solid #999999","z-index":"990"})},_setContainerRegion:function(){var t=this,r=t.textInput,u=$(r).offsetEx(),s=t.el;k.Node.setPosition(s,{x:u.left,y:u.top+r.offsetHeight});$(s).width(t.containerWidth||r.offsetWidth-2)},_initContainerEvent:function(){var r=this;this.$el=$(r.el);this.dom.$content=$(r.dom.content);this.dom.$footer=$(r.dom.footer);this.$el.on("mousedown",$.proxy(r.container_onMouseDown,r));this.$el.on("mouseleave",$.proxy(r.container_onMouseLeave,r));this.dom.$content.on("mousemove",$.proxy(r.content_onMouseMove,r));this.dom.$content.on("mousedown",$.proxy(r.content_onMouseDown,r));this.dom.$content.on("mouseup",$.proxy(r.content_onMouseUp,r));this.dom.$footer.on("focusin",$.proxy(r.footer_onFocusIn,r));this.dom.$footer.on("focusout",$.proxy(r.footer_onFocusOut,r));this.dom.$footer.on("click",$.proxy(r.footer_onClick,r))},container_onMouseDown:function(r){var t=this;var s=k.getEvent(r);var u=s.target||s.srcElement;if(!/^(?:input|button|a)$/i.test(u.nodeName)){t.textInput.onbeforedeactivate=function(){t.textInput.ownerDocument.parentWindow.event.returnValue=false;t.textInput.onbeforedeactivate=null};k.preventEvent(s)}},content_onMouseMove:function(r){var u=this,t=u.dom.content;var s=k.getEvent(r);var w=s.target||s.srcElement;if(u._keyTimer){return}if(w.nodeName!=="LI"){w=$(w).parent("li")}if(w.ownerDocument==t.ownerDocument&&$.contains(t,w)){if(w!=u.selectedItem){u._removeSelectedItem();u._setSelectedItem(w)}}},content_onMouseDown:function(r){var t=this;var s=k.getEvent(r);var u=s.target||s.srcElement;if(u.nodeName!=="LI"){u=$(u).parent("li")}t.mouseDownItem=u},content_onMouseUp:function(r){var u=this,t=u.dom.content;var s=k.getEvent(r);var x=s.target||s.srcElement;if(s.which>1){return}if(x.nodeName!=="LI"){x=$(x).parent("li")}if(x!=u.mouseDownItem){return}if($.contains(t,x)){u._updateInputFromSelectItem(x);if(u.fireEvent("itemSelect")===false){return}try{input.blur()}catch(w){}u._submitForm()}},footer_onFocusIn:function(r){var s=this;s._focusing=true;s._removeSelectedItem();s.mouseLeaveFooter=false},footer_onFocusOut:function(r){var s=this;s._focusing=false;setTimeout(function(){if(s.mouseLeaveFooter){s.hide()}else{if(!s._focusing){s.textInput.focus()}}},0)},container_onMouseLeave:function(r){this.mouseLeaveFooter=true},footer_onClick:function(r){var t=this;var s=k.getEvent(r);var u=s.target||s.srcElement;if(/close/.test(u.className)){t.hide()}},_submitForm:function(){var t=this;if(this.submitOnSelect){var s=t.textInput.form;if(!s){return}if(this.fireEvent("beforeSubmit")===false){return}if(document.createEvent){var r=document.createEvent("MouseEvents");r.initEvent("submit",true,false);s.dispatchEvent(r)}else{if(document.createEventObject){s.fireEvent("onsubmit")}}s.submit()}},_initShim:function(){var r=this.ownerDocument.createElement("iframe");r.src="about:blank";r.className="z-shim";r.style.cssText="position:absolute;visibility:hidden;border:none";this.dom.shim=r;this.ownerDocument.body.appendChild(r)},_setShimRegion:function(){var t=this,s=t.el,r=s.style,u=t.dom.shim;if(u){k.Node.css(u,{left:parseInt(r.left,10)-2,top:r.top,width:parseInt(r.width,10)+2,height:s.offsetHeight-2})}},initEvent:function(){k.EventManager.onWindowResize(this.onWindowResize,this)},onWindowResize:function(){this._setContainerRegion()},start:function(){var r=this;if(this.fireEvent("beforeStart")===false){return}p.focusInstance=this;r._timer=r._timer||new k.Util.DelayedTask(function(){r._updateContent();r._timer.delay(r.delay)},r);r._timer.delay(r.delay);r._isRunning=true},stop:function(){var r=this;p.focusInstance=undefined;if(r._timer){r._timer.cancel()}r._isRunning=false},show:function(){var r=this,s=r.dom.shim;if(r.isVisible()){return}r._setContainerRegion();p.superclass.show.apply(this);if(s){r._setShimRegion();k.Node.show(s)}},hide:function(){var r=this,s=r.dom.shim;if(!r.isVisible()){return}if(s){k.Node.hide(s)}p.superclass.hide.apply(this)},_updateContent:function(){var s=this,r=s.textInput,t;if(!s.el){s.render()}if(r.value==s.query){return}t=s.query=r.value;if(!k.String.trim(t)){s._fillContainer();s.hide();return}switch(s.dataType){case 0:if(s._dataCache[t]!==undefined){s._fillContainer(s._dataCache[t]);s._displayContainer()}else{s._requestData()}break;case 1:s._requestData();break;case 2:s._handleResponse(s.dataSource[t]);break}},_requestData:function(){if(this.getDataByAJAX){this._requestDataByAJAX()}else{this._requestDataByScript()}},_requestDataByScript:function(){var u=this,r;if(!k.ie||k.ie9){u.dataScript=undefined}if(!u.dataScript){r=document.createElement("script");r.charset=u.charset;r.async=true;document.head.insertBefore(r,document.head.firstChild);u.dataScript=r;if(!k.ie||k.ie9){var s=+new Date();u._latestScriptTime=s;r.setAttribute("data-time",s);r.onload=function(){u._scriptDataIsOut=r.getAttribute("data-time")!=u._latestScriptTime}}}u.queryParams=u.queryName+"="+encodeURIComponent(u.query);if(u.fireEvent("beforeDataRequest")===false){return}u.dataScript.src=u.dataSource+"&"+u.queryParams},_requestDataByAJAX:function(){var s=this,r=new DataCollection();r.add(s.callbackName,s.callbackFn);r.add(s.queryName,s.query);if(s.fireEvent("beforeDataRequest")===false){return}Server.sendRequest(s.dataSource,r,function(t){r=null},s.id)},_handleResponse:function(s){var z=this,u,y="",t,w,x,B,A,r;if(z._scriptDataIsOut){return}z.returnedData=s;if(z.fireEvent("dataReturn")===false){return}if(!z.contentRenderer){y=z._renderContent(s)}else{y=z.contentRenderer(s)}z._fillContainer(y);if(z.fireEvent("beforeShow")===false){return}if(!z.dataType){z._dataCache[z.query]=z.dom.content.innerHTML}z._displayContainer()},_renderContent:function(s){var z=this,u,y="",t,w,x,B,A,r;u=z._formatData(z.returnedData);if((w=u.length)>0){x=document.createElement("ol");x.style.padding="0";x.style.margin="0";for(t=0;t<w;++t){r=u[t];B=z._formatItem((A=r[e]),z.showResult&&r[q]);B.setAttribute(e,A);B.className=t%2?c:n;x.appendChild(B)}y=x}return y},_formatData:function(x){var s=[],r,w,u,t=0;if(!x){return s}if(k.isArray(x[q])){x=x[q]}if(!(r=x.length)){return s}for(u=0;u<r;++u){w=x[u];if(k.isString(w)){s[t++]={key:w}}else{if(k.isArray(w)&&w.length>1){s[t++]={key:w[0],result:w[1]}}}}return s},_formatItem:function(u,s){var r=document.createElement("li"),w,t;t='<span class="'+f+'">'+u+"</span>";if(s){w=this.resultFormat.replace("%result%",s);if(k.String.trim(w)){t+='<span class="'+b+'">'+w+"</span>"}}r.innerHTML=t;return r},_fillContainer:function(s,t){var r=this;r._fillContent(s||"");r._fillFooter(t||"")},_fillContent:function(r){g(this.dom.content,r);this.selectedItem=undefined},_fillFooter:function(s){var t=this,w=t.dom.footer,u;g(w,s);if(t.closeBtn){var r=t.ownerDocument.createElement("a");r.href="javascript: void(0)";r.className=m;r.innerHTML=t.closeBtnText;w.appendChild(r)}t.fireEvent("updateFooter");$(w).css("display",w.innerText.trim()===""?"none":"")},_displayContainer:function(){var r=this;if(k.String.trim(r.dom.content.innerText)){r.show()}else{r.hide()}},_selectItem:function(u){var t=this,s=t.dom.content.getElementsByTagName("LI"),r;s=k.toArray(s);if(s.length<1){return}if(!t.isVisible()){t.show();return}if(!t.selectedItem){r=s[u?0:s.length-1]}else{r=s[k.Array.indexOf(s,t.selectedItem)+(u?1:-1)];if(!r){t.textInput.value=t.query}}t._removeSelectedItem();if(r){t._setSelectedItem(r);t._updateInputFromSelectItem()}},_removeSelectedItem:function(){if(this.selectedItem){k.Node.removeClass(this.selectedItem,"z-selected");this.selectedItem.style.backgroundColor="#ffffff"}this.selectedItem=undefined},_setSelectedItem:function(r){k.Node.addClass(r,"z-selected");r.style.backgroundColor="#3399FF";this.selectedItem=r;this.textInput.focus()},_getSelectedItemKey:function(){var r=this;if(!r.selectedItem){return""}return r.selectedItem.getAttribute(e)},_updateInputFromSelectItem:function(){var r=this;r.textInput.value=r._getSelectedItemKey(r.selectedItem)||r.query},beforeDestroy:function(){if(this.$el){this.$el.off("mousedown");this.$el.off("mouseleave")}this.dom.$input&&this.dom.$input.off();this.dom.$content&&this.dom.$content.off();this.dom.$footer&&this.dom.$footer.off();this.dom.content&&jQuery.cleanData(this.dom.content.getElementsByTagName("*"));delete this.targetEl;delete this.textInput}});function g(s,r){if(r.nodeType==1){s.innerHTML="";if(k.isIE&&s.ownerDocument!=r.ownerDocument){s.innerHTML=r.outerHTML}else{s.appendChild(r)}}else{s.innerHTML=r}}function a(s){var t=s.split("."),r=t.length,u;if(r>1){s=s.replace(/^(.*)\..+$/,"$1");u=k.namespace(s,true);u[t[r-1]]=o}else{window[s]=o}}function o(r){if(!p.focusInstance){return}setTimeout(function(){p.focusInstance._handleResponse(r)},0)}p.callback=o;k.Suggest=p})();(function(){var f=window.Zving,d=f.getDom,c,a,b,e;c=function(g,h){var j=this;j.owner=g;f.mix(j,h)};f.mix(c.prototype,{ctype:"form.Basic",getFields:function(){var g=this._fields;if(!g){g=this._fields=[];this.owner.items.each(function(h){if(h.isFormField){console.log("fields.add",h.id,h);g.push(h)}})}return g},loadRecord:function(g){this._record=g;return this.setValues(g)},setValues:function(g){var k=this,h,j,o,n;function m(p,r){var q=k.findField(p);if(q){q.setValue(r);if(k.trackResetOnLoad){q.resetOriginalValue()}}}if(f.isArray(g)){j=g.length;for(h=0;h<j;h++){o=g[h];m(o.id,o.value)}}else{g.each(function(q,p){m(p,q)})}return this},getValues:function(o,p,s){var r={},m=this.getFields(),n,t=m.length,k=f.isArray,q,j,h,g;for(n=0;n<t;n++){q=m[n];if(!p||q.isDirty()){j=q.getValue();if(s&&j===""){j=q.emptyText||""}r[q.fieldName]=j}}if(o){r=f.JSON.toQuery(r)}return r},findField:function(j){var g=this.getFields();for(var h=0;h<g.length;h++){if(g[h].id==j||g[h].fieldName==j){return g[h]}}},isValid:function(){var j=this,k=0;var g=this.getFields();for(var h=0;h<g.length;h++){if(!g[h].validate()){k++}}return k<1},getFieldValues:function(g){return this.getValues(false,g,false,true)},updateRecord:function(g){g=g||this._record;var h=this.getFieldValues();g.each(function(k,j){g.set(j,h[j])});return this}});a=function(g){this.outerElAttrs={tag:"label",cls:"Field",ztype:"Field"};a.superclass.constructor.call(this,g)};f.Class.extend(a,f.UICompBase,{ctype:"Field",checked:null,name:false,value:undefined,disabledClass:"z-label-disabled",afterRender:function(g){this.fieldEl=this.el.getElementsByTagName("input")[0];if(this.checkable||this.checked||this.type=="checkbox"){this.setChecked(this.checked)}if(this.disabled){this.disable(true)}},setValue:function(g){this.fieldEl.value=v;this.value=v;return this},getValue:function(){return this.fieldEl.value},setText:function(h){var g=this.el.getElementsByTagName("LABLE")[0];g.innerHTML=h;return this},getChecked:function(){if(this.fieldEl.checked===true){this.checked=true;return true}else{this.checked=false;return false}},setChecked:function(k){var h=this,j=h.fieldEl,g=h.labelEl;if(k){h.checked=true;j.checked=true}else{h.checked=false;j.checked=false}this.fireEvent("checkchange",this)},_sync:function(g){this._syncChecked(null,g);this._syncDisabled()},_syncChecked:function(h,m){var j=this,g=j.labelEl,k=j.fieldEl.checked;if(h!==undefined&&h!==null){k=h}if(k){j.checked=true;$(g).addClass("z-label-checked")}else{j.checked=false;$(g).removeClass("z-label-checked")}},_syncDisabled:function(h){var j=this,g=j.labelEl,k=j.fieldEl.disabled;if(h!==undefined&&h!==null){k=h}if(k){j.disabled=true;$(g).addClass("z-label-disabled")}else{j.disabled=false;$(g).removeClass("z-label-disabled")}},disable:function(g){var h=this.labelEl,j=this.fieldEl;if(this.rendered){$(h).addClass(this.disabledClass);j.disabled=true}this.disabled=true;if(g!==true){this.fireEvent("disable",this)}return this},enable:function(g){var h=this.labelEl,j=this.fieldEl;if(this.rendered){$(h).removeClass(this.disabledClass);j.disabled=false}this.disabled=false;if(g!==true){this.fireEvent("enable",this)}return this},beforeDestroy:function(){delete this.labelEl;delete this.fieldEl}});b=function(g){this.outerElAttrs={tag:"sapn",cls:"z-checkbox",ztype:"Checkbox"};if(!(this instanceof b)){return f.ComponentManager.getByDom(f.getDom(g),"Checkbox")}b.superclass.constructor.call(this,g)};f.Class.extend(b,a,{ctype:"Checkbox",initFromDom:function(g){g=d(g);if(!g){return}this.el=g;this.initDom();return{el:g}},initDom:function(){var j=this,k,h;if(j.el.type=="checkbox"||j.el.type=="radio"){k=j.fieldEl=j.el}else{k=j.fieldEl=j.el.getElementsByTagName("INPUT")[0]}var g=$(k).next();if(g[0]&&g[0].nodeName=="LABEL"&&(g.attr("for")==j.fieldEl.id||!g.attr("for"))){h=j.labelEl=g[0]}j.value=k.value;if(k||!k._syncChecked){if(k.watch){k.watch("checked",function(m,n,o){j._syncChecked(o);return o});k.watch("disabled",function(m,n,o){j._syncDisabled(o);return o})}if(k.onpropertychange!==undefined){$(k).on("propertychange",function(m){j._sync()})}else{$(k).on("change",function(m){j._syncChecked()})}k._sync=function(){j._sync()};k._sync()}},beforeDestroy:function(){delete this.labelEl;delete this.fieldEl}});e=function(g){this.outerElAttrs={tag:"sapn",cls:"z-radio",ztype:"Radio"};if(!(this instanceof e)){return f.ComponentManager.getByDom(f.getDom(g),"Radio")}e.superclass.constructor.call(this,g)};f.Class.extend(e,a,{ctype:"Radio",initFromDom:function(g){g=d(g);if(!g){return}this.el=g;this.initDom();return{el:g}},initDom:function(){var j=this,k,h;if(j.el.type=="checkbox"||j.el.type=="radio"){k=j.fieldEl=j.el}else{k=j.fieldEl=j.el.getElementsByTagName("INPUT")[0]}var g=$(k).next();if(g[0]&&g[0].nodeName=="LABEL"&&(g.attr("for")==j.fieldEl.id||!g.attr("for"))){h=j.labelEl=g[0]}j.value=k.value;if(k||!k._syncChecked){if(k.watch){k.watch("checked",function(m,n,o){j._syncChecked(o);return o});k.watch("disabled",function(m,n,o){j._syncDisabled(o);return o})}if(k.onpropertychange!==undefined){$(k).on("propertychange",function(m){j._sync()})}else{$(k).on("change",function(m){j._syncChecked()})}k._sync=function(){j._sync()};k._sync()}},_syncChecked:function(j,g){var k=this,h=k.labelEl,m=k.fieldEl.checked;if(j!==undefined&&j!==null){m=j}if(m){k.checked=true;$(h).addClass("z-label-checked");if(!g){k._syncRadioGroup()}}else{k.checked=false;$(h).removeClass("z-label-checked")}},_syncRadioGroup:function(){var k=this,h=k.labelEl,m=k.fieldEl,g=m.name;var j=$(m).parent("form")[0];if(!j){j=h.ownerDocument.body}var n=$(j).find("input[name="+g+"]").not(m);n.each(function(){if(this._sync){this._sync(null,true)}else{$(this).next().removeClass("z-label-checked")}})},beforeDestroy:function(){delete this.labelEl;delete this.fieldEl}});f.form=f.form||{};f.form.Basic=c;f.form.Checkbox=b;f.form.Radio=e})();
/*! Button */
(function(){var c=window.Zving,a,b;a=function(d){this.defaultConfig={items:[]};if(!(this instanceof a)){return c.ComponentManager.getByDom(c.getDom(d),"Button")}this.outerElAttrs={tag:"a",cls:"z-btn",priv:d.priv||"",ztype:"button",onselectstart:"return false"};a.superclass.constructor.call(this,d);if(this.icon&&(!this.iconCls||!/icon/.test(this.iconCls))){if(/.*\.(gif|png|jpg)$/i.test(this.icon)){this.iconHtml=c.String.format('<img class="z-btn-icon" src="?" width="18" height="18" />',this.icon)}else{if(/-?\d+ -?\d+/i.test(this.icon)){var f=this.icon.match(/\d+/g)[0];var e=this.icon.match(/\d+/g)[1];this.iconHtml=c.String.format('<img class="z-btn-icon" src="?images/blank.gif" width="18" height="18" style="background-position:-?px -?px;" />',c.JSLIBPATH,f,e)}}}else{if(this.iconCls){this.iconHtml=c.String.format('<img class="z-btn-icon ?" src="?images/blank.gif" width="18" height="18"/>',this.iconCls,c.JSLIBPATH)}else{this.iconHtml=""}}if(this.href&&!/^(#|javascript:void)/.test(this.href)){this.type="link";this.outerElAttrs.href=this.href;this.outerElAttrs.onclick="{onclickAttributeValue};";if(this.target){this.outerElAttrs.target=this.target}}else{this.outerElAttrs.href="javascript:void(0)";this.outerElAttrs.onclick="{onclickAttributeValue};return false;"}if(this.menu){if(c.isPlainObject(this.menu)){this.menu=new c.DropMenu(this.menu)}this.outerElAttrs.menu=this.menu.getId();if(this.type=="push"){this.type="menu"}}switch(this.type){case"menu":this.outerElAttrs.cls+=" z-btn-menu";break;case"split":case"select":this.outerElAttrs.cls+=" z-btn-split";break;case"checkbox":this.outerElAttrs.cls+=" z-btn-checkable";break;default:}if(this.initFromExistEl){this.afterRender()}this.addEvents("click","checkchange","menushow","menuhide","menuitemclick","arrowclick","change");if(this.changeHandler){this.on("change",this.changeHandler,this.scope||this);delete this.changeHandler}if(this.type=="split"||this.type=="select"){this.on("menuitemclick",function(h,g){this.setActiveItem(g)})}if(this.initFromExistEl){this.attachMethod2Dom()}};a.htmlTemplate="{iconHtml}<b>{text}<i></i></b>";c.Class.extend(a,c.UICompBase,{ctype:"Button",type:"push",text:"按钮",onclickAttributeValue:"",handler:null,changeHandler:null,checkHandler:null,menu:null,renderTpl:a.htmlTemplate,hidden:false,checkable:false,checked:null,disabledClass:"z-btn-disabled",initFromDom:function(g){g=c.getDom(g);if(!g){return}var n={el:g,type:g.getAttribute("buttontype"),text:g.innerText,cls:g.className};var k=g.getAttributeNode("onclick");if(k&&k.value){n.onclickAttributeValue=k.value;n.handler=function(){g.fireEvent("onclick")}}var f=g.href;var o=g.getAttributeNode("href");var d=g.getAttribute("target");if(f&&o){n.href=f;if(!/^(#|javascript:)/.test(o.value)){if(d){n.target=d}n.type="link"}}var h=g.getAttribute("checked");var j=g.getAttribute("onchecked");if(h||j){n.onchecked=j;this.checkable=true;if(h===true||h==="true"){n.checked=true;n.cls+=" z-btn-checked";this.checked=true}else{n.checked=false;this.checked=false}n.type="checkbox"}var e=g.getAttribute("menu");if(e){n.menu=c.ComponentManager.get(e,"Menu");n.cls+=" z-btn-menu";n.type="menu";if(g.getAttribute("buttontype")=="split"){n.type="split"}if(g.getAttribute("buttontype")=="select"){n.type="select";if(g.getAttribute("prependText")){n.prependText=g.getAttribute("prependText")}else{}}this.destroyMenu=false}if(g._disabled===true||g.disabled==="true"){n.disabled=true;n.cls+=" z-btn-disabled"}var m=g.getElementsByTagName("IMG");if(m.length){if(!/icon000.png|blank.png/.test(m[0].src)){n.icon=m[0].src}if(m[0].className){n.iconCls=m[0].className}}this.initFromExistEl=true;this.ownerDocument=g.ownerDocument;this.ownerWindow=g.ownerDocument.parentWindow;return n},beforerender:function(){if(typeof this.onclick=="string"){this.onclickAttributeValue=this.onclick;this.onclick=null}},initRenderData:function(){return c.mixIf(this.renderData,{id:this.id,cls:this.cls,text:this.text,onclickAttributeValue:this.onclickAttributeValue,iconHtml:this.iconHtml})},setText:function(f){var d=this.el.getElementsByTagName("B")[0];var e=d.innerText.trim();d.innerHTML=d.innerHTML.replace(e,f);return this},setIcon:function(d){if(/.*\.(gif|png|jpg)$/i.test(d)){var e=this.el.getElementsByTagName("IMG");if(e.length){e[0].className="icon000";e[0].src=d}else{this.iconHtml=c.String.format('<img class="z-btn-icon" src="{0}" width="18" height="18" />',d);this.el.insertAdjacentHTML("afterbegin",this.iconHtml)}}return this},getChecked:function(){if(this.$el.attr("checked")==="checked"||this.checked===true){this.checked=true;this.$el.attr("checked","checked");return true}else{this.checked=false;this.$el.removeAttr("checked");return false}},setChecked:function(d){if(this.type=="checkbox"||this.type=="radio"){if(d){this.addClass("z-btn-checked");this.checked=true;this.$el.attr("checked","checked")}else{this.removeClass("z-btn-checked");this.checked=false;this.$el.removeAttr("checked")}this.fireEvent("checkchange",this)}},afterRender:function(d){var e=this;if(this.type!="link"){this.$el.on("click.button",function(f){e.onClick(f)})}if(this.menu){this.setMenu(this.menu)}if(this.checkable||this.checked||this.type=="checkbox"){this.setChecked(this.checked)}if(this.disabled){this.disable(true)}this.attachMethod2Dom()},setMenu:function(d){this.menu=d;this.$el.hover($.proxy(this.onMouseEnter,this),$.proxy(this.onMouseLeave,this));this.menu.on("show",this.onMenuShow,this);this.menu.on("hide",this.onMenuHide,this);this.menu.on("itemclick",this.onMenuItemClick,this)},attachMethod2Dom:function(){},showMenu:function(){if(this.rendered&&this.menu){if(this.menu.isVisible()){this.menu.hide()}this.menu.ownerCt=this;this.menu.show(this.el)}return this},hideMenu:function(){if(this.hasVisibleMenu()){this.menu.hide()}return this},hasVisibleMenu:function(){return this.menu&&this.menu.ownerCt==this&&this.menu.isVisible()},onMouseEnter:function(d){if(!this.disabled){var e=this;if(e.autoHideMenuTimer){clearTimeout(e.autoHideMenuTimer)}e.autoHideMenuTimer=setTimeout(function(){e.showMenu()},this.type!=="select"?200:500);e.menu.autoHideTimer=e.autoHideMenuTimer}},onMouseLeave:function(d){if(!this.disabled){var e=this;clearTimeout(e.autoHideMenuTimer);e.autoHideMenuTimer=setTimeout(function(){e.hideMenu()},100);e.menu.autoHideTimer=e.autoHideMenuTimer}},onClick:function(e){if(e){e.preventDefault()}if(e&&e.which>1){return}var d=false;if(e&&e.srcElement&&e.srcElement.tagName=="I"){d=true}if(!this.disabled){if(this.menu&&!this.ignoreNextClick){if(this.type=="menu"||d){this.showMenu()}else{if(d||this.type=="select"){clearTimeout(this.autoHideMenuTimer);var f=this.getActiveItem();if(f&&f.handler){f.handler()}}}}if(d){this.fireEvent("arrowclick",this,e)}if(this.type=="checkbox"){this.setChecked(!this.checked)}if(this.handler&&!this.onclickAttributeValue){if(this.fireEvent("click",this,e)!==false){if(this.parentMenu&&this.parentMenu.fireEvent("itemclick",this,e)===false){return}this.handler.call(this.scope||this,this,e)}}}else{e.stopPropagation()}},onMenuShow:function(d){if(this.menu.ownerCt==this){this.menu.ownerCt=this;this.ignoreNextClick=0;this.fireEvent("menushow",this,this.menu)}},onMenuItemClick:function(d){this.fireEvent("menuitemclick",this,d)},onMenuHide:function(f){if(this.menu.ownerCt==this){var d=this;this.fireEvent("menuhide",this,this.menu);delete this.menu.ownerCt}},restoreClick:function(){this.ignoreNextClick=0},disable:function(d){var e=this.el;if(this.rendered){c.Node.addClass(e,this.disabledClass);if(e.onclick&&!e._onclick_bak){e._onclick_bak=e.onclick}e.onclick=function(f){return false};e.disabled=true}this.disabled=true;if(d!==true){this.fireEvent("disable",this)}return this},enable:function(d){var e=this.el;if(this.rendered){c.Node.removeClass(e,this.disabledClass);if(e._onclick_bak){e.onclick=e._onclick_bak}e.disabled=null}this.disabled=false;if(d!==true){this.fireEvent("enable",this)}return this},setActiveItemById:function(e,d){return this.setActiveItem(e,d)},setActiveItem:function(f,h,e){if(!this.menu.rendered){this.showMenu();this.hideMenu()}if(!c.isObject(f)){f="proxy"+this.menu.timeStamp+"_"+f.replace(/^proxy\d+_/,"");f=this.menu.getItemComponent(f)}if(!f){return Console.error("按钮("+this.id+")的子项"+f+"不存在")}var g=this.prependText||"";g+=f.text;if(this.type=="select"){if(!this.rendered){this.text=f.text;this.iconCls=f.iconCls}else{this.setText(g);var d=f.icon;if(d){this.setIcon(d)}}}this.activeItem=f;if(!f.checked){f.setChecked(true,e)}if(h&&this.type=="select"){this.getActiveItem().handler()}if(!e){this.fireEvent("change",this,f)}},getActiveItem:function(){if(this.activeItem){return this.activeItem}if(this.menu.items.length>0){return this.menu.items[0]}if(this.menu.itemsConfig.length>0){return this.menu.itemsConfig[0]}},getActiveItemId:function(){return this.getActiveItem().id.split(/roxy\d+_/)[1]},beforeDestroy:function(){var d=this;if(d.menu&&d.destroyMenu){console.log("destroyMenu",d.menu);d.menu.destroy()}d.el.onclick=null;d.outerEl.onclick=d.outerEl.onselectstart=null;d.handler=null}});b=function(){var d={};return{add:function(e){d[e.id]=e},get:function(e){return d[e]},remove:function(e){if(e){d[buttonId].destroy()}delete d[buttonId]},removeAll:function(e){c.iterate(d,function(f){this.remove(f.remove(e))})}}};c.Button=a;c.ButtonGroup=b})();
/*! Menu */
(function(){var c=window.Zving,a,b;a=function(d){this.defaultConfig={itemsConfig:[],items:[],parentEl:c.rootDoc.body};d=d||{};if(c.isArray(d.items)){d.itemsConfig=d.items;delete d.items}a.superclass.constructor.call(this,d)};c.Class.extend(a,c.UICompBase,{ctype:"Menu",minWidth:120,shadow:"sides",defaultAlign:"lb",reAlign:"hr",defaultOffsets:[0,0],hidden:true,floating:true,zIndex:10200,hideParent:false,showOnRootWindow:true,removeDomOnDestroy:true,defaultItemType:"Button",defaultItemConfig:{cmpCls:"z-btn-inmenu"},initComponent:function(){if(this.targetEl){this.targetEl._components=this.targetEl._components||{};this.targetEl._components[this.ctype]=this.id}this.addEvents("itemclick");b.register(this);if(this.floating){c.EventManager.onWindowResize(this.hide,this)}a.superclass.initComponent.call(this)},initFromDom:function(m){if(!m){return}m=c.getDom(m);var f=[],k=m.children,j,g,e;this.timeStamp=+new Date();for(var h=0,d=k.length;h<d;h++){j=k[h];if(!j.id){j.id=c.id(j)}g={text:j.innerText,cls:j.className,id:"proxy"+this.timeStamp+"_"+j.id,handler:(function(n){return function(){if(c.isIE){n.click()}else{n.fireEvent("onclick")}}})(j)};if(j._disabled===true||j.disabled==="true"){g.disabled=true;g.cls+=" z-btn-disabled"}e=j.getElementsByTagName("IMG");if(e.length){if(!/icon000.png|blank.png/.test(e[0].src)){g.icon=e[0].src}if(e[0].className){g.iconCls=e[0].className}}f.push(g)}this.targetEl=m;return{id:this.ctype+"_"+c.id(m),itemsConfig:f}},initItems:function(){if(!this.items){this.items=[]}},addComponentsFromArray:function(e){var g;this.items=[];for(var f=0,d=e.length;f<d;f++){g=e[f];if(typeof g=="string"){g={text:g}}if(c.isPlainObject(g)){c.mixIf(g,this.defaultItemConfig);g=new this.ownerWindow.Zving[g.ctype||this.defaultItemConfig.ctype||this.defaultItemType](g)}this.add(g)}},add:function(d){d.ownerCt=this;d.parentMenu=this;if(d.menu){d.menu.parentMenu=this}d.render(this.getContentEl());this.items.push(d);return d},addItem:function(g,f,e){var d={text:g};if(f){if(typeof f=="string"){d.onclick=f+";return false;"}else{d.handler=f}}if(e){d.icon=e}d.cls="z-btn-inmenu";this.add(new c.Button(d))},onRender:function(f,d){if(!f){f=this.parentEl||document.body}this.ownerDocument=f.ownerDocument;this.ownerWindow=f.ownerDocument.parentWindow;if(this.ownerWindow==c.rootWin){this.showOnRootWindow=true}else{this.showOnRootWindow=false}var e=new c.Layer({cls:"z-menu",shadow:this.shadow,parentEl:f,zIndex:this.zIndex});this.outerEl=this.el=e.el;this.$el=this.ownerWindow.$(this.el);this.$el.on("click.menu",$.proxy(this.onClick,this));this.$el.hover($.proxy(this.onMouseEnter,this),$.proxy(this.onMouseLeave,this));if(c.isArray(this.itemsConfig)&&this.itemsConfig.length>0){this.addComponentsFromArray(this.itemsConfig)}else{this.add(new c.UICompBase({html:'<div class="z-menu-no-items"></div>'}))}},afterRender:function(){},onMouseEnter:function(d){if(this.parentMenu){this.parentMenu.onMouseEnter()}if(this.autoHideTimer){clearTimeout(this.autoHideTimer)}},onMouseLeave:function(d){var e=this;if(this.parentMenu){this.parentMenu.onMouseLeave()}this.autoHideTimer=setTimeout(function(){e.hide()},100)},onClick:function(d){d=this.ownerWindow.Zving.getEvent(d);var e=d.target||d.srcElement;e=c.Node.getParent(e,"A");if(e){if(c.Node.hasClass(e,"z-btn")){if(c.Node.hasClass(e,"z-btn-haschildmenu")&&this.ignoreParentClicks){e.expandMenu();d.preventDefault()}else{if(c.Node.hasClass(e,"z-btn-inmenu")){this.hide()}}}}},show:function(d,m){var h;if(!this.el){this.render();this.doLayout(false,true)}this.$el.show();var j=this.parentMenu?"tr":this.defaultAlign;var e=this.parentMenu?null:this.reAlign;var k=this.parentMenu?false:true;var o=c.Node.anchorPos(this.el,d,m||j,e,this.defaultOffsets,k);if(this.showOnRootWindow&&!this.parentMenu){var n=c.Dom.getFrameOffset();o.x+=n.left;o.y+=n.top}var f=this.ownerWindow.$(this.ownerWindow).width();var g=this.ownerWindow.$(this.ownerWindow).height();if(this.parentMenu){if(o.x+this.el.clientWidth>f){o.x=parseInt(this.parentMenu.el.left)-this.el.clientWidth}if(o.y+this.el.clientHeight>g){o.y=g-this.el.clientHeight-2}else{o.y-=25}}this.showAt(o)},showAt:function(d){if(this.fireEvent("beforeshow",this)!==false){if(!this.el){this.render()}c.Node.setPosition(this.el,d);this.$el.show();this.hidden=false;this.fireEvent("show",this)}},doLayout:function(e,d){if(this.rendered){this.onLayout(e,d)}this.hasLayout=true},onLayout:function(d,e){this.doAutoSize()},doAutoSize:function(){},hide:function(d){if(!this.isDestroyed){this.deepHide=d;if(this.fireEvent("beforehide",this)!==false){this.doHide();this.fireEvent("hide",this)}delete this.deepHide}},doHide:function(){this.hidden=true;if(this.rendered){this.onHide()}},onHide:function(){if(this.el&&this.floating){this.$el.hide()}var d=this.parentMenu;if(this.deepHide===true&&d){if(d.floating){d.hide(true)}}},getVisibilityEl:function(){return this.hideParent?this.container:this.el},isVisible:function(){return this.rendered&&c.Node.isVisible(this.getVisibilityEl())},remove:function(d,e){this.initItems();var f=this.getItemComponent(d);if(f){this.doRemove(f,e)}return f},onRemove:function(d){},doRemove:function(e,d){this.items.remove(e);if(e.onRemoved){e.onRemoved()}this.onRemove(e);if(d===true||(d!==false&&this.autoDestroy)){e.destroy(true)}},removeAll:function(f){console.log("menu removeAll");this.initItems();var h,j=[],e=[];this.items.each(function(k){j.push(k)});for(var g=0,d=j.length;g<d;++g){h=j[g];this.remove(h,f);if(h.ownerCt!==this){e.push(h)}}return e},getItemComponent:function(e){if(typeof e=="string"){for(var f=0,d=this.items.length,g;f<d;f++){g=this.items[f];if(g.id==e||g.id=="proxy"+this.timeStamp+"_"+e){return g}}}if(c.isObject(e)){return e}},getItemComponentByIndex:function(d){return this.items[d]},beforeDestroy:function(){},onDestroy:function(){EventManager.removeResizeListener(this.hide,this);b.unregister(this);if(this.rendered){this.$el.remove()}},destroy:function(){if(!this.isDestroyed){this.destroying=true;this.beforeDestroy();this.onDestroy();this.fireEvent("destroy",this);this.purgeListeners();if(this.deleteMembers){this.deleteMembers("parentEl","container","autoRender","defaultConfig","dom","el","$el","outerEl","$outerEl","targetEl","events","initialConfig","ownerDocument","ownerWindow","_parent")}this.destroying=false;this.isDestroyed=true}}});b=function(){var j,g,f={},d=false,o=new Date();function q(){j=b.menus={};g=b.active=[]}function m(){if(g&&g.length>0){g.each(function(r){r.hide()});return true}return false}function h(r){var s=this;g.remove(r);if(g.length<1){if(this.showOnRootWindow){c.AllDocumentsEvent.un("mousedown",p,s)}else{$document.off("mousedown.menu")}d=false}}function n(r){var s=this;var t=g[g.length-1];o=new Date();g.push(r);if(!d){if(this.showOnRootWindow){c.AllDocumentsEvent.on("mousedown",p,s);$window.on("unload",function(){if(c.AllDocumentsEvent){c.AllDocumentsEvent.un("mousedown",p,s)}})}else{$document.on("mousedown.menu",$.proxy(p,s))}d=true}if(r.parentMenu){r.el.style.zIndex=parseInt(r.parentMenu.el.style.zIndex,10)+3;r.parentMenu.activeChild=r}else{if(t&&!t.isDestroyed&&t.isVisible()){r.el.style.zIndex=parseInt(t.el.style.zIndex,10)+3}}}function e(r){if(r.activeChild){r.activeChild.hide()}if(r.autoHideTimer){clearTimeout(r.autoHideTimer);delete r.autoHideTimer}}function k(r){var s=r.parentMenu;if(!s&&!r.allowOtherMenus){m()}else{if(s&&s.activeChild){s.activeChild.hide();if(r.autoHideTimer){clearTimeout(r.autoHideTimer);delete r.autoHideTimer}}}}function p(r){if(new Date().getTime()-o.getTime()>50&&g.length>0){r=c.getEvent(r);var s=r.target||r.srcElement;if(s.ownerDocument!=this.ownerDocument&&s.ownerDocument!=c.rootDoc){return m()}while(s){if(c.Node.hasClass(s,"z-menu")){return}s=s.parentNode}m()}}return{hideAll:function(){return m()},destroyAll:function(){c.iterate(j,function(s,r){r.destroy()})},register:function(r){if(!j){q()}j[r.id]=r;r.on({beforehide:e,hide:h,beforeshow:k,show:n})},get:function(r){return j[r]},unregister:function(r){delete j[r.id];r.un("beforehide",e);r.un("hide",h);r.un("beforeshow",k);r.un("show",n)}}}();$window.on("unload",b.destroyAll);c.DropMenu=a;c.DropMenuManager=b})();
/*! Toolbar */
(function(){var c=window.Zving,a=c.Node,b;b=function(d){if(!(this instanceof b)){return c.ComponentManager.getByDom(c.getDom(d),"Toolbar")}b.superclass.constructor.apply(this,arguments);c.Page.onLayout(this.fitToSize,this);c.EventManager.onWindowResize(this.fitToSize,this)};c.Class.extend(b,c.UICompBase,{ctype:"Toolbar",contentElClass:"z-toolbar-nowrap",buttonSelector:"a.z-btn",enableOverflow:true,triggerWidth:22,initComponent:function(){var d=this;this.hiddenItems=[];this.addEvents("overflowchange");this.dom.frameBody=c.getDom(this.el.id+"_body");if(!this.dom.frameBody){c.Console.error("toolbar.js - 初始化错误，找不到参数对应的页面元素")}this.dom.frame=this.dom.frameBody.parentNode;this.dom.$frameBody=$(this.dom.frameBody);this.$buttons=this.dom.$frameBody.find(d.buttonSelector).not(".z-toolbar-more");this.getItems();if(d.fixed){c.Page.onLoad(function(){d.setFixed(d.fixed)})}},setFixed:function(g){var f=this;if(g!==undefined){f.fixed=g}if(f.fixed){f.el.style.position="static";f.dom.frame.style.width="auto";f.el.style.width="auto";var d=a.getParentByClass(f.el,"ui-page");if(d&&d.clientWidth<f.dom.frame.clientWidth){this.dom.frame.style.width=d.clientWidth-12+"px";f.el.style.width=d.clientWidth+"px"}else{if(c.isIE){f.el.style.width=f.el.parentNode.clientWidth-6+"px"}else{var e=c.Node.getCurrentStyle(f.el,"width");f.el.style.width=e}}var h=$(f.el).offset();if(h.top<0){return}if(isIE6){f.el.style.position="absolute";f.el.style.zIndex=1111;f.el.style.left=h.left+"px";$window.off("scroll."+f.id).on("scroll."+f.id,function(j){f.el.style.top=$window.scrollTop()+"px"})}else{f.el.style.position="fixed";f.el.style.zIndex=1111;f.el.style.top=h.top+"px";f.el.style.left=h.left+"px"}}},getItems:function(e){var d=this;this.items=[];if(e){this.$buttons=this.dom.$frameBody.find(d.buttonSelector).not(".z-toolbar-more")}this.$buttons.each(function(){var f;if(this._components&&this._components.Button){f=c.Button(this)}else{f=new c.Button(this)}f.ownerCt=d;f.parentToolbar=d;d.items.push(f)})},hideItem:function(d){this.hiddenItems.push(d);d.xtbHidden=true;d.xtbWidth=d.el.offsetWidth;a.addClass(d.el,"z-hidden")},unhideItem:function(d){a.removeClass(d.el,"z-hidden");d.xtbHidden=false;this.hiddenItems.remove(d)},getItemWidth:function(d){return d.xtbHidden?(d.xtbWidth||0):d.el.offsetWidth},fitToSize:function(e){var q=this;if(!q.outerEl||!q.outerEl.parentNode||!q.outerEl.offsetParent&&!q.outerEl.parentNode.offsetParent){return}if(this.enableOverflow===false){return}q.setFixed();var f=this.dom.frameBody.offsetWidth,r=f-this.triggerWidth,d=this.lastWidth||0,o=0,g=this.hiddenItems,k=g.length!==0,s=f>d;this.lastWidth=f;var j=this.dom.$frameBody.find(q.buttonSelector).not(".z-toolbar-more");if(!e&&f==d&&j.length==this.items.length){return}if(j.length!=this.items.length){this.$buttons=j;this.getItems()}j=null;var p=this.items,n=p.length,h=0,t;for(var m=0;m<n;m++){t=p[m];if(!t.isFill){h+=this.getItemWidth(t);if(h>r){if(!(t.hidden||t.xtbHidden)){this.hideItem(t)}}else{if(t.xtbHidden){this.unhideItem(t)}if(a.isVisible(t.el)){o+=this.getItemWidth(t);if(c.isIE6){o++}}}}}k=g.length!==0;if(k){this.initMore();this.more.el.style.marginLeft=r-o+"px";if(!this.lastOverflow){this.fireEvent("overflowchange",this.el,true);this.lastOverflow=true}}else{if(this.more){this.clearMenu();this.more.destroy(true);delete this.more;if(this.lastOverflow){this.fireEvent("overflowchange",this.el,false);this.lastOverflow=false}}}this.dom.frame.style.width="auto"},initMore:function(){if(!this.more){this.moreMenu=new c.DropMenu({ownerCt:this,listeners:{beforeshow:this.beforeMoreShow,scope:this}});this.more=new c.Button({text:"&nbsp;",type:"menu",cls:"z-toolbar-more",menu:this.moreMenu,ownerCt:this});this.more.render(this.dom.frameBody)}},beforeMoreShow:function(h){var e=this.items,d=e.length,g;this.clearMenu();h.removeAll(true);for(var f=0;f<d;f++){g=e[f];if(g.xtbHidden){this.addComponentToMenu(h,g)}}if(h.items.length<1){h.add(new c.UICompBase({html:'<div class="z-menu-no-items">(None)</div>'}))}},addComponentToMenu:function(f,d){if(d.ctype=="Button"){var e={el:null,cls:"z-btn-inmenu",onclick:""};if(d.el&&(d.el.disabled===true||d.el.disabled==="true")){e.cls+=" z-btn-disabled";e.handler=function(){if(d.el.disabled!==true&&d.el.disabled!=="true"){d.handler.apply(this,arguments)}}}c.mixIf(e,d.initialConfig);e.id=null;f.add(new c.Button(e))}},clearMenu:function(){},beforeDestroy:function(){if(this.more){this.more.destroy();delete this.moreMenu;delete this.more}jQuery.cleanData(this.dom.$frameBody);jQuery.cleanData(this.$buttons);this.items.length=0;this.items=this.$buttons=null}});c.Toolbar=b})();(function(){if(!(Zving.isIE6||Zving.isIE7)){return}else{return}var L=window.Zving,t=L.isIE,W=L.isIE6;if(location.toString().indexOf("file:///")===0){return}if(document.compatMode!="CSS1Compat"){return}var n=document;var B=n.documentElement;var Y=w();var A;var X=[];var D=0;var d=true;var N="z";var b=/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)\s*/g;var r=/@import\s*(?:(?:(?:url\(\s*(['"]?)(.*)\1)\s*\))|(?:(['"])(.*)\3))[^;]*;/g;var F=/\burl\(\s*(["']?)(?!data:)([^"')]+)\1\s*\)/g;var G=/^:(empty|(first|last|only|nth(-last)?)-(child|of-type))$/;var U=/:(:first-(?:line|letter))/g;var H=/(^|\})\s*([^\{]*?[\[:][^{]+)/g;var E=/([ +~>])|(:[a-z\-]+(?:\(.*?\)+)?)|(\[.*?\])/g;var M=/(:not\()?:(hover|enabled|disabled|focus|checked|target|active|visited|first-line|first-letter)\)?/g;var aa=/[^\w\-]/g;var s=/^(INPUT|SELECT|TEXTAREA|BUTTON)$/;var q=/^(checkbox|radio)$/;var y=L.ieVersion>6?/[\$\^*]=(['"])\1/:null;var f=/([(\[+~])\s+/g;var O=/\s+([)\]+~])/g;var u=/\s+/g;var c=/^\s*((?:[\S\s]*\S)?)\s*$/;var x="";var p=" ";var Z="$1";function V(z){return z.replace(U,Z).replace(H,function(ac,ah,ag){var ad=ag.split(",");for(var ai=0,af=ad.length;ai<af;ai++){var ab=h(ad[ai])+p;var ae=[];ad[ai]=ab.replace(E,function(ak,am,an,al,aj){if(am){if(ae.length>0){R(ab.substring(0,aj),ae);ae=[]}return am}else{var ao=(an)?C(an):T(al);if(ao){ae.push(ao);return"."+ao.className}return ak}})}return ah+ad.join(",")})}function T(z){return(!y||y.test(z))?{className:I(z),applyClass:true}:null}function C(af){var ae=true;var ad=I(af.slice(1));var ac=af.substring(0,5)==":not(";var ab;var ag;if(ac){af=af.slice(5,-1)}var z=af.indexOf("(");if(z>-1){af=af.substring(0,z)}if(af.charAt(0)==":"){switch(af.slice(1)){case"root":ae=function(ah){return ac?ah!=document.documentElement:ah==document.documentElement};break;case"checked":ae=function(ah){if(q.test(ah.type)){o(ah,"propertychange",function(){if(event.propertyName=="checked"){J(ah,ad,ah.checked!==ac)}})}return ah.checked!==ac};break;case"disabled":ac=!ac;case"enabled":ae=function(ah){if(s.test(ah.tagName)){o(ah,"propertychange",function(){if(event.propertyName=="$disabled"){J(ah,ad,ah.$disabled===ac)}});X.push(ah);ah.$disabled=ah.disabled;return ah.disabled===ac}return af==":enabled"?ac:!ac};break;case"focus":ab="focus";ag="blur";case"hover":if(!ab){ab="mouseenter";ag="mouseleave"}ae=function(ah){o(ah,ac?ag:ab,function(){J(ah,ad,true)});o(ah,ac?ab:ag,function(){J(ah,ad,false)});return ac};break;default:if(!G.test(af)){return false}break}}return{className:ad,applyClass:ae}}function R(z,ab){var ad;var ai=z.replace(M,x);if(ai==x||ai.charAt(ai.length-1)==p){ai+="*"}try{ad=A(ai)}catch(ak){Console.error("Selector '"+z+"' threw exception '"+ak+"'")}if(ad){for(var aj=0,ae=ad.length;aj<ae;aj++){var ah=ad[aj];var ag=ah.className;for(var af=0,al=ab.length;af<al;af++){var ac=ab[af];if(!P(ah,ac)){if(ac.applyClass&&(ac.applyClass===true||ac.applyClass(ah)===true)){ag=g(ag,ac.className,true)}}}ah.className=ag}}}function P(ab,z){return new RegExp("(^|\\s)"+z.className+"(\\s|$)").test(ab.className)}function I(z){return N+"-"+((W&&d)?D++:z.replace(aa,function(ab){return ab.charCodeAt(0)}))}function a(z){return z.replace(c,Z)}function m(z){return a(z).replace(u,p)}function h(z){return m(z.replace(f,Z).replace(O,Z))}function J(ae,ad,z){var ac=ae.className;var ab=g(ac,ad,z);if(ab!=ac){ae.className=ab;ae.parentNode.className+=x}}function g(ad,ac,z){var ab=RegExp("(^|\\s)"+ac+"(\\s|$)");var ae=ab.test(ad);if(z){return ae?ad:ad+p+ac}else{return ae?a(ad.replace(ab,Z)):ad}}function o(ac,z,ab){ac.attachEvent("on"+z,ab)}function w(){if(window.XMLHttpRequest){return new XMLHttpRequest()}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(z){return null}}function k(z){Y.open("GET",z,false);Y.send();return(Y.status==200)?Y.responseText:x}function K(ac,ab){function ad(ae){return ae.substring(0,ae.indexOf("/",8))}if(/^https?:\/\//i.test(ac)){return ad(ab)==ad(ac)?ac:null}if(ac.charAt(0)=="/"){return ad(ab)+ac}var z=ab.split(/[?#]/)[0];if(ac.charAt(0)!="?"&&z.charAt(z.length-1)!="/"){z=z.substring(0,z.lastIndexOf("/")+1)}return z+ac}function Q(z){if(z){return k(z).replace(b,x).replace(r,function(ae,af,ab,ad,ac){return Q(K(ab||ac,z))}).replace(F,function(ac,ad,ab){ad=ad||x;return" url("+ad+K(ab,z)+ad+") "})}return x}var e;function j(z){if(!e){e=document.createElement("style");e.type="text/css";document.getElementsByTagName("head")[0].appendChild(e)}if(e.styleSheet){e.styleSheet.cssText+=z}else{z=document.createTextNode(z);e.appendChild(z)}return e}function S(){var z,ab;var ac=document.getElementsByTagName("BASE");var ad=(ac.length>0)?ac[0].href:document.location.href;for(var af=0;af<document.styleSheets.length;af++){ab=document.styleSheets[af];if(ab.href&&ab.href!=x){z=K(ab.href,ad);var ae;if(z){ae=V(Q(z));if(t){ab.cssText=ae}else{j("\n/* "+z+" */\n"+ae)}}}}if(X.length>0){setInterval(function(){for(var ai=0,ag=X.length;ai<ag;ai++){var ah=X[ai];if(ah.disabled!==ah.$disabled){if(ah.disabled){ah.disabled=false;ah.$disabled=true;ah.disabled=true}else{ah.$disabled=ah.disabled}}}},250)}}A=jQuery;L.Page.onReady(function(){S()})})();(function(){var d=window.Zving;if(!d.isIE||d.isIE11){return}d.Misc.inputFocus=function(){if(!d.isIE){return}if(document.getElementsByTagName("input").length+document.getElementsByTagName("textarea").length===0){return}var k,f,m,h;var g=document.links;if(g.length){for(k=0,f=g.length;k<f;k++){if(g[k].tabIndex>-1&&g[k].onfocus===null&&g[k].offsetWidth>0&&g[k].offsetHeight>0){try{g[k].focus()}catch(j){}m=g[k];break}}}if(m){document.documentElement.scrollTop=0;document.body.scrollTop=0}else{h=document.createElement("A");h.href="#";if(document.body.firstChild){document.body.insertBefore(h,document.body.firstChild)}else{document.body.insertAdjacentElement("afterBegin",h)}try{h.focus()}catch(n){}m=h}g=h=m=null};if(d.restricted){return}if(window.frameElement&&d.isIE6&&!d.isQuirks){var c=document.getElementsByTagName("HTML")[0];if(c.style.overflow===""){if(c.style.overflow===""){c.style.overflow="auto"}if(c.style.overflowY===""){c.style.overflowY="auto"}if(c.style.overflowX===""){c.style.overflowX="hidden"}}else{window._noScrollFix=true}c=null}d.Misc.scrollFixOnresize=false;d.Misc.ie6ScrollFix=function(){if(d.isIE6&&!d.isQuirks){if(window._noScrollFix){return}var g=document.getElementsByTagName("HTML")[0];var e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);if((window.frameElement&&e<window.frameElement.offsetWidth+30)||(!window.frameElement&&e<document.documentElement.clientWidth+30)){g.style.overflowX="hidden";if(!d.Misc.scrollFixOnresize){if(window.frameElement){d.EventManager.onWindowResize(d.Misc.runIe6ScrollFix)}d.Misc.scrollFixOnresize=true}}else{g.style.overflowX="auto"}var f=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);if((window.frameElement&&f>window.frameElement.offsetHeight)||(!window.frameElement&&f>document.documentElement.clientHeight)){if(g.style.overflow!=="hidden"&&g.style.overflowY!=="hidden"){g.style.overflowY="scroll";g.style.overflowX="hidden"}}else{g.style.overflowY="auto"}g=null}};var b=null;var a=0;d.Misc.runIe6ScrollFix=function(){if(d.isIE6){if(a>9){clearTimeout(b)}else{b=setTimeout(d.Misc.ie6ScrollFix,100);a++}}};if(d.isIE6){d.Page.onLoad(function(){d.Misc.ie6ScrollFix();d.Misc.runIe6ScrollFix()},1)}})();(function(){var e=window.Zving,d=e.getDom,a=e.Node,b=e.Lang,c;c=function(f){if(!(this instanceof c)){return e.ComponentManager.getByDom(e.getDom(f),"PageBar")}c.superclass.constructor.apply(this,arguments)};e.Class.extend(c,e.UICompBase,{ctype:"PageBar",cls:"z-pagebar",outerElAttrs:"div",renderTpl:'<div onclick="{onclick}" id="{id}-body" class="{cls}">{items}</div>',itemTpl:'<a class="{cls}" page="{page}" target="_self" href="{href}">{label}</a>',hrefTpl:"#{page}",labelTpl:"[{page}]",currentLabelTpl:"{page}",specialLabelMap:{first:"首页",last:"尾页",previous:"上一页",next:"下一页"},pageSize:undefined,beginPage:1,endPage:100,currentPage:undefined,rowHeight:23,itemCount:10,leftItemCount:4,initComponent:function(){this.addEvents("beforeupdate","update","ongotopage");c.superclass.initComponent.apply(this)},initFromDom:function(g){var f=d(g);return{el:f}},update:function(f){var g=this;f=f||{};if(g.checkOptions(f)){if(f.hasOwnProperty("currentPage")&&f.currentPage!=g.currentPage){if(!g._notifyGotoPage(f.currentPage,false)){delete f.currentPage}}g._updateNoCheck(f);return true}return false},_updateNoCheck:function(f){var g=this;e.mix(g,f);if(g.getBodyEl()){g._refresh()}},checkOptions:function(g){var j=this;var h=g.beginPage||j.beginPage;var f=g.endPage||j.endPage;if(f<=h){return false}if(g.hasOwnProperty("beginPage")&&j.currentPage<h){j.currentPage=h}if(g.hasOwnProperty("endPage")&&j.currentPage>=f){j.currentPage=f-1}var k=g.currentPage||j.currentPage;if(k<h||k>=f){return false}return true},_genItem:function(h,f){var g=this;return e.String.tmpl(g.itemTpl,{cls:f?f:"",page:h,href:e.String.tmpl(g.hrefTpl,{page:h}),label:function(){return(f?(f=="current"?e.String.tmpl(g.currentLabelTpl,{page:h}):g.specialLabelMap[f]):e.String.tmpl(g.labelTpl,{page:h}))}})},_genBody:function(){var f=this,g=f.initRenderData();return e.String.tmpl(f.renderTpl,f.renderData)},initRenderData:function(){var o=this,f=o.beginPage,h=o.endPage,m=o.currentPage,q=Math.min(Math.max(h-f+1,1),o.itemCount),p=Math.min(m-f,o.leftItemCount);p=Math.max(q-(h+1-m),p);var k=m-p,g={first:f,last:h,previous:m-1,next:m+1},r={};o.renderData=o.renderData||{};e.iterate(g,function(t,u){r[t]=o._genItem(u,t);console.log(u,t,r[t])});r.previous=g.previous<f?"":r.previous;r.next=g.next>h?"":r.next;r.first=k==f?"":r.first;r.last=k+q>h?"":r.last;var s=[];for(var j=0;j<q;j++){var n=k+j;s[j]=o._genItem(n,n==m?"current":null)}o.renderData={id:o.getId(),cls:o.cls,items:r.first+r.previous+s.join("")+r.next+r.last,onclick:"$(this).parents('.z-pagebar').getComponent('PageBar')._handleOnClick(event, this);"};return o.renderData},_refresh:function(){var f=this;f.el.innerHTML=f.getString()},_handleOnClick:function(f){f=e.getEvent(f);var h=this,g=f.target,j=Number(g.getAttribute("page"));if(j&&h._notifyGotoPage(j,true)){h._updateNoCheck({currentPage:j})}else{f.preventDefault()}},_notifyGotoPage:function(f,g){return this.fireEvent("ongotopage",{page:f,fromClick:g})},ongotopage:function(f){f.returnValue=false},getString:function(){var f=this;if(f.currentPage===undefined){f.currentPage=f.beginPage}return f._genBody()}});e.PageBar=c})();(function(){var g=window.Zving,o=g.getDom,f=g.Node,e=g.Server,b=g.Constant,d=g.Lang,k=g.CONTEXTPATH,c=g.Misc,j;var n="dg-row-selected";var m="dg-row";var h="hover";b.SortString="_ZVING_SORTSTRING";b.PageIndex="_ZVING_PAGEINDEX";b.PageTotal="_ZVING_PAGETOTAL";b.TagBody="_ZVING_TAGBODY";b.TemplateTR="_ZVING_TEMPLATE_TR";b.ID="_ZVING_ID";b.Method="_ZVING_METHOD";b.Page="_ZVING_PAGE";b.Size="_ZVING_SIZE";b.Null="_ZVING_NULL";b.InsertRow="_ZVING_INSERTROW";b.DataTable="_ZVING_DATATABLE";b.AutoFill="_ZVING_AUTOFILL";b.Multiselect="_ZVING_MULTISELECT";b.Scroll="_ZVING_SCROLL";b.Lazy="_ZVING_LAZY";j=function(p){this.defaultConfig={_rows:[],plugins:[]};if(!(this instanceof j)){return g.ComponentManager.getByDom(g.getDom(p),"DataGrid")}g.DataGSetter(this,"params","param");this.setParam(b.PageIndex,0);this.setParam(b.PageTotal,0);j.superclass.constructor.apply(this,arguments)};j.BackendMethod="com.zving.framework.ui.control.DataGridUI.doWork";j.ToExcelAction=k+"com.zving.framework.ui.control.DataGridUI.toExcel.zaction";j.headTpl='<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" bordercolor="#dddddd" class="dataList"><thead><tr ztype="head">    <td><span style="float: left;">        <input type="checkbox" value="99666" name="dg1_RowCheck"/>    全选</span><span style="float: right;">排序字段: <em>创建时间降序</em></span></td></tr></thead></table>';j.bodyTpl='<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" bordercolor="#dddddd" class="dataList" id="{id}"><tbody>    <tr>        <td>        </td>    </tr></tbody></table>';j.footTpl="<tfoot>  <tr>      <td>      </td>  </tr></tfoot>";g.Class.extend(j,g.UICompBase,{ctype:"DataGrid",cls:"z-datagrid",outerElAttrs:"div",outerElIdPostfix:"_outer",renderTpl:'{head}<div><table id="{id}" class="{cls}" cellpadding="0" cellspacing="0" border="0" {stateHandler}><tbody>{rows}</tbody></table></div>',titleTpl:'<div><table id="{id}_head" class="{cls}" cellspacing="0" cellpadding="0" border="0"><thead><tr class="{cls}-tr">{titleCol}</tr></thead></table></div>',rowHeight:25,headerRowsLength:1,disabledResize:false,initComponent:function(){var p=this;g.Statable(this);this.addEvents("beforeupdate","update","insertRow","removerow","rowclick","rowselect","rowunselect");j.superclass.initComponent.apply(this);if(this.el){this.initDom()}},initFromDom:function(w){var u=this,t=o(w);u._rows=[];u._columns=[];for(var s=0,q=t.rows.length;s<q;s++){var x=t.rows[s];if(f.hasClass(x,"dg-headTr")){for(var r=0,p=x.cells.length;r<p;r++){u._columns.push({})}}else{if(f.hasClass(x,m)){u._rows.push(new j.Row({el:x,_parent:u}))}}}this.setParemFormEl(t);return{el:t}},getTableEl:function(){return this.el},restoreRows:function(){var t=this;var q=t.getTableEl();for(var s=0,r=0,p=q.rows.length;s<p;s++){if(f.hasClass(q.rows[s],m)){if(t._rows[r]&&t._rows[r].ctype=="DataGrid.Row"){t._rows[r].el=q.rows[s];q.rows[s]._components=q.rows[s]._components||{};q.rows[s]._components[t._rows[r].ctype]=t._rows[r].id;t._rows[r].restore()}else{t._rows[r]=new j.Row({el:q.rows[s],_parent:t})}r++}}while(t._rows.length>p){t._rows.pop()}return t._rows},activateChildNodes:function(y,q){var x=this;q=q||x.appendNodesData;if(!q){console.error("activateChildNodes()没有要新增行对应的数据");return}var s=x.getTableEl();var p,w;for(var u=0,t=0,r=s.rows.length;u<r;u++){if(f.hasClass(s.rows[u],m)){t++;if(s.rows[u].getAttribute("treenodeid")==y){p=s.rows[u];break}}}if(parseInt(s.rows[u+1].getAttribute("level"),10)==parseInt(p.getAttribute("level"),10)+1){x._insertData(t,q.Values)}for(u++;u<r;u++,t++){w=s.rows[u];if(!w.getAttribute("level")||w.getAttribute("level")-p.getAttribute("level")!=1){break}x._rows.splice(t,0,new j.Row({el:w,_parent:x}))}x.resetRowEx();x.appendNodesData=null},setParemFormEl:function(s){if(s.getAttribute("method")){this.setParam(b.Method,s.getAttribute("method"))}if(s.getAttribute("sortend")){this.sortable=true}if(s.getAttribute("autopagesize")=="true"){this.autoPageSize=true}if(s.getAttribute("autofill")=="true"){this.setParam(b.AutoFill,"true");this.autoFill=true}if(s.getAttribute("page")=="true"){this.setParam(b.Page,"true")}if(s.getAttribute("size")){this.setParam(b.Size,Number(s.getAttribute("size")))}if(s.getAttribute("multiSelect")=="true"){this.setParam(b.Multiselect,"true");this.multiSelect=true}else{if(s.getAttribute("multiSelect")=="false"){this.setParam(b.Multiselect,"false");this.multiSelect=false}}if(s.getAttribute("scroll")=="true"){this.setParam(b.Scroll,"true")}if(s.getAttribute("editinrow")=="true"){this.editInRow=true}this.uniqueField="id";var q=s.rows[0].cells;for(var r=0,p=q.length;r<p;r++){if(q[r].getAttribute("ztype")=="selector"&&q[r].getAttribute("field")){this.hasSelector=true;this.uniqueField=q[r].getAttribute("field")}}if(!this.disabledResize){this.resizerPlugin=new g.DataGrid.plugin.HeaderResizer();this.plugins.push(this.resizerPlugin)}var t;if(s.getAttribute("editable")=="true"||s.getAttribute("editable")=="cell"){this.selModel={selType:"CellModel"};t=this.getSelectionModel();t.grid=this;this.editor=new g.DataGrid.plugin.CellEditing();this.plugins.push(this.editor)}else{if(s.getAttribute("editable")=="row"){this.selModel={selType:"RowModel"};t=this.getSelectionModel();t.grid=this;this.editor=new g.DataGrid.plugin.RowEditing();this.plugins.push(this.editor)}}if(s.getAttribute("treelazy")=="true"){this.treeLazy=true}},initDom:function(){var q=this;var p=this.el;var r=p.id;q.dom={};q.dom.wrapper=o(r+"_outer");q.dom.head=o(r+"_outer_head");q.dom.headTable=o(r+"_head");q.dom.$headTable=$(q.dom.headTable);q.dom.headTr=o(r+"_head").rows[0];q.dom.body=o(r+"_outer_body");q.dom.$body=$(q.dom.body);q.dom.dock=o(r+"_dock");if(q.dom.dock){q.dom.$dock=$(q.dom.dock);q.dom.$dock_trigger=q.dom.$dock.find(".dock-trigger");q.dom.$dock_station=q.dom.$dock.find(".dock-station")}q.initEvents();q.initPagebar();if(q.autoFill){g.Page.onLayout(function(s){if(!q.el||!q.el.parentNode||!q.el.parentNode.offsetParent&&!q.dom.wrapper.offsetParent){return}if(!s||s&&s.contains&&s.contains(q.el)){q.layout(s);q.computePageSize();q.initScroll();q.resumePagebar()}})}else{q.resumePagebar()}q.sortableInit();this.getSelectionModel().bindComponent(this);q.fireEvent("afterRender")},initEvents:function(){var p=this;p.dom.$body.on("keydown",function(q){p.processUIEvent(q)});p.dom.$body.on("mousedown click dblclick","tr."+m,function(r){var q=f.getParent(r.target,"TD");var s=q.cellIndex;var t=r.currentTarget;var u=t.rowIndex;if(r&&r.which==1&&r.type=="click"){p.onRowClick(r)}p.fireEvent("row"+r.type,p,p.getStore().getDataRow(u-1),t,u,r)});p.dom.$body.on("mousedown click dblclick","td.dg-cell",function(r){var q=r.currentTarget;var s=q.cellIndex;var t=q.parentNode;var u=t.rowIndex;p.fireEvent("cell"+r.type,p,q,q.cellIndex,p.getStore().getDataRow(u-1),t,u,r)});if(p.multiSelect){p.dom.$body.on("mousedown","td.dg-cell-selector",function(r){console.log("mousedown.dg-cell-selector",r.which,r.button);if(r&&r.which==1){var q=r.currentTarget;var s=q.cellIndex;var t=q.parentNode;var u=t.rowIndex;console.log(t,u);p.fireEvent("checkermousedown",p,p.getStore().getDataRow(u-1),t,u,r);r.stopPropagation()}})}p.dom.$body.on("contextmenu","tr."+m,function(q){p.onRowContextMenu(q)});if(p.editInRow){console.log("me.editInRow==true")}if(p.dom.dock){p.dom.$dock.hoverIntent(function(){if(p.selModel.selectedDataCollection.size()===0){return}p.dom.$dock_trigger.hide();p.dom.$dock_station.show("slide",{direction:"right"})},function(){if(p.selModel.selectedDataCollection.size()===0){return}p.dom.$dock_station.hide("slide",{direction:"right"},function(){p.dom.$dock_trigger.show("fade")})});p.highlight_dock=new g.Util.DelayedTask(function(){var q=p.selModel.selectedDataCollection.size();p.dom.$dock_trigger.html(p.selModel.selectedDataCollection.size()).effect("highlight");p.dom.$dock_station.html("已选中 "+q+" 条记录。<a onclick=\"DataGrid.clearAllSelected('"+p.el.id+"');\">取消选中</a>")})}},selectedRowToExcel:function(r){var s=this;r=o(r);var t=s.getSelectedRows();var p=[];var q;for(q=0;q<t.length;q++){p.push(t[q].rowIndex)}j.toExcel(r,s.getParam(b.Page)=="true",p)},_changeSelectByValues:function(u,q){if(!u){return}if(!g.isArray(u)){u=[u]}var t=this;var r=t.getTableEl();var p=g.getByName(r.id+"_RowCheck");if(!p){return}var s=[];u.each(function(w){for(var x=0;x<p.length;x++){if(p[x].value==w){s.push(t.getStore().getDataRow(f.getParent(p[x],"tr").rowIndex-t.headerRowsLength));break}}});if(s.length){if(q){t.selModel.doSelect(s)}else{t.selModel.doDeselect(s)}}},selectByValues:function(p){return this._changeSelectByValues(p,true)},unselectByValues:function(p){return this._changeSelectByValues(p,false)},onSelectorClick:function(p,q){},onRowDblClick:function(p){var q=p.currentTarget;if(!q.ondblclick){this.editRow(q)}},selectPrevRow:function(){var q=this;var r=q.getSelectedRows();var p=1;if(r&&r.length){p=Math.max(1,r[0].rowIndex-1)}q.selectRow(p,true)},selectNextRow:function(){var q=this;var r=q.getSelectedRows();var p=q.el.rows[q.el.rows.length-1].rowIndex;if(r&&r.length){p=Math.min(p,r[r.length-1].rowIndex+1)}q.selectRow(p,true)},selectRow:function(q){var p=this;p.selModel.doSelect(q)},onRowClick:function(p){},onRowSelected:function(p,r,q){},getString:function(){var p=this,q=p.initRenderData();return g.String.tmpl(this.renderTpl,q)},_getHeadString:function(){var q=this,p=[];g.each(q.title,function(r){p.push("<td>",r===undefined?"":r,"</td>")});return g.String.tmpl(q.titleTpl,{id:q.getId(),cls:q.cls,titleCol:p.join("")})},getHeadTable:function(){if(!this.dom.headTable){this.dom.headTable=o(this.el.id+"_head")}return this.dom.headTable},initRenderData:function(){var p=this;p.renderData=p.renderData||{};g.mixIf(p.renderData,{id:p.getId(),cls:p.cls,rows:p._getRowsString()});if(p.title){g.mixIf(p.renderData,{head:p._getHeadString()});p.on("afterrender",function(){p.getTableEl().style.tableLayout="fixed";p.getHeadTable().style.width=p.getTableEl().offsetWidth+"px";p.getHeadTable().style.tableLayout="fixed"})}return p.renderData},_getRowsString:function(){var t=this,r=0,q=t.getStore(),p=q.getRowCount(),s=[],u;for(;r<p;r++){u=t.getRow(r);if(!u){u=t._rows[r]=t._createRow(q.getDataRow(r))}else{u.update(q.getDataRow(r))}s.push(u.getString())}while(t._rows.length>p){t._rows.pop()}return s.join("")},afterRender:function(){this.initDom();this.resizeColumn()},update:function(p){var q=this;p=p||{};g.mix(q,p);q.fireEvent("beforeupdate");q.updateContent(q.getString());q.resizeColumn();q.fireEvent("update")},getContentEl:function(){return o(this.el.id+"_outer")||this.el},getStore:function(){return this.DataSource},restore:function(){this.restoreData();this.restoreRows();this.resumePagebar()},restoreData:function(q){var p=this;q=q||p.DataSource;if(!q){return}p.columns=[];for(i=0,l=q.Columns.length;i<l;i++){p.columns.push({index:i,name:q.Columns[i].Name,type:q.Columns[i].Type})}p.title=[];for(i=0,l=q.Columns.length;i<l;i++){p.title.push(q.Columns[i].Name)}},_insertData:function(p,r){var q=this;q.DataSource.insertRows(p,r)},resizeColumn:function(){var p=this,r=[],q=p.getTableEl().rows[0];if(q&&p._columns){g.each(p._columns,function(s){if(s.hasOwnProperty("width")){f.setStyle(q.cells[s.index],"width",s.width)}})}},_createRow:function(p){p._parent=this;return new j.Row(p)},getRow:function(p){var q=this._rows[p];if(q&&!q.isDestroyed){return q}return null},getRowCount:function(){return this._rows.length},_insertRow:function(q,p,x,s){var r=this;if(r.editingRow){if(!r.editingRow.cancelEdit()){return}}if(r.isDataLoading){return}if(g.isNumber(q)){s=x;x=p;p=q;q=null}var u=r.DataSource;if(!g.isNumber(p)||p<0||p>u.Rows.length){p=u.Rows.length}u.insertRow(p,new Array(u.getColCount()));for(i=0;i<u.getColCount();i++){u.Rows[p].setAt(i,"")}r.OldValues=r.OldValues||[];r.OldValues.insert(p,new Array(u.getColCount()));if(!q){q={DataStore:u.Rows[p]}}var w=r._createRow(q);r._rows.splice(p,0,w);w.insertTo(p);var t=w.el;if(x){r.selectRow(p+1,true);r.editRow(t)}else{g.ComponentManager.initChildren(t)}if(s){s(this.el)}return w.getId()},resetRowEx:function(x){var r=this.getTableEl();var s=null;var w=r.rows[0];if(!w){return}var u;for(u=0;u<w.cells.length;u++){var q=w.cells[u].getAttribute("ztype");if(q&&q.toLowerCase()==="rowno"){s=u;break}}if(s!==null){if(!x){x=r.rows[1].cells[s].innerText;if(!x){x=r.rows[2].cells[s].innerText}}x=Number(x);var p=this.DataSource.Rows.length;for(u=1;u<=p;u++){this.DataSource.Rows[u-1].set("_rowno",x);r.rows[u].cells[s].innerText=""+x;r.rows[u].cells[s].setAttribute("rowno",x);x++}}var t=g.getByName(r.id+"_RowCheck");if(t){for(u=0;u<t.length;u++){t[u].id=r.id+"_RowCheck"+(u+1)}}},insertRow:function(q,p,t,s){var r=this;r.fireEvent("insertRow",{rowId:r._insertRow(q,p,t,s)})},addRowAndEdit:function(p){this.insertRow(0,true,p)},_removeRow:function(p){--p;var r=this,t=r._rows[p],s;if(t){s=t.getId();var q=r.DataSource.get(p,r.uniqueField);r.selModel.selectedDataCollection.remove(String(q));r.DataSource.deleteRow(p);t.remove();r._rows.splice(p,1);0===p&&r.resizeColumn()}return s},removeRow:function(p){var q=this,r=q._removeRow(p);if(r){q.fireEvent("removerow",{rowId:r})}},editRow:function(q,r){if(r){var s=this.DataSource;var p=q.rowIndex-1;var t=new DataRow(s,p);r(t)}else{this.afterEdit=this.afterEdit||this.el.afterEdit;var u=g.ComponentManager.getByDom(q,"DataGrid.Row");u.startEdit()}},gotoPage:function(p){var q=this;q.setParam(b.PageIndex,p);q.loadData(null,null,true,true)},previousPage:function(){this.gotoPage(this.getParam(b.PageIndex)-1)},nextPage:function(){this.gotoPage(this.getParam(b.PageIndex)+1)},firstPage:function(){this.gotoPage(0)},lastPage:function(){var s=this;var r=s.getParam(b.PageTotal);var q=s.getParam(b.Size);var p=Math.ceil(Number(r)/Number(q));this.gotoPage(p-1)},getTotalCount:function(){return this.getParam(b.Total)},getTotalPage:function(){var q=this;var p=q.getParam(b.Size);return g.isNumber(p)?Math.ceil(q.getTotalCount()/p):q.getParam(b.PageIndex)},getCurrentPage:function(){return this.getParam(b.PageIndex)},_changeSelectByIndexs:function(t,p){if(!t){return}if(!g.isArray(t)){t=[t]}var s=this;var q=[];for(var r=0;r<t.length;r++){q.push(s.getStore().getDataRow(t[r]-s.headerRowsLength))}if(p){this.selModel.doSelect(q)}else{this.selModel.doDeselect(q)}},select:function(p){return this._changeSelectByIndexs(p,true)},unselect:function(p){return this._changeSelectByIndexs(p,false)},getTitleCheckbox:function(){return o(this.titleCheckboxId||this.el.id+"_AllCheck")},_selectAll:function(q){var p=this;if(q){p.selModel.selectAll()}else{p.selModel.deselectAll()}},selectAll:function(){this._selectAll(true)},unselectAll:function(){this._selectAll(false)},clearAllSelected:function(){var p=this;this._selectAll(false);if(p.dom.dock){p.dom.$dock_station.hide()}},getSelectedValue:function(){return[].concat(this.selModel.selectedDataCollection.keys||[])},getSelectedTreeValue:function(){return g.getValues(this.el.id+"_TreeRowCheck")},getSelectedRows:function(){var q=this;var p=q.getTableEl();rs=[];for(i=1;i<p.rows.length;i++){if(p.rows[i].Selected===true){rs.push(p.rows[i])}}return rs},getCurrentPageSelectedData:function(){var A=this,s=A.getStore().Columns;var y=new DataCollection();var q=new DataTable();var B=[];for(var w=0;w<s.length;w++){B.push([s[w].Name,parseInt(s[w].Type||0,10)])}var t=A.getTableEl(),z,C,p;rs=[];for(w=1;w<t.rows.length;w++){z=t.rows[w];if(z.Selected===true){var x=z.getElementsByTagName("INPUT");for(var u=0,r=x.length;u<r;u++){if((x[u].type=="checkbox"||x[u].type=="radio")&&x[u].name==t.id+"_RowCheck"){C=x[u];break}}y.add(C.value,A.getStore().getDataRow(z.rowIndex-A.headerRowsLength).getValues())}}q.init(B,y.getValues());return q},getSelectedData:function(){var s=this,q=s.getStore().Columns;var r=new DataTable();var t=[];for(i=0;i<q.length;i++){t.push([q[i].Name,parseInt(q[i].Type||0,10)])}var p=[];s.selModel.selectedDataCollection.each(function(u){p.push(u.getValues())});r.init(t,p);return r},layout:function(r){var w=this;var q=this.el;var p=o(q).id;if(!g.Node.isVisible(q)){return}if(!w.autoFill){return}w.dom.wrapper.style.height="99%";w.dom.wrapper.style.height="99."+Math.floor(w.dom.wrapper.parentNode.clientHeight/100)+"%";var u=w.dom.wrapper.parentNode.style.height;if(u&&/^\d+[\d\.]*px$/.test(u)){var s=g.Node.isBorderBox(w.dom.wrapper.parentNode)?g.Node.getOuterH(w.dom.wrapper.parentNode):0;w.dom.wrapper.style.height=parseInt(u,10)-s+"px"}var x=w.dom.wrapper.clientHeight;var y=x-w.dom.headTable.clientHeight-(this.getParam(b.Page)=="true"&&o("_PageBar_"+p)?29:0);try{w.dom.body.style.height=y+"px";w.dom.body.setState("height",y)}catch(t){g.Console.error(w.dom.body,"设置高度不成功")}w.resumeScrollPanel()},initScroll:function(){var r=this;var q=r.getTableEl();var s=o(q).id;r.dom.body.onscroll=function(){var u=Math.floor(this.scrollLeft*r.dom.headTable.scrollWidth/r.dom.headTable.scrollWidth);if(r.dom.head.scrollLeft!==u){r.dom.head.scrollLeft=u}};if(r.autoPageSize){return}if(!r.autoFill){return}r.headLayout();if(g.ScrollPanel&&!g.isIE&&!g.isChrome&&false){if(!r.scrollpanelId){if(q.offsetHeight>r.dom.body.offsetHeight){r.scrollpanelId=new g.ScrollPanel({targetEl:r.dom.body}).getId()}}else{var p=g.ComponentManager.get(r.scrollpanelId);if(p){p.resume({targetEl:r.dom.body})}}}},resumeScrollPanel:function(){var r=this;var q=r.getTableEl();var s=q.id;r.headLayout();if(this.scrollpanelId){var p=g.ComponentManager.get(this.scrollpanelId);if(p){p.resume({targetEl:r.dom.body})}}},computePageSize:function(){var t=this;var q=t.getTableEl();if(!q||!q.parentNode){q=null;return}if(!t.autoPageSize||!t.autoFill){return false}if(q.style.height=="100%"){return}var r=q.parentNode.clientHeight;t.rowHeight=Math.max(t.rowHeight,q.clientHeight/q.rows.length);var s=Math.floor(r/t.rowHeight);var p=q.rows.length;if(p<=s+1){return}while(p>s+1){q.deleteRow(p-1);t.getStore().deleteRow(p-2);if(g.isIE6){p--}else{p=q.rows.length}}t.setParam(b.Size,s);t.dom.lastTh.style.borderRightWidth="0";t.resumePagebar()},headLayout:function(){var s=this;var p=this.getTableEl();var r=s.dom.lastTh;var q;if(!r){q=s.dom.headTable.rows[0].cells;r=s.dom.lastTh=q[q.length-1]}if(p.offsetHeight-27>s.dom.body.offsetHeight){r.style.borderRight="15px solid #EEEEEE"}else{r.style.borderRightWidth="0"}q=r=null},initPagebar:function(){var q=this.getTableEl();var u=q.id;var p=this.dom.pagebarWrap=g.getDom("_PageBar_"+u);if(p){var r=$(p);var s=r.find(".pageSizeGroup");if(s.length){var t=s.find("ul");s.hover(function(){t.show()},function(){t.hide()})}}},resumePagebar:function(){var G=this;var H=this.getTableEl();var A=H.id;var r=this.dom.pagebarWrap=g.getDom("_PageBar_"+A);if(!r){return}var s=$(r);var x=s.find(".pagebar");var y=Number(G.getParam(b.PageIndex));var t=Number(G.getParam(b.PageTotal));var E=Number(G.getParam(b.Size));var D=E===0?0:Math.floor(t/E);if(E===0||t%E===0){D--}var q=s.find(".first")[0];var F=s.find(".previous")[0];var B=s.find(".next")[0];var C=s.find(".last")[0];s.find(".js_total").html(t);s.find(".js_pageSize").html(E);s.find(".js_totalPages").html(1+D);s.find(".js_pageIndex").html(1+y);var z=s.find("input.gotopage");if(z.length){z.val(1+y).width(Math.max(String(1+y).length*7+1,15))}if(s.attr("pagebartype")!="2"){var w=s.find(".tfoot-fl");if(w.length){var u=w.find(".pageInfo");var p=w.find(".pageInfo_trigger");if(!u[0]._inited){if(u[0].offsetWidth+x[0].offsetWidth>w[0].parentNode.clientWidth){u.show();u[0]._width=u[0].clientWidth;u.hide();w.hoverIntent(function(){u.show().width(1).animate({width:u[0]._width},function(){p.hide()})},function(){u.animate({width:1},function(){u.hide();p.show()})});u[0]._inited=true;p.show()}}}}q._innerHTML_bak=q._innerHTML_bak||q.innerHTML;F._innerHTML_bak=F._innerHTML_bak||F.innerHTML;B._innerHTML_bak=B._innerHTML_bak||B.innerHTML;C._innerHTML_bak=C._innerHTML_bak||C.innerHTML;if(!/^<.*>$/.test(q._innerHTML_bak)){q._innerHTML_bak="<a onclick=\"Zving.DataGrid.firstPage('"+A+'\');" href="javascript:void(0);">'+d.get("DataGrid.FirstPage")+"</a>";F._innerHTML_bak="<a onclick=\"Zving.DataGrid.previousPage('"+A+'\');" href="javascript:void(0);">'+d.get("DataGrid.PrevPage")+"</a>"}if(!/^<.*>$/.test(C._innerHTML_bak)){B._innerHTML_bak="<a onclick=\"Zving.DataGrid.nextPage('"+A+'\');" href="javascript:void(0);">'+d.get("DataGrid.NextPage")+"</a>";C._innerHTML_bak="<a onclick=\"Zving.DataGrid.lastPage('"+A+'\');" href="javascript:void(0);">'+d.get("DataGrid.LastPage")+"</a>"}if(y<=0){q.innerHTML=q.innerText;F.innerHTML=F.innerText}else{if(q.innerHTML.trim()==q.innerText.trim()){q.innerHTML=q._innerHTML_bak;F.innerHTML=F._innerHTML_bak}}if(y>=D){B.innerHTML=B.innerText;C.innerHTML=C.innerText}else{if(B.innerHTML.trim()==B.innerText.trim()){B.innerHTML=B._innerHTML_bak;C.innerHTML=C._innerHTML_bak}}},sortableInit:function(){var r=this.el;if(this.sortable){var q=window["eval"](r.getAttribute("sortend"));var p="> .z-draggable";this._sortable(p,q)}},_sortable:function(p,r){var s=this;var u=this.listContainer=s.getRowsContainer();this.$listContainer=$(u);var q=this.getTableEl();var t={};if(p){t.handle=p}if(r){t.start=function(w,x){x.item.data("originalIndex",s.getRowIndex(x.item))};t.stop=function(){r.apply(this,Array.prototype.slice.call(arguments).concat(q))}}t.helper=function(w,y){var x=y[0].outerHTML;x=x.replace(/^(<\w+)([^>]*)>/igm,'$1 style="background-color:#ffe; border: 1px solid #ddd">').replace(/ id=[^ >]/igm,"");x=$(x);y.children().each(function(z){x.children().eq(z).width($(this).width())});return x};t.axis="y";this.$listContainer.sortable(t)},setSortable:function(r){var p=this;var q=this.listContainer=p.getRowsContainer();this.$listContainer=$(q);this.$listContainer.sortable({disabled:!r})},getRowsContainer:function(){var p=this.getTableEl();if(p.getElementsByTagName("tbody").length==1){return p.getElementsByTagName("tbody")[0]}return p},getRowIndex:function(p){return g.getDom(p).rowIndex-1},showLoading:function(){var t=this;var r=t.dom.body;var u=o("#_LoadingBGDiv");var z=o("#_LoadingIconDiv");if(!u){u=document.createElement("div");u.id="_LoadingBGDiv";f.hide(u);u.style.cssText="background-color:#FCFCFC;position:absolute;z-index:800;opacity:0.2;filter:alpha(opacity=20);";document.body.appendChild(u);z=document.createElement("div");z.id="_LoadingIconDiv";f.hide(z);z.innerHTML="　<img src='"+k+"framework/images/loadingGreen15px.gif'><font color=green> "+d.get("DataGrid.Loading")+"　</font>";z.style.cssText="padding-top:5px;background-color:#ffc;position:absolute;z-index:801;height:20px;width:120px";document.body.appendChild(z)}var s=$(u);var q=$(z);var x=$(r).offset();var y=t.dom.body.offsetWidth,p=t.dom.body.offsetHeight;s.css({top:x.top+"px",left:x.left+"px",width:y+"px",height:p+"px"});q.css({top:x.top+(g.isIE?2:0)+"px",left:x.left+(g.isIE?2:0)+"px"});s.show();q.show()},hideLoading:function(){$("#_LoadingBGDiv").hide();$("#_LoadingIconDiv").hide()},changePageSize:function(p){this.setParam(b.Size,p);this.loadData(null,null,null,true)},loadData:function(q,z,y,x){var u=this;var r=u.getTableEl();var p=r.id;var s=u.dom.body;if(u.isDataLoading){return}u.isDataLoading=true;var t=u.getSelectedValue();if(t&&t.length){j.currentSelected=t}if(!y||u.getParam(b.Multiselect)=="false"){u.clearAllSelected()}if(!z){z={}}else{if(z instanceof g.DataCollection){z=g.mix({},z.map)}}g.mix(z,u.params);delete z[b.TemplateTR];if(!x){z[b.PageTotal]=-1}u.showLoading();var w=g.getDom(u.el.id+"_AllCheck");if(w&&w.checked){w.checked=false}e.sendRequest(j.BackendMethod,z,function(C){setTimeout(u.hideLoading,200);if(C.Status===0&&C.Message){u.isDataLoading=false;Dialog.alert(C.Message);return}if(C._ZVING_STATUS===0&&C._ZVING_MESSAGE){u.isDataLoading=false;Dialog.alert(C._ZVING_MESSAGE);return}var E=C.HTML;if(!E||E.length<10){g.Console.error("用于渲染数据表格的数据错误："+C);u.isDataLoading=false;return}var B;u.afterEdit=u.afterEdit||r.afterEdit;u.cancelEdit=u.cancelEdit||r.cancelEdit;u.beforeEdit=u.beforeEdit||r.beforeEdit;if(u.getParam(b.Scroll)=="true"){jQuery.cleanData(u.dom.body.getElementsByTagName("*"));u.dom.body.innerHTML=E}else{B=document.createElement("div");B.setAttribute("ztype","_DataGrid");B.innerHTML=E;jQuery.cleanData(r.getElementsByTagName("*"));r.parentNode.replaceChild(B,r)}r=null;var F=u.el=o(p);F._components=F._components||{};F._components[u.ctype]=u.id;g.ComponentManager.initChildren(F);u.isDataLoading=false;var A=u.dom.body.getElementsByTagName("script");for(var D=0;D<A.length;D++){g.Util.globalEval(A[D].text)}u.restore();u.selectByValues(t);if(q){q.call(u,C)}u.fireEvent("loaddata");u.layout();u.syncAllColumnWidth();u.resumePagebar();u.sortableInit();if(u.afterUpdate){u.afterUpdate()}u.fireEvent("update");F=null;B=null;q=null},null,null,"json")},filter:function(r){var q=this;var s=q.data;var p;for(p=0;p<s.length;p++){if(r(s[p].content)){g.Node.show(q._rows[p].el)}else{g.Node.hide(q._rows[p].el)}}},clear:function(){var p=this;p.data=[];p.update()},sort:function(q,p){if(!p){p="DESC"}else{p=p.toUpperCase()}me.setParam(b.SortString,q+" "+p);me.loadData(null,null,null,true)},cancel:function(p){g.ComponentManager.getByDom(p,"DataGrid.Row").cancelEdit()},save:function(x,u){var t=this;if(t.editingRow!==null&&t.editingRow!==undefined){if(!t.editingRow.completeEdit()){return}}var w=t.DataSource;var p=t.getTableEl();var q=[],r;for(r=0,l=w.getRowCount();r<l;r++){if(w.getDataRow(r).modified){q.push(w.getDataRow(r).getValues())}}if(q.length===0){g.Dialog.alert(d.get("DataGrid.NoChange"));return}var s=new DataTable();s.Columns=w.Columns;s.Values=q;dc={};dc[b.DataTable]=s;e.sendRequest(x,dc,function(y){if(y&&y.Status===0){g.Dialog.alert(y.Message,u)}else{g.Dialog.alert(d.get("DataGrid.UpdateSuccess"),function(){var A;for(A=1;A<p.rows.length;A++){if(p.rows[A].ModifyFlag){p.rows[A].ModifyFlag=false;var z;for(z=0;z<p.rows[A].cells.length;z++){p.rows[A].cells[z].style.backgroundColor=""}}}t.OldValues=[];if(u){u.call(t)}})}},null,null,"json")},setColumnWidth:function(s,q,x){var u=this;if(u.disabledResize){return u}u.tableWidth=u.dom.headTable.offsetWidth;var t=100*q/u.tableWidth;var r=s.cellIndex;var y=u.dom.headTable.rows[0].cells[r+1];if(s.width){if(s.width.indexOf("%")>0){s.width=parseFloat(s.width)+t+"%";if(x&&y){u.setColumnWidth(y,-q)}}else{s.width=parseFloat(s.width)+q}}else{var p=s.style.width;if(p=="auto"||p===""){$(s).width($(s).width()+q)}else{p=parseInt(p,10);s.style.width=p+q+"px"}}u.syncColumnWidth(s,y);u.fireEvent("colresize");return u},syncColumnWidth:function(q,u){var t=this;var p=q.cellIndex;var s=t.getTableEl();var w=s.rows[0].cells[p];var r=s.rows[0].cells[p+1];if(q.width){w.width=q.width}if(q.style.width){w.style.width=q.style.width}if(u&&r){t.syncColumnWidth(u)}},syncAllColumnWidth:function(){var q=this.dom.headTable.rows[0].cells;for(var p=0;p<q.length;p++){if(q[p].getAttribute("disabledresize")!="true"){this.syncColumnWidth(q[p])}}q=null},rowEditorTpl:'<div id="{id}_rowEditor" class="dg-row-editor" style="position:absolute;"><div class="dg-row-editor-body" id="{id}_rowEditor_body"><table width="100%" cellpadding="0" cellspacing="0" id="{id}_rowEditor_table"><tr id="{id}_rowEditor_tr">{rowInnerHTML}</tr></table></div><div class="dg-row-editor-buttons"><button id="{id}_rowEditor_btn_ok">'+g.Lang.get("Common.OK")+'</button> <button id="{id}_rowEditor_btn_cancel">'+g.Lang.get("Common.Cancel")+"</button></div></div>",initRowEditor:function(){var s=this;var t=s.ownerDocument.createElement("DIV");t.id=s.outerEl.insertAdjacentHTML("beforeend",g.String.tmpl(s.rowEditorTpl,{id:s.id,rowInnerHTML:"<td>"+s.EditArray.join("</td><td>")+"</td>"}));s.rowEditor={$outerEl:$("#"+s.el.id+"_rowEditor"),trEl:g.getDom(s.el.id+"_rowEditor_tr"),$body:$("#"+s.el.id+"_rowEditor_body"),$okBtn:$("#"+s.el.id+"_rowEditor_btn_ok"),$cancelBtn:$("#"+s.el.id+"_rowEditor_btn_cancel")};var u=s.el.rows[0].cells;var r=s.rowEditor.trEl.cells;for(var q=0,p=u.length;q<p;q++){if(u[q].getAttribute("width")){r[q].setAttribute("width",u[q].getAttribute("width"))}if(u[q].style.width){r[q].style.width=u[q].style.width}}u=r=null;s.rowEditor.$okBtn.on("click",function(){s.editingRow.completeEdit()});s.rowEditor.$cancelBtn.on("click",function(){s.editingRow.cancelEdit()});s.rowEditor.$body.on("keydown",function(w){if(s.editingRow&&w.keyCode==13){s.editingRow.completeEdit()}})},beforeDestroy:function(){var q=this;if(this.dom.pagebarWrap){jQuery.cleanData(this.dom.pagebarWrap.getElementsByTagName("*"))}if(this.dom.dock){jQuery.cleanData(this.dom.$dock);jQuery.cleanData(this.dom.$dock_trigger);jQuery.cleanData(this.dom.$dock_station)}if(this.$hdRzLi){jQuery.cleanData(this.$hdRzLi)}delete this.$hdRzLi;if(this.$listContainer){if(this.$listContainer.data("sortable")){this.$listContainer.sortable("destroy")}jQuery.cleanData(this.$listContainer);delete this.$listContainer}if(this.dom.headTable){if(this.dom.headTable.rows[0]){this.dom.headTable.rows[0].onselectstart=null}jQuery.cleanData(this.dom.$headTable)}if(this.el.rows[0]){this.el.rows[0].onselectstart=null}if(this.rowEditor){jQuery.cleanData(this.rowEditor.$okBtn);jQuery.cleanData(this.rowEditor.$cancelBtn);jQuery.cleanData(this.rowEditor.$body);jQuery.cleanData(this.rowEditor.$outerEl);delete this.rowEditor.trEl;delete this.rowEditor;delete this.editingRow}if(this._columns&&this._columns.length){for(var p=0;p<this._columns.length;p++){delete this._columns[p].el}this._columns.length=0;delete this._columns}if(this.contextMenu&&this.contextMenu.destroy){this.contextMenu.destroy();delete this.contextMenu;this.contextMenuItems.length=0;delete this.contextMenuItems}delete this.renderBuffer;jQuery.cleanData(this.dom.$body);this.dom.body.onscroll=null}});var a="gotoPage,firstPage,previousPage,nextPage,lastPage,changePageSize,select,unselectAll,unselectOther,clearAllSelected,selectAll,getSelectedValue,getSelectedTreeValue,getSelectedData,getSelectedRows,clearAllSelected,getParam,setParam,save,getRowIndex,insertRow,removeRow,editRow,loadData,showLoading,hideLoading";a.split(",").each(function(p){j[p]=function(r){var q=g.toArray(arguments,1);var s=g.ComponentManager.getByDom(r,"DataGrid");if(s){return s[p].apply(s,q)}}});j.onSort=function(r){var p=$(r);var y=p.attr("direction");if(!y){y=""}if(y.toUpperCase()==="ASC"){y=""}else{if(y===""){y=" DESC"}else{if(y.toUpperCase()==="DESC"){y=" ASC"}}}var x=p.attr("sortField");var w=p.closest("table");var q=w.attr("SortString");var t=[];if(!q){q=""}var u=q.split(",");var s;if(y!==""){t.push(x+y)}for(s=0;s<u.length;s++){if(!u[s]||u[s].toLowerCase()===x.toLowerCase()||u[s].indexOf(x+" ")>=0){continue}t.push(u[s])}q=t.join();if(!q){q=""}var z;if(w.hasClass("dg-headTable")){z=w.parent().find("div.dg-body > table.z-datagrid");if(!z.length){z=w.parent().next().find("table")}}w.attr("sortstring",q);j.setParam(z[0].id,b.SortString,q);j.loadData(z[0].id,null,null,null,true);p.attr("direction",y.trim());p.find("img.fr")[0].className="fr icon_sort"+y.trim()};j.onAllCheckClick=function(p,q){p=o(p);var r=p.id;q=q||o(r+"_AllCheck");if(q.checked){j.selectAll(p)}else{j.unselectAll(p)}};j.getColumnInfo=function(t){t=o(t);var u=t.rows[0];var q=[];var s;var x;for(s=0;s<u.cells.length;s++){var y=u.cells[s];var p=y.getAttribute("ztype");p=p?p.toLowerCase():null;if(p==="rowno"){continue}if(p==="selector"){continue}if(p==="edit"){continue}x=y.textContent||y.innerText;if(x){var r=g.isIE?y.currentStyle.width:y.offsetWidth;r=r+"";if(r.indexOf("%")>0){r=g.Node.getSize(t).width*parseInt(r.replace(/\D/gi,""),10)/100}else{if(r.indexOf("px")!==-1){r=r.replace("px","")}else{if(r==="auto"){r=0}}}q.push([x,s,r])}}return q};j.toExcel=function(q,p,r){q=o(q);var s=new g.Dialog(d.get("DataGrid.SelectCol"),g.JSLIBPATH+"resources/dataGridToExcelDialog.html?DataGridID="+q.id,500,150);s.onOk=function(){var x=s.innerWin.Zving.getByName("Column");var t=[],u=[],w;for(w=0;w<x.length;w++){if(x[w].checked){t.push(x[w].value);u.push(x[w].getAttribute("columnWidth"))}}j.toExcelSubmit(q,p,t,u,r);$D.close()};s.show()};j.allToExcel=function(u,r){u=o(u);var q=[],s=[],t;var p=j.getColumnInfo(u);for(t=0;t<p.length;t++){q.push(p[t][1]);s.push(p[t][2])}j.toExcelSubmit(u,r,q,s)};j.toExcelSubmit=function(q,y,z,p,D){q=o(q);var w="_Excel_";var u=document.body;var x=o(w+"_Form");if(x){x.innerHTML="";x.parentNode.removeChild(x)}x=document.createElement("form");u.appendChild(x);x.id=w+"_Form";x.method="post";x.action=j.ToExcelAction;var A=j(q.id);var s=A.params;var C=function(F,G){var E=o(F);if(!E){E=document.createElement("input")}E.type="hidden";E.id=F;E.name=F;E.value=G;x.appendChild(E)};var t,B;for(var r in s){C(w+r,s[r])}C(w+"_ZVING_ToExcelPageFlag",y?"1":"0");C(w+"_ZVING_Widths",p.join());C(w+"_ZVING_Indexes",z.join());if(D){C(w+"_ZVING_Rows",D.join())}x.submit()};j.treeClick=function(t){var r=o(t);var D=$(r).closest("."+m),F=D.closest("table")[0];D=D[0];var u=false;if(t.src.indexOf("butExpand")>0){t.src=""+k+"framework/images/butCollapse.gif";u=true}else{t.src=""+k+"framework/images/butExpand.gif"}var G=F.rows;var q=parseInt(D.getAttribute("level"),10);var x=D.rowIndex+1;if(x==G.length||parseInt(G[x].getAttribute("level"),10)<=q){t.src=""+k+"framework/images/butExpand.gif";if(D.getAttribute("childRowsLoaded")!=="true"){var E=f.getComponent(D,"DataGrid.Row");E.lazyLoad()}}else{var z,B,y=x,C=0,A=G.length;var s=new Date();var w=function(){z=new Date();for(;y<A;y++){var J=G[y];var I=parseInt(J.getAttribute("level"),10);if(I>q){C++;if(u){J.setAttribute("_TreeHideLevel",q);f.hide(J)}else{if(parseInt(J.getAttribute("_TreeHideLevel"),10)===q){f.show(J);J.setAttribute("_TreeHideLevel",null);var L=G[y-1];if(L&&L.getAttribute("level")){var p=parseInt(L.getAttribute("level"),10);if(p<I){var K=J.getElementsByTagName("IMG");for(var H=0;H<K.length;H++){if(K[H].src.indexOf("butCollapse.gif")!=-1){K[H].src=""+k+"framework/images/butExpand.gif";break}}}}}}if(new Date()-z>500){console.log((u?"折叠":"展开")+C+"个节点");setTimeout(w,10);return}}else{console.log((u?"折叠":"展开")+C+"个节点，耗时"+(new Date()-s));break}}};w()}};j.Row=function(p){this.defaultConfig={_cells:{}};if(!(this instanceof j.Row)){return g.ComponentManager.getByDom(g.getDom(p),"DataGrid.Row")}j.Row.superclass.constructor.apply(this,arguments)};g.Class.extend(j.Row,g.UICompBase,{ctype:"DataGrid.Row",cls:"dg-row",outerElAttrs:"tr",autoElTpl:'<tr id="{id}" class="{cls}">{cells}</tr>',renderTpl:"{cells}",initComponent:function(){this.addEvents("beforeupdate","update","addcell","removecell","click","select","unselect");j.Row.superclass.initComponent.apply(this)},initFromDom:function(t){var s=this,r=o(t);s._cells=[];for(var q=0,p=r.cells;q<p;q++){s._cells.push(new j.Cell({el:r.cells[q],_parent:s}))}return{el:r}},restore:function(){var s=this;var r=s.el;r._components=r._components||{};r._components[s.ctype]=s.id;s.$el=$(s.el);for(var q=0,p=r.cells.length;q<p;q++){if(s._cells[q]&&s._cells[q].ctype=="DataGrid.Cell"){s._cells[q].el=r.cells[q];s._cells[q].restore()}else{s._cells[q]=new j.Cell({el:r.cells[q],_parent:s})}}while(s._cells.length>p){s._cells.pop()}return s._cells},getString:function(){var p=this,q=this.initRenderData();return g.String.tmpl(this.autoElTpl,q)},initRenderData:function(){var p=this,q=[];this.renderData=this.renderData||{};g.each(p.content,function(s,r){q.push("<td>",s===undefined?"":s,"</td>")});return g.mixIf(this.renderData,{id:this.id,cls:this.cls,cells:q.join("")})},update:function(p){var r=this,q=r.getEl(),s=q.children;jQuery.cleanData(q.getElementsByTagName("*"));p=p||{};g.mix(r,p);g.each(s,function(u,t){u.innerHTML=r.content[t]});r.fireEvent("update")},insertTo:function(r){var u=this,x,p;if(!u.getEl()){var w=u.getParent();var t=w.getTableEl();if(t.rows[0].getAttribute("ztype")=="head"||t.rows[0].className=="dg-headTr"){++r}if(t.tBodies&&t.tBodies.length){t=t.tBodies[0];r--}x=t.insertRow(r);f.setAttr(x,{id:u.getId(),"class":u.cls});for(var s=0,q=w.dom.headTr.cells.length;s<q;s++){p=x.insertCell(s);p.innerHTML="&nbsp;"}u.setStateHandler(x);if(w.TemplateArray&&w.TemplateArray.length&&u.DataStore){u._updateRowHtml(x,u.DataStore)}else{g.each(u.content,function(z,y){p=x.insertCell(y);p.innerHTML=z===undefined?"&nbsp;":z})}u.el=x;x._components=x._components||{};x._components[u.ctype]=u.id;p=null}},setStateHandler:function(){},getParent:function(){return this._parent},_getCols:function(){return this.el.children},_getColsString:function(q,p){return colsArr.join("")},select:function(p){if(this.rendered){this.el.selected=true;this.$el.addClass(n)}this.selected=true;if(p!==true){this.fireEvent("select",this)}return this},onSelect:function(){this.select()},unselect:function(p){if(this.rendered){this.el.selected=false;this.$el.removeClass(n)}this.selected=false;if(p!==true){this.fireEvent("unselect",this)}return this},onUnselect:function(){this.unselect()},isSelected:function(){return this.selected},remove:function(){var p=this;p.getParent().getTableEl().deleteRow(p.el.rowIndex);p.destroy()},toggle:function(){var p=this;if(p.isSelected()){p.unselect()}else{p.select()}},getCell:function(q){var r=this,s=r._getCols()[q],p;if(s){if(s.id){p=r._cells[s.id]}else{p=new j.Cell({target:s});p._initialize(r);r._cells[p.getId()]=p}}s=null;return p},startEdit:function(){var u=this;var A=u.el;var t=u.getEditor();var x=u.getParent();var q=x.DataSource;var z=A.rowIndex-1;var r=new DataRow(q,z);if(x.editingRow&&u!=x.editingRow){x.editingRow.completeEdit()}var y=x.dom.headTr;u.editing=true;x.editing=true;x.editingRow=u;j.EditingRow=A;var p=/\$\{(\w+?)\}/gi;t.$outerEl.show();jQuery.cleanData(t.trEl.getElementsByTagName("*"));for(i=0;i<y.cells.length;i++){var s=unescape(x.EditArray[i]);s=s.replace(p,function(C,B){return r.get(B)});t.trEl.cells[i].innerHTML=s}g.ComponentManager.initChildren(t.trEl);t.$body.find(":text:first").focus();var w=A.offsetTop+"px";if(t.$outerEl.get(0).style.top!=w){t.$outerEl.animate({top:w})}if(x.beforeEdit){x.beforeEdit(A,r)}return true},cancelEdit:function(){var s=this;if(!s.editing){return}var r=s.el;var x=s.getParent();var t=x.DataSource;var p=r.rowIndex-1;var w=new DataRow(t,p);if(x.cancelEdit){x.cancelEdit(r,w)}var q=s.getEditor();q.$outerEl.hide();s.editing=false;x.editing=false;x.editingRow=null;j.EditingRow=null;try{x.dom.$body.get(0).focus()}catch(u){}},completeEdit:function(){var t=this;if(!t.editing){return}var r=t.getEditor();var y=t.el;var u=t.getParent();var p=u.DataSource;var x=y.rowIndex-1;var q=new DataRow(p,x);u.OldValues=u.OldValues||[];if(!u.OldValues[x]){var z=p.Values[x].clone();u.OldValues[x]=z}if(u.afterEdit){if(!u.afterEdit(y,q)){return false}}var w=u.OldValues[x];t._updateRowHtml(y,q,w);t.editor.$outerEl.hide();t.editing=false;u.editing=false;u.editingRow=null;j.EditingRow=null;t.fireEvent("edit",t,t._parent);t._parent.fireEvent("edit",t,t._parent);try{u.dom.$body.get(0).focus()}catch(s){}},_updateRowHtml:function(A,B,C){var I=this;var H=I.getParent();var E=H.DataSource;var D=A.rowIndex-1;var F=H.dom.headTr;var z;for(i=0;i<F.cells.length;i++){var s=F.cells[i];z=s.getAttribute("ztype");z=z&&z.toLowerCase();var t=s.getAttribute("field");var x=false;if(z&&/^(selector|rowno|dropdownlist)$/.test(z)){}else{if(z&&z==="checkbox"){if(C){x=C[E.ColMap[t.toLowerCase()]]!=B.get(t)}}else{if(z&&z==="dropdownlist"){if(C){x=C[E.ColMap[t.toLowerCase()]]!=B.get(t)}}else{var p=[];if(z&&z.toLowerCase()==="tree"){var q=parseInt(A.getAttribute("level"),10);var u=0;var r=true;if(A.rowIndex!==H.rows.length-1){u=parseInt(H.rows[A.rowIndex+1].getAttribute("level"),10);r=H.rows[A.rowIndex+1].style.display!=="none"}var G;for(G=0;G<q;G++){p.push("<q style='padding:0 10px'></q>")}if(q<u){if(r){p.push("<img src='"+k+"framework/images/butExpand.gif' onclick='Zving.DataGrid.treeClick(this)'/>&nbsp;")}else{p.push("<img src='"+k+"framework/images/butCollapse.gif' onclick='Zving.DataGrid.treeClick(this)'/>&nbsp;")}}else{p.push("<img src='"+k+"framework/images/butNoChild.gif'/>&nbsp;")}}var y=unescape(H.TemplateArray[i]);var w=/\$\{(\w+?)\}/gi;p.push(y.replace(w,function(K,J){if(C){if(C[E.ColMap[J.toLowerCase()]]!=B.get(J)){x=true}}var L=B.get(J);if(L===""||L===null){L="&nbsp;"}return L}));jQuery.cleanData(A.cells[i].getElementsByTagName("*"));A.cells[i].innerHTML=p.join("")}}}if(x){A.cells[i].style.backgroundColor="#FEB34E"}else{A.cells[i].style.backgroundColor=""}if(!A.ModifyFlag&&x){A.ModifyFlag=true}}},getEditor:function(){var p=this;if(!p.editor){p.editor=p.initEditor()}return p.editor},initEditor:function(){var p=this;if(!p._parent.rowEditor){p._parent.initRowEditor()}return p._parent.rowEditor},lazyLoad:function(p){var r=this;var s=r.el;var q=r.$el;var t=r._parent;if(r.isDataLoading){return}q.after('<tr><td class="z_loading" colspan="'+s.cells.length+'">loading...</td></tr>');r.isDataLoading=true;p=p||{};g.mix(p,t.params);delete p[b.TemplateTR];p[b.Lazy]=true;p.ParentLevel=s.getAttribute("level");p[t.params[b.TreeParentColumn]||"ParentID"]=s.getAttribute("treenodeid");e.sendRequest(j.BackendMethod,p,function(u){if(!s.getAttribute("childRowsLoaded")){s.setAttribute("childRowsLoaded","true");var w=u.HTML;if(!w||w.indexOf("<tr")!==0&&w.indexOf("<table")!==0){console.error("用于渲染展开的行的数据错误："+u);r.isDataLoading=false;return}if(w.indexOf("<table")===0){var x=w.split(/<\/?tbody>/);w=x[1].trim()+x[2].trim();w=w.replace(/\s*<\/table>$/i,"").trim()}q.next().remove();q.after(w);if(typeof s.onTreeLazyLoad=="function"){s.onTreeLazyLoad.call(r,s)}if(typeof t.el.onTreeLazyLoad=="function"){t.el.onTreeLazyLoad.call(t,r,s)}t.fireEvent("toggle",{treeNode:r})}t=s=q=null;r.isDataLoading=false},null,null,"json")},beforeDestroy:function(){if(this.editor){delete this.editor}delete this._parent}});j.Cell=function(p){this.defaultConfig={};if(!(this instanceof j.Cell)){return g.ComponentManager.getByDom(g.getDom(p),"DataGrid.Cell")}j.Cell.superclass.constructor.apply(this,arguments)};g.Class.extend(j.Cell,g.UICompBase,{ctype:"DataGrid.Cell",outerElAttrs:"td",cls:"dg-cell",renderTpl:"{content}",initComponent:function(){this.addEvents("click","select","unselect");j.Cell.superclass.initComponent.apply(this);f.addClass(this.el,this.cls)},_init:function(q){var p=this;p.setParent(q);f.setAttr(p.target,id,p.getId())},restore:function(){},getParent:function(){return this._parent},setParent:function(p){this._parent=p},getHTML:function(){return this.getEl().innerHTML},setHTML:function(r){var q=this,p=q.getParent(),s=q.getEl();p.getParent().data[p.getEl().rowIndex].content[s.cellIndex]=r;if(s.innerHTML){jQuery.cleanData(elem.getElementsByTagName("*"))}s.innerHTML=r}});j.getBackState=function(){$("div.dg-scrollable div.dg-body").each(function(){var q=this.firstChild;if(q&&q.tagName=="TABLE"&&q.getAttribute("autofill")=="true"){g.Statable(this);var p=this.getState("height");if(p){this.style.height=p+"px"}}})};g.Page.onReady(j.getBackState);$(document).on("pageshow",".ui-page",j.getBackState);g.DataGrid=j})();(function(){var b=Zving,a=Zving.DataGrid;b.mix(a.prototype,{onRowContextMenu:function(m){var k=this;var j=m.currentTarget;if(!k.getSelectedRows().length){k.onRowClick(m)}var f=k.el;if(f.onContextMenu){f.onContextMenu(m,j)}else{var d=f.id;var e=k.contextMenu;var g=m.srcElement;if(!e){this.contextMenuItems=this.contextMenuItems||[];this.contextMenuItems.push({icon:CONTEXTPATH+"icons/icon003a2.png",text:Lang.get("DataGrid.SelectedRowToExcel"),handler:function(n,o){k.selectedRowToExcel(d)}});this.contextMenuItems.push({icon:CONTEXTPATH+"icons/icon003a4.png",text:Lang.get("DataGrid.ToExcel"),handler:function(n,o){a.toExcel(d,true)}});this.contextMenuItems.push({icon:CONTEXTPATH+"icons/icon003a3.png",text:Lang.get("DataGrid.AllToExcel"),handler:function(n,o){a.toExcel(d)}});e=k.contextMenu=new DropMenu({id:"contextMenu1",items:this.contextMenuItems})}e.srcTd=m.srcElement;var h=b.Dom.getFrameXY();e.showAt({x:h.x+m.pageX,y:h.y+m.pageY});var c=b.Node.getConstrainToXY(e.el,e.ownerDocument);if(c){b.Node.setPosition(e.el,c)}}m.preventDefault()},addMenuFromButton:function(e){this.contextMenuItems=this.contextMenuItems||[];var d=b.ComponentManager.getByDom(e,"Button");if(d){var c=this.contextMenuItems.push({icon:d.icon,iconCls:d.iconCls,text:d.text,disabled:d.disabled,handler:function(g,f){d.$el.click()}})}}})})();(function(){var b=Zving,a=Zving.DataGrid;b.mix(a.prototype,{selectedCellCls:"dg-cell-selected",selectedRowCls:"dg-row-selected",focusedItemCls:"dg-row-focused",processUIEvent:function(g){var f=this;var d=g.type;var c,h;if(d=="keydown"){c=f.getSelectionModel().getLastSelected();if(c){h=c.getIndex()+f.headerRowsLength;item=f.getRowEl(h)}}if(item){f.fireEvent("itemkeydown",f,c,item,h,g)}},walkCells:function(p,q,k,r,c,s){if(!p){return}var n=this,t=p.row,g=p.column,o=n.el.rows.length,h=1,j=0,d=n.el.rows[0].cells.length-1,m={row:t,column:g},f=n.getHeaderAtIndex(g);console.log("getRowCount",n.getRowCount());console.log("me.el.rows.length-1",n.el.rows.length-1);if(!f||f.hidden){return false}k=k||{};q=q.toLowerCase();switch(q){case"right":if(g===d){if(r||t===o-1){return false}if(!k.ctrlKey){m.row=t+1;m.column=j}}else{if(!k.ctrlKey){m.column=g+n.getRightGap(f)}else{m.column=d}}break;case"left":if(g===j){if(r||t<=h){return false}if(!k.ctrlKey){m.row=t-1;m.column=d}}else{if(!k.ctrlKey){m.column=g+n.getLeftGap(f)}else{m.column=j}}break;case"up":if(t<=h){return false}else{if(!k.ctrlKey){m.row=t-1}else{m.row=h}}break;case"down":if(t===o-1){return false}else{if(!k.ctrlKey){m.row=t+1}else{m.row=o-1}}break}if(c&&c.call(s||window,m)!==true){return false}else{return m}},walkRows:function(k,c){var f=this,g=0,n=k,d,j=f.el.rows.length-1,e=(c<0)?0+f.headerRowsLength:j,h=e?1:-1,m=k;do{if(e?m>=e:m<=0){return n||e}m+=h;if((d=f.el.rows[m])&&Node.isVisible(d)){g+=h;n=m}}while(g!==c);return m},getGridColumns:function(d){if(!d){return this._columns}var c=[];for(var g=0,e=this._columns.length;g<e;g++){var f=this._columns[g];if(f.editorConfig||f.getEditor){c.push(f)}}return c},getHeaderAtIndex:function(c){return this._columns[c]},getLeftGap:function(c){return -1},getRightGap:function(c){return 1},selType:"RowModel",getSelectionModel:function(){var d=this;if(!this.selModel){this.selModel={}}var e="SINGLE",c;if(this.simpleSelect){e="SIMPLE"}else{if(this.multiSelect){e="MULTI"}}b.mixIf(this.selModel,{allowDeselect:this.allowDeselect,mode:e});if(!this.selModel.events){c=this.selModel.selType||this.selType;this.selModel=new b.selection[c](this.selModel)}if(!this.selModel.hasRelaySetup){this.selModel.on("selectionchange",function(){d.fireEvent.apply(d,["selectionchange"].concat(Array.prototype.slice.apply(arguments)))});this.selModel.on("beforeselect",function(){d.fireEvent.apply(d,["beforeselect"].concat(Array.prototype.slice.apply(arguments)))});this.selModel.on("beforedeselect",function(){d.fireEvent.apply(d,["beforedeselect"].concat(Array.prototype.slice.apply(arguments)))});this.selModel.on("select",function(){d.fireEvent.apply(d,["select"].concat(Array.prototype.slice.apply(arguments)))});this.selModel.on("deselect",function(){d.fireEvent.apply(d,["deselect"].concat(Array.prototype.slice.apply(arguments)))});this.selModel.hasRelaySetup=true}if(this.disableSelection){this.selModel.locked=true}return this.selModel},getCell:function(d,e){var f=this.el.rows[d.getIndex()+1];var c=f.cells[e._index];return c},getRecord:function(c){return this.getStore().getDataRow(c.rowIndex-1)},getScroll:function(){return{top:this.dom.body.scrollTop,left:this.dom.body.scrollLeft}},onCellSelect:function(d){console.log("onCellSelect",d.row,d.column,"高亮");var c=this.getCellByPosition(d,true);if(c){Node.addClass(c,this.selectedCellCls)}},onCellDeselect:function(d){var c=this.getCellByPosition(d,true);if(c){Node.removeClass(c,this.selectedCellCls)}},onCellFocus:function(c){this.focusCell(c)},onRowSelect:function(g){var f=this;var h=this.getRowEl(g);if(h){Node.addClass(h,this.selectedRowCls);h.Selected=true;if(f.dom.dock&&f.hasSelector){f.highlight_dock.delay(100)}var c=h.getElementsByTagName("INPUT");var d;for(var e=0;e<c.length;e++){d=c[e];if(d.name==f.el.id+"_RowCheck"&&d.checked!==true){d.checked=true;break}}c=d=null}},onRowDeselect:function(g){var f=this;var h=this.getRowEl(g);if(h){Node.removeClass(h,this.selectedRowCls);h.Selected=false;if(f.dom.dock&&f.hasSelector){f.highlight_dock.delay(100)}var c=h.getElementsByTagName("INPUT");var d;for(var e=0;e<c.length;e++){d=c[e];if(d.type=="checkbox"&&d.name==f.el.id+"_RowCheck"&&d.checked!==false){d.checked=false;break}}c=d=null}},getRowEl:function(c){return this.el.rows[c]},getCellByPosition:function(c,d){var f=this;if(c){console.log("getCellByPosition",c.row,c.column);var e=f.el.rows[c.row],g=this.getHeaderAtIndex(c.column);if(g&&e){return e.cells[c.column]}}return false},focusCell:function(j){var m=this,n=m.getCellByPosition(j),d=m.dom.body,f=0,g=0,e=b.Node.getBox(d),c=m.ownerCt,k,h;e.bottom=e.top+d.clientHeight;e.right=e.left+d.clientWidth;if(n){k=b.Node.getBox(n);if(k.top<e.top){f=k.top-e.top}else{if(k.bottom>e.bottom){f=k.bottom-e.bottom}}if(k.left<e.left){g=k.left-e.left}else{if(k.right>e.right){g=k.right-e.right}}if(f){d.scrollTop=d.scrollTop+f}if(g){d.scrollLeft=d.scrollLeft+g}d.focus();m.fireEvent("cellfocus",h,n,j)}},cancelFocus:function(){var c=this.focusTask;if(c){c.cancel()}},dirtyCls:"dg-cell-dirty",markDirty:true,onRecordUpdate:function(m,j,g){console.log("编辑器修改了记录");console.log(this.getParam(Constant.TemplateTR));var n=this;var q=n.el.rows[m.getIndex()+1];var o=q.cells[g._index];if(n.markDirty){Node.addClass(o,n.dirtyCls)}var p=n.bufferRender(m)[0];var f=n.dom.headTr.cells;var d=q.cells;var e=p.cells;for(var k=0,h=e.length;k<h;k++){var c=f[k].getAttribute("ztype");if(c&&/^(selector|rowno|dropdownlist)$/.test(c)){continue}d[k].innerHTML=e[k].innerHTML}n.fireEvent("itemupdate",m,m.getIndex(),p)},bufferRender:function(c){var f=this,h=f.renderBuffer||(f.renderBuffer=document.createElement("div"));var d=f.getParam(Constant.TemplateTR);var g=c.toJSON();g.i=c.getIndex()+f.headerRowsLength;var e="<table>"+b.String.$tmpl(d,g)+"</table>";f.renderBuffer.innerHTML=e;return h.firstChild.rows}})})();(function(){var d=window.Zving,b=d.Node,c=d.Lang,a;a=function(e){};d.mix(a.prototype,{ptype:"DataGrid.plugin.HeaderResizer",init:function(e){var f=this;f.grid=e;f.grid.on("afterRender",function(g){f.initEvents()})},initEvents:function(){var h=this;var e=h.grid.dom.headTable.rows[0].cells;var g=e[e.length-1];g.setAttribute("disabledresize","true");var f=g.tagName.toLowerCase();h.grid.dom.$headTable.on("mousemove",f,function(j){h.onHDMouseMove(j)});h.grid.dom.$headTable.on("mousedown",f,function(j){h.onHDMouseDown(j)});e=g=null},onHDMouseMove:function(j){var h=this;var f=h.grid.dom.head.style;if(h.grid.disabledResize){f.cursor="";return}if(h.resizing){f.cursor="col-resize";return}var e=j.currentTarget;if(!e||e.getAttribute("disabledresize")=="true"||e.disabled){f.cursor=""}else{var g=e.offsetWidth-j.pageX+b.getOffset(e).left;if(g<(h.resizerBarLen||10)){f.cursor="col-resize"}else{f.cursor=""}}e=null},onHDMouseDown:function(j){var h=this;h.dd=h.dd||{};var g=j.currentTarget;var f=h.grid.dom.head.style;var e=g;if(!g){return}if(f.cursor!="col-resize"||e.getAttribute("disabledresize")=="true"){return}h.resizing=true;h.startResizeSpliter(e,j);h.dd.resizingEl=g;d.Node.unselectable();$document.on("mouseup.colresize",function(k){h.onHDMouseUp(k)});$document.on("mousemove.colresize",function(k){h.onHDResize(k)});h.grid.fireEvent("colresizestart")},startResizeSpliter:function(g,m){var k=this;var p=k.$hdRzLi;if(!p){p=k.$hdRzLi=$("#z-hd-spliter");if(!p.length){p=k.$hdRzLi=$('<div id="z-hd-spliter" class="z-hd-spliter"></div>').appendTo(document.body).hide()}var e=k.grid.dom.body.clientHeight;var n=k.grid.dom.head.clientHeight;p.height(e+n)}var o=$(g).offset(),j=g.offsetWidth;var h=g.cellIndex;var f=k.grid.dom.headTable.rows[0].cells[h+1];p._left=o.left+j-1;p.css({left:p._left,top:o.top}).show();k.dd.minRz=(k.resizerBarLen||15)-j;k.dd.maxRz=f?f.offsetWidth-(k.resizerBarLen||15):0;k.dd.initMx=m.pageX;k.dd.initLeft=p._left},endResizeSpliter:function(e){this.$hdRzLi.hide()},onHDResize:function(e){var f=this;var g=e.pageX-f.dd.initMx;if(g<0&&g<f.dd.minRz){g=f.dd.minRz}else{if(g>f.dd.maxRz){g=f.dd.maxRz}}f.$hdRzLi.css("left",f.dd.initLeft+g);f.$hdRzLi._left=f.dd.initLeft+g},onHDMouseUp:function(e){var g=this;g.endResizeSpliter();$document.off("mouseup.colresize");$document.off("mousemove.colresize");d.Node.selectable();var f=g.$hdRzLi._left-g.dd.initLeft;if(f!==0){g.grid.setColumnWidth(g.dd.resizingEl,f,true)}g.grid.fireEvent("colresizeend");g.resizing=false},destroy:function(){var e=this;$document.off("mouseup.colresize");$document.off("mousemove.colresize");delete e.grid.resizerPlugin;delete e.grid}});d.DataGrid.plugin=d.DataGrid.plugin||{};d.DataGrid.plugin.HeaderResizer=a})();(function(){var z=window.Zving,Node=z.Node,Lang=z.Lang,CellEditing,RowEditing;CellEditing=function(config){var me=this;z.Observable(this);me.addEvents("beforeedit","edit","validateedit","canceledit");me.editors=new z.DataCollection()};z.mix(CellEditing.prototype,{ptype:"DataGrid.plugin.CellEditing",cls:"",clicksToEdit:1,triggerEvent:undefined,init:function(grid){var me=this;me.grid=grid;me.grid.on("afterRender",function(e){me.initEvents();me.initFieldAccessors()});me.on("beforeedit",function(){me.grid.fireEvent.apply(me.grid,["beforeedit"].concat(Array.prototype.slice.apply(arguments)))});me.on("edit",function(){me.grid.fireEvent.apply(me.grid,["edit"].concat(Array.prototype.slice.apply(arguments)))});me.on("validateedit",function(){me.grid.fireEvent.apply(me.grid,["validateedit"].concat(Array.prototype.slice.apply(arguments)))});me.on("canceledit",function(){me.grid.fireEvent.apply(me.grid,["canceledit"].concat(Array.prototype.slice.apply(arguments)))});me.grid.selType="CellModel";me.grid.isEditable=true;me.grid.editingPlugin=me},initFieldAccessors:function(){var me=this;var ths=me.grid.dom.headTr.cells;for(var i=0;i<ths.length;i++){var th=ths[i];var column=me.grid._columns[i];column._index=i;column.el=ths[i];column._id="z-column"+(++z.idSeed._seed);column.innerText=th.innerText.trim();var editorConfig=th.getAttribute("editor");var editor;if(editorConfig===null){continue}if(editorConfig===""){editorConfig='type:"text"'}if(/^[\w\.]+\(.*\);?$/.test(editorConfig)){editorConfig=new Function("opts","return "+editorConfig+";")}else{if(editorConfig.indexOf(":")>0){editorConfig=eval("({"+editorConfig+"})");if(editorConfig.type){editorConfig.type=editorConfig.type.toUpperCase().substr(0,1)+editorConfig.type.toLowerCase().substr(1)}else{editorConfig.type="Text"}if(editorConfig.field){editorConfig.field=editorConfig.field.toLowerCase();if(editorConfig.field.indexOf(",")>0){var fields=editorConfig.field.split(",");column.field1=fields[1];editorConfig.field=fields[0]}column.field=editorConfig.field}}else{throw"初始化错误，DataGrid中存在错误的editor属性配置。"}}column.editorConfig=editorConfig;if(!column.getEditor){column.getEditor=function(record,defaultField){return me.getColumnField(this,defaultField)}}if(!column.setEditor){column.setEditor=function(fieldEditor){me.setColumnField(this,fieldEditor)}}}},getColumnField:function(columnHeader,defaultField){var fieldEditor=columnHeader.fieldEditor;var editorConfig=columnHeader.editorConfig;if(!fieldEditor&&columnHeader.editorConfig){editorConfig=columnHeader.editorConfig;delete columnHeader.editorConfig}if(!editorConfig&&defaultField){editorConfig=defaultField}if(editorConfig){if(typeof editorConfig=="function"){fieldEditor=columnHeader.editorConfig()}else{if(editorConfig.type){var type=editorConfig.type||defaultField.type;delete editorConfig.type;fieldEditor=new z.fieldEditor[type](editorConfig)}}fieldEditor.fieldName=columnHeader.field;columnHeader.fieldEditor=fieldEditor}return fieldEditor},setColumnField:function(columnHeader,fieldEditor){columnHeader.fieldEditor=fieldEditor},initEvents:function(){var me=this;if(me.triggerEvent=="cellfocus"){me.grid.on("cellfocus",me.onCellFocus,me)}else{if(me.triggerEvent=="rowfocus"){me.grid.on("rowfocus",me.onRowFocus,me)}else{me.grid.on(me.triggerEvent||(me.clicksToEdit===1?"cellclick":"celldblclick"),me.onCellClick,me)}}me.grid.dom.$body.on("keydown",function(evt){if(evt.keyCode==z.Event.keys.enter){me.onEnterKey(evt);evt.stopPropagation();evt.preventDefault()}else{if(evt.keyCode==z.Event.keys.esc){me.onEscKey(evt);evt.preventDefault()}}});me.grid.on("columnresize",me.cancelEdit,me);me.grid.on("columnmove",me.cancelEdit,me);me.grid.dom.$body.on("mousewheel",function(e){me.cancelEdit(e)});me.grid.dom.$body.on("scroll",function(e){me.onBodyScroll(e)})},onBodyScroll:function(e){},onRowFocus:function(record,row,rowIdx){this.startEdit(row,0)},onCellFocus:function(record,cell,position){console.log("onCellFocus",record,cell,position);this.startEdit(position.row,position.column)},onCellClick:function(grid,cell,colIdx,record,row,rowIdx,e){console.log("onCellClick",cell);if(!grid.expanderSelector||e.target!=grid.expanderSelector){this.startEdit(record,grid.getHeaderAtIndex(colIdx))}},onEnterKey:function(e){var me=this,grid=me.grid,selModel=grid.getSelectionModel(),record,pos,columnHeader=grid.getHeaderAtIndex(0);if(selModel.getCurrentPosition){pos=selModel.getCurrentPosition();if(pos){record=pos.record||grid.getStore().getDataRow(pos.row-grid.headerRowsLength);columnHeader=pos.columnHeader||grid.getHeaderAtIndex(pos.column)}}else{record=selModel.getLastSelected()}console.error(e.target,record.getIndex);if(record&&columnHeader){me.startEdit(record,columnHeader)}},onEscKey:function(e){this.cancelEdit()},beforeEdit:z.noopFn,startEdit:function(record,columnHeader){var me=this,context=me.getEditingContext(record,columnHeader);var value,ed;me.completeEdit();if(!context||!me.grid.isVisible(true)){return false}record=context.record;columnHeader=context.column;if(!columnHeader||!columnHeader.getEditor||!columnHeader.getEditor(record)){return false}value=record.get(columnHeader.field);context.originalValue=context.value=value;if(me.beforeEdit(context)===false||me.fireEvent("beforeedit",me,context)===false||context.cancel){return false}ed=me.getEditor(record,columnHeader);me.grid.cancelFocus();me.grid.focusCell({row:context.rowIdx,column:context.colIdx});if(ed){setTimeout(function(){me.showEditor(ed,context,value)},15);return true}return false},showEditor:function(ed,context,value){var me=this,record=context.record,columnHeader=context.column,sm=me.grid.getSelectionModel(),selection=sm.getCurrentPosition();me.context=context;me.setActiveEditor(ed);me.setActiveRecord(record);me.setActiveColumn(columnHeader);if(sm.selectByPosition&&(!selection||selection.column!==context.colIdx||selection.row!==context.rowIdx)){sm.selectByPosition({row:context.rowIdx,column:context.colIdx})}ed.startEdit(me.getCell(record,columnHeader),value);me.editing=true;me.scroll=me.grid.getScroll()},getCell:function(record,column){return this.grid.getCell(record,column)},getEditingContext:function(record,columnHeader){var me=this,grid=me.grid,dataTable=grid.getStore(),rowIdx,colIdx;columnHeader=z.isNumber(columnHeader)?grid._columns[columnHeader]:columnHeader;if(!columnHeader){return}colIdx=columnHeader._index;if(z.isNumber(record)){rowIdx=record;record=dataTable.getDataRow(record-1)}else{rowIdx=record.getIndex()+1}return{grid:grid,record:record,field:columnHeader.field,value:record.get(columnHeader.field),row:grid._rows[rowIdx-grid.headerRowsLength],column:columnHeader,rowIdx:rowIdx,colIdx:colIdx}},cancelEdit:function(){var me=this,activeEd=me.getActiveEditor(),viewEl;if(activeEd){viewEl=me.grid.el.rows[me.grid.getStore().indexOf(me.getActiveRecord())+me.grid.headerRowsLength].cells[me.getActiveColumn()._index]}me.setActiveEditor(null);me.setActiveColumn(null);me.setActiveRecord(null);if(activeEd){activeEd.cancelEdit();viewEl.focus();me.editing=false;me.fireEvent("canceledit",me,me.context)}},completeEdit:function(){var activeEd=this.getActiveEditor();if(activeEd){activeEd.completeEdit();this.editing=false}},setActiveEditor:function(ed){this.activeEditor=ed},getActiveEditor:function(){return this.activeEditor},setActiveColumn:function(column){this.activeColumn=column},getActiveColumn:function(){return this.activeColumn},setActiveRecord:function(record){this.activeRecord=record},getActiveRecord:function(){return this.activeRecord},getEditor:function(record,column){var me=this,editors=me.editors,editorId=column._id,editor=editors.get(editorId);if(editor){return editor}else{editor=column.getEditor(record);if(!editor){return false}if(!(editor instanceof z.DataGrid.CellEditor)){editor=new z.DataGrid.CellEditor({id:editorId,parentEl:me.grid.outerEl,fieldEditor:editor,ownerCt:me.grid})}else{editor.ownerCt=me.grid}editor.editingPlugin=me;editor.isForTree=me.grid.isTree;editor.on("specialkey",me.onSpecialKey,me);editor.on("complete",me.onEditComplete,me);editor.on("canceledit",me.cancelEdit,me);editors.add(editorId,editor);return editor}},onSpecialKey:function(ed,field,e){var me=this,grid=me.grid,sm;if(e.keyCode===z.Event.keys.tab){e.stopPropagation();e.preventDefault();if(ed){ed.onEditorTab(e)}sm=grid.getSelectionModel();if(sm.onEditorTab){sm.onEditorTab(me,e)}}},onEditComplete:function(ed,value,startValue,label){console.log(453,"onEditComplete");var me=this,grid=me.grid,activeColumn=me.getActiveColumn(),sm=grid.getSelectionModel(),record;if(activeColumn){record=me.context.record;me.setActiveEditor(null);me.setActiveColumn(null);me.setActiveRecord(null);if(!me.validateEdit()){return}if(value!=startValue){record.set(activeColumn.field,value);if(label!==undefined&&activeColumn.field1){record.set(activeColumn.field1,label)}record.modified=true;me.grid.onRecordUpdate(record,"edit",activeColumn)}if(sm.setCurrentPosition){sm.setCurrentPosition(sm.getCurrentPosition())}me.context.value=value;me.fireEvent("edit",me,me.context)}},validateEdit:function(){var me=this,context=me.context;return me.fireEvent("validateedit",me,context)!==false&&!context.cancel},startEditByPosition:function(position){console.log("startEditByPosition",position.row,position.column);return this.startEdit(position.row,position.column)},destroy:function(){var me=this;me.editors.each(function(editor){editor.destroy()});me.editors.clear();for(var i=0;i<me.grid._columns.length;i++){delete me.grid._columns[i].editor;delete me.grid._columns[i].getEditor;delete me.grid._columns[i].setEditor}delete me.grid.editingPlugin;delete me.grid}});RowEditing=function(config){var me=this;z.Observable(this);me.addEvents("beforeedit","edit","validateedit","canceledit");me.editors=new z.DataCollection()};z.mix(RowEditing.prototype,{ptype:"DataGrid.plugin.RowEditing",clicksToEdit:2,triggerEvent:undefined,initEvents:CellEditing.prototype.initEvents,initFieldAccessors:CellEditing.prototype.initFieldAccessors,onCellClick:CellEditing.prototype.onCellClick,getEditingContext:CellEditing.prototype.getEditingContext,beforeEdit:CellEditing.prototype.beforeEdit,getColumnField:CellEditing.prototype.getColumnField,init:function(grid){var me=this;me.grid=grid;me.grid.on("afterRender",function(e){me.initEvents();me.initFieldAccessors()});me.on("beforeedit",function(){me.grid.fireEvent.apply(me.grid,["beforeedit"].concat(Array.prototype.slice.apply(arguments)))});me.on("edit",function(){me.grid.fireEvent.apply(me.grid,["edit"].concat(Array.prototype.slice.apply(arguments)))});me.on("validateedit",function(){me.grid.fireEvent.apply(me.grid,["validateedit"].concat(Array.prototype.slice.apply(arguments)))});me.on("canceledit",function(){me.grid.fireEvent.apply(me.grid,["canceledit"].concat(Array.prototype.slice.apply(arguments)))});me.grid.selType="RowModel";me.grid.isEditable=true;me.grid.editingPlugin=me},startEdit:function(record,columnHeader){var me=this,editor=me.getEditor();var context=me.getEditingContext(record,columnHeader);if(context==null||me.beforeEdit(context)===false||me.fireEvent("beforeedit",me,context)===false||context.cancel||!me.grid.isVisible(true)){return false}if((editor.beforeEdit()!==false)){me.context=context;me.editing=true;editor.startEdit(me.context.record,me.context.column);return true}return false},cancelEdit:function(){var me=this;if(me.editing){me.getEditor().cancelEdit();me.editing=false;me.fireEvent("canceledit",me,me.context)}},completeEdit:function(){var me=this;if(me.editing&&me.validateEdit()){me.editing=false;me.fireEvent("edit",me,me.context)}},validateEdit:function(){var me=this,editor=me.editor,context=me.context,record=context.record,newValues={},originalValues={},editors=editor.items,e,eLen=editors.size(),name,item;for(e=0;e<eLen;e++){item=editors.getAt(e);name=item.name;newValues[name]=item.getValue();originalValues[name]=record.get(name)}z.mix(context,{newValues:newValues,originalValues:originalValues});if(me.fireEvent("validateedit",me,context)!==false&&!context.cancel){return me.getEditor().completeEdit()}return false},getEditor:function(){var me=this;if(!me.editor){me.editor=me.initEditor()}return me.editor},initEditor:function(){var me=this,grid=me.grid,headerCt=grid.headerCt,btns=["saveBtnText","cancelBtnText","errorsText","dirtyText"],b,bLen=btns.length,cfg={autoCancel:me.autoCancel,errorSummary:me.errorSummary,fields:grid.getGridColumns(true),hidden:true,editingPlugin:me,renderTo:me.grid.outerEl},item;for(b=0;b<bLen;b++){item=btns[b];if(typeof me[item]!=="undefined"){cfg[item]=me[item]}}return new z.DataGrid.RowEditor(cfg)},initEditTriggers:function(){var me=this,view=me.view,moveEditorEvent=me.clicksToMoveEditor===1?"click":"dblclick";CellEditing.prototype.initEditTriggers.call(this);if(me.clicksToMoveEditor!==me.clicksToEdit){me.grid.on("cell"+moveEditorEvent,me.moveEditorByClick,me)}},startEditByClick:function(){var me=this;if(!me.editing||me.clicksToMoveEditor===me.clicksToEdit){me.callParent(arguments)}},moveEditorByClick:function(){var me=this;if(me.editing){me.superclass.onCellClick.apply(me,arguments)}},setColumnField:function(column,field){var me=this,editor=me.getEditor();editor.removeField(column);if(z.isObject(field)&&!field.isFormField){field=new z.fieldEditor[field.type||"Text"](field)}column.field=field;me.getEditor().setField(column)}});z.DataGrid.plugin=z.DataGrid.plugin||{};z.DataGrid.plugin.CellEditing=CellEditing;z.DataGrid.plugin.RowEditing=RowEditing})();(function(){var b=window.Zving,a;a=function(c){a.superclass.constructor.call(this,c)};b.Class.extend(a,b.UICompBase,{ctype:"DataGrid.RowEditor",cls:"dg-row-editor",bodyCls:"dg-row-editor-body",saveBtnText:b.Lang.get("Common.OK"),cancelBtnText:b.Lang.get("Common.Cancel"),errorsText:"错误",dirtyText:"你需要提交或取消修改",initComponent:function(){var c=this;c.columns=new b.DataCollection();c.columns.getKey=function(e){var d;if(e.getEditor){d=e.getEditor();if(d){return d.id}}return e.id};c.initItems();if(c.fields){c.setField(c.fields);delete c.fields}c.form=c.createForm()},initItems:function(){var d=this;d.form=d.createForm();var c=d.items;d.items=new b.DataCollection()},createForm:function(){var g=this;var d={},f=this.basicFormConfigs||[],c=f.length,e=0,h;for(;e<c;++e){h=f[e];d[h]=this[h]}return new b.form.Basic(this,d)},getForm:function(){return this.form},onFieldChange:function(){var e=this,d=e.getForm(),c=d.isValid();if(e.errorSummary&&e.isVisible()){e[c?"hideToolTip":"showToolTip"]()}e.updateButton(c);e.isValid=c},updateButton:function(d){var c=this.floatingButtons;if(c){console.log(".update",c.$el.find(".update"));c.$el.find(".update")[!d?"disable":"enable"]()}},initContent:function(){var c=this.getContentEl();Node.addClass(c,this.bodyCls);this.doRenderItems()},doRenderItems:function(){var c=this.items;var e=this.getContentEl();var h=c.size();if(!e.firstChild||e.firstChild.tagName!=="TABLE"){e.innerHTML='<table width="100%"><tr>'+(new Array(h+1).join("<td></td>"))+"</tr></table>"}var d=e.firstChild.rows[0].cells;for(var f=0;f<c.size();f++){var g=c.getAt(f);if(!g.rendered){g.render(d[f])}}},afterRender:function(){var d=this,c=d.editingPlugin;a.superclass.afterRender.call(this);$(d.renderTo).on("scroll",function(){if(d.scrollTimer){clearTimeout(d.scrollTimer)}d.scrollTimer=setTimeout(function(){d.onCtScroll()},100)});d.$el.on("click",function(e){e.stopPropagation()});d.$el.on("keypress",function(e){d.fireEvent("keypress",e)});d.$el.on("keydown",function(e){d.fireEvent("keydown",e)});d.$el.on("keydown",function(e){if(e.keyCode==b.Event.keys.enter){c.completeEdit(e);e.stopPropagation();e.preventDefault()}else{if(e.keyCode==b.Event.keys.esc){c.onEscKey(e);e.preventDefault()}}});c.on("refresh",d.onViewRefresh,d);c.on("itemremove",d.onViewItemRemove,d)},onViewRefresh:function(c){console.log("onViewRefresh",c);this.editingPlugin.cancelEdit()},onViewItemRemove:function(c,d){console.log("onViewItemRemove",c,d);var e=this.context;if(e&&c===e.record){this.editingPlugin.cancelEdit()}},onCtScroll:function(g,f){var c=this,d=f.scrollTop,h=f.scrollLeft;if(d!==c.lastScrollTop){c.lastScrollTop=d;if((c.tooltip&&c.tooltip.isVisible())||c.hiddenTip){c.repositionTip()}}if(h!==c.lastScrollLeft){c.lastScrollLeft=h;c.reposition()}},getFloatingButtons:function(){var f=this,e=f.editingPlugin,d;if(!f.floatingButtons){d=f.floatingButtons=new b.Layer({width:200,cls:"dg-row-editor-buttons",renderTo:f.el});d.show();d.items=[];var c=new b.Button({id:"_rowEditor_btn_ok",cmpCls:"update",handler:e.completeEdit,scope:e,text:f.saveBtnText,renderTo:d.el});d.items.push(c);c=new b.Button({id:"_rowEditor_btn_cancel",handler:e.cancelEdit,scope:e,text:f.cancelBtnText,renderTo:d.el});d.$el.on("mousedown click",function(g){g.stopPropagation();g.preventDefault()})}return f.floatingButtons},reposition:function(s){var u=this,e=u.context,g=e&&e.row,t=g&&g.el,q=u.getFloatingButtons(),r=q.el,c=u.editingPlugin.grid,d=c.dom.body,p=c.dom.body.offsetWidth,w=c.dom.body.scrollWidth,m=Math.min(p,w),o=c.dom.body.scrollLeft,j=q.el.offsetWidth,f=(m-j)/2+o,k,h,n;if(t&&b.isElement(t)){Node.scrollIntoView(t,d,false);k=t.offsetTop;h=t.offsetHeight;n=h+(u.editingPlugin.grid.rowLines?9:10);if(u.el.clientHeight!=n){u.el.style.height=n+"px";u.el.style.left=0}u.el.style.top=k+"px";Node.scrollIntoView(r,d,false)}if(u.el.clientWidth!=p){u.el.style.width=p+"px"}if(r.style.left!==f+"px"){r.style.left=f+"px"}},getEditor:function(c){var d=this;if(b.isNumber(c)){var e=[];d.items.each(function(f){if(f.isFormField){e.push(f)}});return e[c]}else{if(c.isHeader&&!c.isGroupHeader){return c.getEditor()}}},removeField:function(d){var c=this;d=c.getEditor(d);d.removeListener("validitychange",c.onValidityChange,c);c.columns.remove(d.id);d.destroy()},setField:function(d){var g=this,c,f,e;if(b.isArray(d)){f=d.length;for(c=0;c<f;c++){g.setField(d[c])}return}e=d.getEditor(null,{type:"Label",getModelData:function(){return null}});e.margins="0 0 0 2";e.on("change",g.onFieldChange,g);if(g.isVisible()&&g.context){if(e.is("Label")){g.renderColumnData(e,g.context.record,d)}else{e.suspendEvents();e.setValue(g.context.record.get(d.dataIndex));e.resumeEvents()}}g.columns.add(e.id,d);g.onFieldAdd(g.columns,e.id,d);if(d.hidden){g.onColumnHide(d)}else{g.onColumnShow(d)}},onColumnShow:function(c){var d=c.getEditor();d.setWidth(c.el.offsetWidth-2);d.show()},repositionIfVisible:function(){var c=this;if(c.isVisible()){c.reposition()}},onFieldAdd:function(g,c,d){var e=this,h,f;if(!d.isGroupHeader){h=d._index;f=d.getEditor({type:"Label"});e.items.add(f.id,f)}},loadRecord:function(d){var j=this,h=j.getForm(),c=h.getFields(),g=c.length,f,e,k;for(f=0;f<g;f++){c[f].suspendEvents()}h.loadRecord(d);for(f=0;f<g;f++){c[f].resumeEvents()}k=h.isValid();if(j.errorSummary){if(k){j.hideToolTip()}else{j.showToolTip()}}j.updateButton(k);e=[];j.items.each(function(m){if(m.isLabel){e.push(m)}});g=e.length;for(f=0;f<g;f++){j.renderColumnData(e[f],d)}},renderColumnData:function(o,k,e){var n=this,c=n.editingPlugin.grid,g=c.headerCt,q=c.store,h=e||n.columns.get(o.id),p=k.get(h.dataIndex),m=h.editRenderer||h.renderer,d,f,j;if(m){d={tdCls:"",style:""};f=q.indexOf(k);j=g.getHeaderIndex(h);p=m.call(h.scope||g.ownerCt,p,d,k,f,j,q)}o.setRawValue(p);o.resetOriginalValue()},beforeEdit:function(){var c=this;if(c.isVisible()&&c.errorSummary&&!c.autoCancel&&c.isDirty()){c.showToolTip();return false}},startEdit:function(c,h){var g=this,f=g.editingPlugin.grid,d=f.getStore(),e=g.context=b.mix(g.editingPlugin.context,{view:f,store:d});e.grid.getSelectionModel().select(c);g.loadRecord(c);if(!g.isVisible()){g.show();g.focusContextCell()}else{g.reposition({callback:this.focusContextCell})}},focusContextCell:function(){var c=this.getEditor(this.context.colIdx);if(c&&c.focus){c.focus()}},cancelEdit:function(){var h=this,g=h.getForm(),c=g.getFields(),d=c.items,f=d.length,e;h.hide();g.clearInvalid();for(e=0;e<f;e++){d[e].suspendEvents()}g.reset();for(e=0;e<f;e++){d[e].resumeEvents()}},completeEdit:function(){var d=this,c=d.getForm();if(!c.isValid()){return}c.updateRecord(d.context.record);d.hide();return true},onShow:function(){this.reposition()},onHide:function(){var c=this;if(c.tooltip){c.hideToolTip()}if(c.context){c.context.view.focus();c.context=null}},isDirty:function(){var d=this,c=d.getForm();return c.isDirty()},getToolTip:function(){return this.tooltip||(this.tooltip=new b.Tip())},hideToolTip:function(){var c=this,d=c.getToolTip();if(d.rendered){d.disable()}c.hiddenTip=false},showToolTip:function(){var e=this,f=e.getToolTip(),c=e.context,g=b.getDom(c.row),d=c.grid.view.el;f.targetEl=g;f.showAt([-10000,-10000]);f.update(e.getErrors());f.mouseOffset=[d.getWidth()-g.getWidth()+e.lastScrollLeft+15,0];e.repositionTip();f.doLayout();f.enable()},repositionTip:function(){var k=this,m=k.getToolTip(),e=k.context,o=Ext.get(e.row),n=e.grid.view.el,g=n.getHeight(),h=k.lastScrollTop,j=h+g,d=o.getHeight(),c=o.dom.offsetTop,f=c+d;if(f>h&&c<j){m.show();k.hiddenTip=false}else{m.hide();k.hiddenTip=true}},getErrors:function(){var e=this,g=!e.autoCancel&&e.isDirty()?e.dirtyText+"<br />":"",j=[];var f=[];e.items.each(function(k){if(k.isFormField){f.push(k)}});var d=f.length;function h(k){return"<li>"+k+"</li>"}for(var c=0;c<d;c++){j=j.concat(Array.map(f[c].getErrors(),h))}return g+"<ul>"+j.join("")+"</ul>"},beforeDestroy:function(){this.tooltip.destroy();delete this.tooltip}});b.DataGrid.RowEditor=a})();(function(){var a=window.Zving;CellModel=function(b){var d=this;a.Observable(this);d.addEvents("deselect","select");d.modes={SINGLE:true,SIMPLE:true,MULTI:true};d.noSelection={row:-1,column:-1};d.setSelectionMode(b.mode||d.mode);d.selectedDataCollection=new a.DataCollection();var c=CellModel.prototype.Selection=function(e){this.model=e};c.prototype.setPosition=function(h,e){var g=this,f;if(arguments.length===1){if(h.grid){g.grid=f=h.grid}e=h.column;h=h.row}if(!f){g.grid=f=g.model.primaryGrid}if(typeof h==="number"){g.row=h;g.record=f.getStore().getDataRow(h-1)}else{if(h.getAt){g.record=h;g.row=f.indexOf(h)}else{if(h.tagName){g.record=f.getRecord(h);g.row=h.rowIndex}}}if(typeof e==="number"){g.column=e;g.columnHeader=f.getHeaderAtIndex(e)}else{g.columnHeader=e;g.column=e._index}return g}};a.mix(CellModel.prototype,{isCellModel:true,enableKeyNav:true,bindComponent:function(b){var c=this;c.grid=b;c.primaryGrid=b;c.$grid=c.grid.dom.$body;c.$grid.prop("tabIndex",-1);if(c.enableKeyNav){c.grid.on("afterRender",function(d){c.initKeyNav()})}b.on("cellmousedown",c.onMouseDown,c);b.on("refresh",c.onViewRefresh,c)},initKeyNav:function(b){var c=this;c.$grid.on("keydown",function(d){var e=d.target;if(e&&e.tagName&&/select|input|textare/i.test(e.tagName)&&!e.disabled){return}if(d.ctrlKey==true){return true}if(d.keyCode==a.Event.keys.up){c.move("up",d)}else{if(d.keyCode==a.Event.keys.down){c.move("down",d)}else{if(d.keyCode==a.Event.keys.left){c.move("left",d)}else{if(d.keyCode==a.Event.keys.right){c.move("right",d)}else{if(d.keyCode==a.Event.keys.tab){c.onKeyTab(d)}}}}}if(d.keyCode!=a.Event.keys.esc){d.stopPropagation()}d.preventDefault()})},move:function(b,f){var d=this,g=d.getCurrentPosition();var c=g.grid.walkCells(g,b,f,d.preventWrap);if(c){c.grid=g.grid;return d.setCurrentPosition(c)}return null},getCurrentPosition:function(){return this.selection},setCurrentPosition:function(c){var b=this;b.lastSelection=b.selection;if(b.selection){b.onCellDeselect(b.selection)}if(c){b.nextSelection=new b.Selection(b);b.nextSelection.setPosition(c);b.onCellSelect(b.nextSelection);b.selection=b.nextSelection;return b.selection}},selectByPosition:function(b){this.setCurrentPosition(b)},onMouseDown:function(f,b,d,c,h,j,g){this.setCurrentPosition({grid:f,row:j,column:d})},onCellSelect:function(b,c){if(b&&b.row!==undefined&&b.row>-1){this.doSelect(b.row,false,c)}},onCellDeselect:function(b,c){if(b&&b.row!==undefined){this.doDeselect(b.row,c)}},select:function(c,d,b){if(typeof c!=="undefined"){this.doSelect(c,d,b)}},doSelect:function(d,f,c){var e=this,b;if(e.locked||!e.grid.getStore()){return}if(typeof d==="number"){d=[e.grid.getStore().getDataRow(d-e.grid.headerRowsLength)]}if(e.selectionMode=="SINGLE"&&d){b=d.length?d[0]:d;e.doSingleSelect(b,c)}else{e.doMultiSelect(d,f,c)}},doDeselect:function(c,k){var j=this,b=j.selectedDataCollection,e=0,h,f,m=0,g=0;if(j.locked||!j.grid.getStore()){return false}if(typeof c==="number"){c=[j.grid.getStore().getDataRow(c-j.grid.headerRowsLength)]}else{if(!a.isArray(c)){c=[c]}}function d(){++g;b.remove(String(f.get(j.grid.uniqueField)))}h=c.length;for(;e<h;e++){f=c[e];if(j.isSelected(f)){if(j.lastSelected==f){j.lastSelected=b.last()}++m;j.onSelectChange(f,false,k,d)}}j.maybeFireSelectionChange(g>0&&!k);return g===m},selectAll:function(c){var f=this,e=f.grid.getStore().Rows,d=0,b=e.length,g=f.getSelection().length;f.bulkChange=true;for(;d<b;d++){f.doSelect(e[d],true,c)}delete f.bulkChange;f.maybeFireSelectionChange(f.getSelection().length!==g)},deselectAll:function(c){var f=this,e=f.getSelection(),d=0,b=e.length,g=f.getSelection().length;f.bulkChange=true;for(;d<b;d++){f.doDeselect(e[d],c)}delete f.bulkChange;f.maybeFireSelectionChange(f.getSelection().length!==g)},isSelected:function(b){b=a.isNumber(b)?this.grid.getStore().getDataRow(b):b;return this.selectedDataCollection.indexOf(b)!==-1},onSelectChange:function(b,e,d,h){var g=this,j,c,f;if(e){j=g.nextSelection;c="select"}else{j=g.lastSelection||g.noSelection;c="deselect"}console.log("onSelectChange",j.grid,g.primaryGrid);f=j.grid||g.primaryGrid;if((d||g.fireEvent("before"+c,g,b,j.row,j.column))!==false&&h()!==false){if(e){f.onCellSelect(j);f.onCellFocus(j)}else{f.onCellDeselect(j);delete g.selection}if(!d){g.fireEvent(c,g,b,j.row,j.column)}}},doSingleSelect:function(c,d){var e=this,g=false,b=e.selectedDataCollection;if(e.locked){return}if(e.isSelected(c)){return}function f(){e.bulkChange=true;if(b.size()>0&&e.doDeselect(e.lastSelected,d)===false){delete e.bulkChange;return false}delete e.bulkChange;b.add(String(c.get(e.grid.uniqueField)),c);e.lastSelected=c;g=true}e.onSelectChange(c,true,d,f);if(g){if(!d){e.setLastFocused(c)}e.maybeFireSelectionChange(!d)}},doMultiSelect:function(c,m,k){var h=this,b=h.selectedDataCollection,j=false,e=0,g,f;if(h.locked){return}c=!a.isArray(c)?[c]:c;g=c.length;if(!m&&b.size()>0){if(h.doDeselect(h.getSelection(),k)===false){return}}function d(){b.add(String(f.get(h.grid.uniqueField)),f);j=true}for(;e<g;e++){f=c[e];if(m&&h.isSelected(f)){continue}h.lastSelected=f;h.onSelectChange(f,true,k,d)}if(!h.preventFocus){h.setLastFocused(f,k)}h.maybeFireSelectionChange(j&&!k)},maybeFireSelectionChange:function(b){var c=this;if(b&&!c.bulkChange){c.fireEvent("selectionchange",c,c.getSelection())}},setLastFocused:function(d,c){var e=this,b=e.lastFocused;e.lastFocused=d;if(d!==b){this.fireEvent("focuschange",this,b,d)}},getLastSelected:function(){return this.lastSelected},onKeyTab:function(g,c){var d=this;console.log(884,d.getCurrentPosition());var b=d.getCurrentPosition().editingPlugin;var f=g.shiftKey?"left":"right";if(b&&d.wasEditing){d.onEditorTab(b,g)}else{d.move(f,g)}},onEditorTab:function(c,g){var d=this,f=g.shiftKey?"left":"right",b=d.move(f,g);if(b){if(c.startEditByPosition(b)){d.wasEditing=false}else{d.wasEditing=true;if(!b.columnHeader.field){d.onEditorTab(c,g)}}}},onViewRefresh:function(c){var d=this,f=d.getCurrentPosition(),b,e;console.log("TODO: 实现刷新后再次选上")},getSelection:function(){return this.selectedDataCollection.getValues()},getSelectionMode:function(){return this.selectionMode},setSelectionMode:function(b){b=b?b.toUpperCase():"SINGLE";this.selectionMode=this.modes[b]?b:"SINGLE"}});RowModel=function(b){var c=this;a.Observable(this);c.addEvents("beforedeselect","beforeselect","deselect","select");c.modes={SINGLE:true,SIMPLE:true,MULTI:true};c.noSelection={row:-1,column:-1};c.setSelectionMode(b.mode||c.mode);c.selectedDataCollection=new a.DataCollection()};a.mix(RowModel.prototype,{mode:"MULTI",isRowModel:true,enableKeyNav:true,doSelect:CellModel.prototype.doSelect,doDeselect:CellModel.prototype.doDeselect,selectAll:CellModel.prototype.selectAll,deselectAll:CellModel.prototype.deselectAll,doSingleSelect:CellModel.prototype.doSingleSelect,doMultiSelect:CellModel.prototype.doMultiSelect,select:CellModel.prototype.select,isSelected:CellModel.prototype.isSelected,maybeFireSelectionChange:CellModel.prototype.maybeFireSelectionChange,getLastSelected:CellModel.prototype.getLastSelected,bindComponent:function(b){var c=this;c.grid=b;c.primaryGrid=b;c.$grid=c.grid.dom.$body;c.$grid.prop("tabIndex",-1);if(c.enableKeyNav){c.grid.on("afterRender",function(d){c.initKeyNav()})}b.on("rowmousedown",c.onRowMouseDown,c);b.on("checkermousedown",c.onCheckerMouseDown,c);b.on("rowclick",c.onRowClick,c);b.on("refresh",c.onViewRefresh,c)},initKeyNav:function(b){var c=this;c.grid.on("itemkeydown",function(f,e,h,j,d){var g=d.target;if(g&&g.tagName&&/select|input|textare/i.test(g.tagName)&&!g.disabled){return}d.record=e;d.rowIndex=j;if(d.ctrlKey==true){return true}if(d.keyCode==a.Event.keys.up){c.onKeyUp(d)}else{if(d.keyCode==a.Event.keys.down){c.onKeyDown(d)}else{if(d.keyCode==a.Event.keys.space){c.onKeySpace(d)}else{if(d.keyCode==a.Event.keys.enter){c.onKeyEnter(d)}}}}if(d.keyCode!=a.Event.keys.esc){d.stopPropagation()}d.preventDefault()})},onKeySpace:function(d){var c=this,b=c.lastFocused;if(b){if(c.isSelected(b)){c.doDeselect(b,false)}else{c.doSelect(b,true)}}},onKeyEnter:a.noopFn,onKeyUp:function(f){var d=this;var b=d.grid.getStore().indexOf(d.lastFocused);var c;if(b>0){c=d.grid.getStore().getDataRow(b-1);if(f.shiftKey&&d.lastFocused){if(d.isSelected(d.lastFocused)&&d.isSelected(c)){d.doDeselect(d.lastFocused,true);d.setLastFocused(c)}else{if(!d.isSelected(d.lastFocused)){d.doSelect(d.lastFocused,true);d.doSelect(c,true)}else{d.doSelect(c,true)}}}else{if(f.ctrlKey){d.setLastFocused(c)}else{d.doSelect(c)}}}},onKeyDown:function(f){var d=this;var b=d.grid.getStore().indexOf(d.lastFocused);var c;if(b+1<d.grid.getStore().getRowCount()){c=d.grid.getStore().getDataRow(b+1);if(d.selectedDataCollection.size()===0){if(!f.ctrlKey){d.doSelect(c)}else{d.setLastFocused(c)}}else{if(f.shiftKey&&d.lastFocused){if(d.isSelected(d.lastFocused)&&d.isSelected(c)){d.doDeselect(d.lastFocused,true);d.setLastFocused(c)}else{if(!d.isSelected(d.lastFocused)){d.doSelect(d.lastFocused,true);d.doSelect(c,true)}else{d.doSelect(c,true)}}}else{if(f.ctrlKey){d.setLastFocused(c)}else{d.doSelect(c)}}}}},onRowMouseDown:function(c,b,g,d,h){var f=this;if(h.button!==2||!this.isSelected(b)){this.selectWithEvent(b,h)}},onCheckerMouseDown:function(c,b,g,d,h){var f=this,j;if(h.button!==2){j=f.getSelectionMode();if(j!=="SINGLE"){f.setSelectionMode("SIMPLE")}f.selectWithEvent(b,h);f.setSelectionMode(j)}},onRowClick:function(c,b,f,d,g){},selectWithEvent:function(b,f,d){var c=this;switch(c.selectionMode){case"MULTI":if(f.ctrlKey&&c.isSelected(b)){c.doDeselect(b,false)}else{if(f.shiftKey&&c.lastFocused){c.selectRange(c.lastFocused,b,f.ctrlKey)}else{if(f.ctrlKey){c.doSelect(b,true,false)}else{if(c.isSelected(b)&&!f.shiftKey&&!f.ctrlKey&&c.selectedDataCollection.size()>1){c.doSelect(b,d,false)}else{c.doSelect(b,false)}}}}break;case"SIMPLE":if(c.isSelected(b)){c.doDeselect(b)}else{c.doSelect(b,true)}break;case"SINGLE":if(c.allowDeselect&&c.isSelected(b)){c.doDeselect(b)}else{c.doSelect(b,false)}break}},selectRange:function(m,f,n,d){var j=this,k=j.grid.getStore(),e=0,h,g,b,c=[];if(j.locked){return}if(!n){j.deselectAll(true)}if(!a.isNumber(m)){m=k.indexOf(m-j.grid.headerRowsLength)}if(!Ext.isNumber(f)){f=k.indexOf(f-j.grid.headerRowsLength)}if(m>f){g=f;f=m;m=g}for(h=m;h<=f;h++){if(j.isSelected(k.getDataRow(h))){e++}}if(!d){b=-1}else{b=(d=="up")?m:f}for(h=m;h<=f;h++){if(e==(f-m+1)){if(h!=b){j.doDeselect(h,true)}}else{c.push(k.getAt(h))}}j.doMultiSelect(c,true)},onSelectChange:function(f,e,k,b){var h=this,c=h.gird||h.primaryGrid,j=c.getStore(),d=j.indexOf(f)+c.headerRowsLength,g=e?"select":"deselect";if((k||h.fireEvent("before"+g,h,f,d))!==false&&b()!==false){if(e){c.onRowSelect(d,k)}else{c.onRowDeselect(d,k)}if(!k){h.fireEvent(g,h,f,d)}}},getCurrentPosition:function(){var b=this.selectedDataCollection.getAt(0);if(b){return{row:b.getIndex(),column:0}}},selectByPosition:function(b){this.doSelect(b)},setLastFocused:function(d,c){var e=this,b=e.lastFocused;e.lastFocused=d;if(d!==b){this.fireEvent("focuschange",this,b,d)}},onKeyTab:function(g,c){var d=this;console.log(884,d.getCurrentPosition());var b=d.getCurrentPosition().editingPlugin;var f=g.shiftKey?"left":"right";if(b&&d.wasEditing){d.onEditorTab(b,g)}else{d.move(f,g)}},onEditorTab:function(c,g){var d=this,f=g.shiftKey?"left":"right",b=d.move(f,g);if(b){if(c.startEditByPosition(b)){d.wasEditing=false}else{d.wasEditing=true;if(!b.columnHeader.field){d.onEditorTab(c,g)}}}},onViewRefresh:function(c){var d=this,f=d.getCurrentPosition(),b,e;console.log("TODO 实现刷新后再次选上")},getSelection:function(){return this.selectedDataCollection.getValues()},getSelectionMode:function(){return this.selectionMode},setSelectionMode:function(b){b=b?b.toUpperCase():"SINGLE";this.selectionMode=this.modes[b]?b:"SINGLE"}});a.selection=a.selection||{};a.selection.RowModel=RowModel;a.selection.CellModel=CellModel})();(function(){var d=window.Zving,b=d.Node,c=d.Lang,a;a=function(e){var f=this;f.offsets=[-1,-1];d.mix(this,e);d.Observable(this);f.initComponent()};d.Class.extend(a,d.UICompBase,{ctype:"DataGrid.CellEditor",value:"",cls:"z-celleditor",alignment:"lt",hideEl:false,allowBlur:true,revertInvalid:true,swallowKeys:true,completeOnEnter:true,cancelOnEsc:true,initComponent:function(){var f=this,e=f.fieldEditor;if(!e){e=f.fieldEditor=new d.fieldEditor.Text(f.fieldEditor)}e.inEditor=true;e.on("blur",function(){setTimeout(function(){f.onFieldBlur()},10)});e.on("specialkey",f.onSpecialKey,f);f.items=[e];f.addEvents("beforestartedit","startedit","beforecomplete","complete","canceledit","specialkey")},afterRender:function(){var f=this,e=f.fieldEditor,g=e.inputEl;this.el.style.position="absolute";a.superclass.afterRender.apply(this);f.finishRenderChildren();e.inputEl.name="";if(f.swallowKeys){e.$inputEl.on("keypress keydown",function(h){h.stopPropagation()})}if(e.ctype=="fieldEditor.Checkbox"){e.$inputEl.on("mousedown",function(h){f.onCheckBoxMouseDown(h)});e.$inputEl.on("click",function(h){f.onCheckBoxClick(h)})}},finishRenderChildren:function(){this.finishRenderItems(this.el,this.items)},finishRenderItems:function(g,e){for(var f=0;f<e.length;f++){e[f].render(g,f)}},onCheckBoxMouseDown:function(){this.completeEdit=d.noopFn},onCheckBoxClick:function(){delete this.completeEdit;this.fieldEditor.focus(false,10)},onSpecialKey:function(k,j){var h=this,f=j.keyCode,e=h.completeOnEnter&&f==d.Event.keys.enter,g=h.cancelOnEsc&&f==d.Event.keys.esc;if(e||g){j.preventDefault();setTimeout(function(){if(e){h.completeEdit()}else{h.cancelEdit()}if(k.triggerBlur){k.triggerBlur(j)}},10)}h.fireEvent("specialkey",h,k,j)},startEdit:function(e,h){var g=this,f=g.fieldEditor;g.completeEdit();g.boundEl=d.getDom(e);g.$boundEl=$(g.boundEl);h=typeof h!=="undefined"?h:d.String.trim(g.boundEl.innerText||g.boundEl.innerHTML);if(!g.rendered){g.render(g.parentEl||document.body)}if(g.fireEvent("beforestartedit",g,g.boundEl,h)!==false){g.startValue=h;g.show();f.suspendEvents();f.reset();f.setValue(h);f.resumeEvents();g.realign(true);f.focus(false,10);if(f.autoSize){f.autoSize()}g.editing=true}},realign:function(e){var j=this,g=j.boundEl,h=d.Array.clone(j.offsets),f;f=g.offsetWidth-5;if(e===true){j.fieldEditor.setWidth(f)}j.alignTo(g,j.alignment,h)},alignTo:function(g,m,j){var h=this,f=h.ownerCt;var e=g.offsetLeft+f.dom.body.scrollLeft+j[0],k=g.offsetTop+f.dom.body.scrollTop+j[1];if(m=="lt"){b.setPosition(this.el,e,k)}},completeEdit:function(e){var h=this,g=h.fieldEditor,j;if(!h.editing){return}if(g.assertValue){g.assertValue()}j=h.getValue();var f;if(g.getLabel){f=g.getLabel()}if(!g.isValid()){if(h.revertInvalid!==false){h.cancelEdit(e)}return}if(String(j)===String(h.startValue)&&h.ignoreNoChange){h.hideEdit(e);return}if(h.fireEvent("beforecomplete",h,j,h.startValue)!==false){j=h.getValue();if(h.updateEl&&h.boundEl){h.boundEl.innerHTML=j}h.hideEdit(e);h.fireEvent("complete",h,j,h.startValue,f)}},cancelEdit:function(e){var h=this,f=h.startValue,g=h.fieldEditor,j;if(h.editing){j=h.getValue();g.suspendEvents();h.setValue(f);g.resumeEvents();h.hideEdit(e);h.fireEvent("canceledit",h,j,f)}},hideEdit:function(e){if(e!==true){this.editing=false;this.hide()}},onFieldBlur:function(j,h){var f=this,g;if(f.allowBlur===true&&f.editing&&f.selectSameEditor!==true){f.completeEdit()}if(h&&b.focusable(g=h.target)){g.focus()}},onHide:function(){var f=this,e=f.fieldEditor;if(f.editing){f.completeEdit();return}if(e.hasFocus){e.blur()}if(e.collapse){e.collapse()}if(f.hideEl!==false){f.boundEl.style.visibility="visible"}},onShow:function(){var e=this;if(e.hideEl!==false){e.boundEl.style.visibility="hidden"}e.fireEvent("startedit",e,e.boundEl,e.startValue)},onEditorTab:function(g){var f=this.fieldEditor;if(f.onEditorTab){f.onEditorTab(g)}},setValue:function(e){this.fieldEditor.setValue(e)},getValue:function(){return this.fieldEditor.getValue()},beforeDestroy:function(){var e=this;e.fieldEditor.destroy();delete e.fieldEditor;delete e.parentEl;delete e.boundEl}});d.DataGrid.CellEditor=a})();(function(){var c=window.Zving,b=c.getDom,a=c.Page,d;d=function(j,h){this.pos=h||"bottom";this.el=b(j);this.viewportH=Dom.getViewport().height;if(this.viewportH>=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)){return}if(this.el.tagName==="TD"){var f=document.createElement("div");var e=this.el.children;e=toArray(e);e.each(function(k){f.appendChild(k)});this.el.appendChild(f);this.el=b(f)}this.init();var g=this;$window.on("unload",function(){g.el=null;$window.off("scroll.afloat")})};d.prototype={init:function(){var e=this;this._position=this.el.currentStyle.position;var f=c.Node.getOffset(this.el);this.fixX=Math.round(f.x);this.fixY=Math.round(f.y);this._offsetWidth=this.el.offsetWidth;this._currentWidth=c.Node.getCurrentStyle(e.el,"width");this._width=this.el.style.width;this.fixHeight=this.el.offsetHeight;this.el.style.left=this.fixX+"px";$window.off("scroll.afloat").on("scroll.afloat",function(g){e.setPosition(g)})},setPosition:function(){if(this.fixY===0||this._offsetWidth===0){this.init()}var e=Math.max(document.body.scrollTop,document.documentElement.scrollTop);if((this.pos==="bottom"&&e+this.viewportH<this.fixY)||(this.pos==="top"&&e>this.fixY)){if(isIE6){this.el.style.position="absolute";this.el.style.top=this.pos==="bottom"?e+this.viewportH-this.fixHeight+"px":e+"px"}else{if(this.el.style.position!=="fixed"){this.el.style.position="fixed";this.el.style[this.pos]="0"}}if(this._offsetWidth){this.el.style.width=this._currentWidth}}else{this.el.style.position=this._position;this.el.style.width=this._width}}};c.Afloat=d})();
/*! Menu */
(function(){var d=window.Zving,b=d.isIE,a=d.Page;var c=function(){this.X=null;this.Y=null;this.Param=null;this.Items=[];this.Event=null};c.prototype.setEvent=function(e){var f=d.Event.getEventPosition(e);this.X=f.x;this.Y=f.y;this.Event=e};c.prototype.setPosition=function(e,f){this.X=e;this.Y=f};c.prototype.setParam=function(e){this.Param=e};c.prototype.addItem=function(h,g,f,e){this.Items.push([h,g,f,e])};c.prototype.onClick=function(e){if(!this.Items[e][3]){var f=this.Items[e][1];c.close();f.apply(this,[this.Param])}};c.prototype.getHtmlString=function(){var f=[];f.push("<html><head><style>");f.push("body {margin: 0px;background: #FFFFFF;color: #444444}");f.push("td {font-size: 12px;}");f.push(".imgdisabled img{opacity: 0.5; filter: gray Alpha(Opacity=50);}");f.push("</style></head><body>");f.push("<table border='0' id='_ContextMenu_Table' cellspacing='1' cellpadding='0' oncontextmenu='TopWindow.Zving.stopEvent(event);' onselectstart='TopWindow.Zving.stopEvent(event);' style='-moz-user-select:none;border:1px solid #8F8F73;background:#FFFFFF;'><tr><td>");for(var e=0;e<this.Items.length;e++){if(this.Items[e][0]==="-"){f.push("<table width='100%' border='0' cellspacing='0' cellpadding='0' height='1' style='padding-top:0px;padding-bottom:0px;height:1px; font-size:0px;background:#B9B99D;'><tr><td style='background:#D6DFF7; width:24px;' width='24'></td><td style='background:#B9B99D; width:66px;'></td></tr></table>");continue}if(true===this.Items[e][3]){f.push("<table width='100%' border='0' cellspacing='0' cellpadding='0' class='imgdisabled' style='font-size:12px'><tr>");if(this.Items[e][2]){f.push("<td height='22' width='24' align='center' valign='middle' style='background:#DDF;'><img src='"+CONTEXTPATH+this.Items[e][2]+"' hspace='2' vspace='1'/></td>")}else{f.push("<td height='22' width='24' align='center' valign='middle' style='background:#DDF;'><img src='"+CONTEXTPATH+"framework/images/blank.gif' hspace='2' vspace='1'/></td>")}f.push("<td style='background:#F7F8FD; color:#999999; padding-left:10px;' nowrap='true'>"+this.Items[e][0]+"</td>");f.push("<td style='background:#F7F8FD; width:15px; text-align:center' width='15'>&nbsp;</td>")}else{f.push("<table width='100%' border='0' cellspacing='0' cellpadding='0' style='cursor:pointer;font-size:12px' onclick='TopWindow.Zving.Menu.getInstance().onClick("+e+")' onmouseout='TopWindow.Zving.Menu.onMouseOut(this)' onmouseover='TopWindow.Zving.Menu.onMouseOver(this)'><tr>");if(this.Items[e][2]){f.push("<td height='22' width='24' align='center' valign='middle' style='background:#DDF;'><img src='"+CONTEXTPATH+this.Items[e][2]+"' hspace='2' vspace='1'/></td>")}else{f.push("<td height='22' width='24' align='center' valign='middle' style='background:#DDF;'><img src='"+CONTEXTPATH+"framework/images/blank.gif' hspace='2' vspace='1'/></td>")}f.push("<td style='background:#F7F8FD; padding-left:10px;cursor:pointer;' nowrap='true'>"+this.Items[e][0]+"</td>");f.push("<td style='background:#F7F8FD; width:15px; text-align:center' width='15'>&nbsp;</td>")}f.push("</tr></table>")}f.push("</td></tr></table>");f.push("<script>getDom = function(ele){return typeof ele == 'string' ? document.getElementById(ele) : ele;};window.init=function(){TopWindow.Zving.Menu.adjustSize();};<\/script></body></html>");return f.join("\n")};c.prototype.setPosition=function(){var n=Zving.rootWin;var e=n.Zving.getDom("_DivContextMenu");Node.show(e);var k=n.Zving.getDom("_ContextMenu_Frame").contentWindow;var p=k.getDom("_ContextMenu_Table").offsetHeight;var j=k.getDom("_ContextMenu_Table").offsetWidth;var g=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);var o=Math.max(document.documentElement.scrollTop,document.body.scrollTop);var h=0;var f=0;var m=d.Dom.computePosition(this.X,this.Y,this.X,this.Y,null,j,p,n);h=m.x+g;f=m.y+o;n.Zving.getDom("_DivContextMenu").style.width=j+"px";n.Zving.getDom("_DivContextMenu").style.height=p+"px";h=h<0?0:h;e.style.left=h+"px";e.style.top=f+"px"};c.prototype.show=function(){if(this.Items.length===0){return}var f=Zving.rootWin;var h;var e,g;if(!f.Zving.getDom("_DivContextMenu")){h=f.document.createElement("div");h.id="_DivContextMenu";h.style.position="absolute";h.style.zIndex="10300";h.style.left="-1000px";h.style.top="-1000px";h.style.backgroundColor="#890";h.innerHTML="<iframe id='_ContextMenu_Frame' frameborder='0' scrolling='no' width='100'></iframe>";f.document.body.appendChild(h)}else{h=f.Zving.getDom("_DivContextMenu");d.Node.show(h);var j=f.Zving.getDom("_ContextMenu_Frame");d.Node.show(j)}e=f.Zving.getDom("_ContextMenu_Frame").contentWindow;g=e.document;g.open();g.write(this.getHtmlString());g.close();e.TopWindow=f;e.init();h.onclick=stopEvent;d.AllDocumentsEvent.on("click",c.close);h.Instance=this;this.setPosition()};c.prototype.destroy=function(){this.Items.length=0};c.adjustSize=function(){var f=Zving.rootWin;var e=f.Zving.getDom("_ContextMenu_Frame").contentWindow;var g=d.Node.getSize(e.getDom("_ContextMenu_Table"));e.frameElement.height=g.height;e.frameElement.width=g.width};c.close=function(){var e=d.rootWin.Zving.getDom("_DivContextMenu");if(e){d.Node.hide(e)}d.AllDocumentsEvent.un("click",c.close)};c.getInstance=function(){var e=d.rootWin.Zving.getDom("_DivContextMenu");if(e){return e.Instance}};c.onMouseOver=function(f){var e=f.rows[0].cells;e[0].style.backgroundColor="#466CA6";e[1].style.backgroundColor="#7096FA";e[1].style.color="#FFFFFF";e[2].style.backgroundColor="#7096FA"};c.onMouseOut=function(f){var e=f.rows[0].cells;e[0].style.backgroundColor="#D6DFF7";e[1].style.backgroundColor="#F7F8FD";e[1].style.color="";e[2].style.backgroundColor="#F7F8FD"};$window.on("unload",c.close);d.Menu=c})();
/*! Tree */
(function(){var j=window.Zving,m=j.getDom,f=j.Constant,h=j.Node,d;var g=0,n=1,b=2;var k={CNAME_CHK_PREFIX:"checked-state"};var e;f.TreeLevel="_ZVING_TREE_LEVEL";f.TreeStyle="_ZVING_TREE_STYLE";f.TreeCheckbox="_ZVING_TREE_CHECKBOX";f.TreeRadio="_ZVING_TREE_RADIO";f.TreeCascade="_ZVING_TREE_CASCADE";f.TreeParentColumn="_ZVING_TREE_PARENTCOLUMN";f.Icon_Branch_NotLast_NotExpand="icons/extra/icon_tree01.gif";f.Icon_Branch_NotLast_Expand="icons/extra/icon_tree02.gif";f.Icon_Branch_Last_NotExpand="icons/extra/icon_tree04.gif";f.Icon_Branch_Last_Expand="icons/extra/icon_tree05.gif";f.Class_Branch_NotLast_NotExpand="branch-notlast-collapse";f.Class_Branch_Last_NotExpand="branch-last-collapse";f.Class_Branch_NotLast_Expand="branch-notlast-expand";f.Class_Branch_Last_Expand="branch-last-expand";f.Branch_NotLast_NotExpand="1";f.Branch_NotLast_Expand="2";f.Branch_Last_NotExpand="3";f.Branch_Last_Expand="4";f.LastPage="_ZVING_LASTPAGE";d=function(o){this.defaultConfig={_treeNodes:{}};if(!(this instanceof d)){return j.ComponentManager.getByDom(j.getDom(o),"Tree")}this.params={};this.currentItem=null;d.superclass.constructor.apply(this,arguments)};d.BackendMethod="com.zving.framework.ui.control.TreeUI.doWork";d.selectedClass="selected";j.Class.extend(d,j.UICompBase,{ctype:"Tree",cls:"z-tree",autoEl:"div",renderTpl:'<div method="{method}" id="{id}" onselectstart="return false;"><table><tbody><tr><td>{nodes}</td></tr></tbody></table></div>',resizable:false,_rootNode:null,currentNode:null,propagateUp:true,propagateDown:true,initComponent:function(){var o=this;j.Statable(this);this.addEvents("click","selectnode","append","expandnode","collapsenode","load","movenode","insert");d.superclass.initComponent.apply(this);if(this.el){this.initDom()}},initFromDom:function(r){var q=this,p=j.getDom(r),s=p.getElementsByTagName("dt")[0];this.setParemFormEl(p);var o=q._rootNode=new d.TreeNode({isRoot:true,el:s,_tree:q});q._treeNodes[o.id]=o;if(o.el.innerText=="null"){o.el.remove()}return{el:p}},setParam:function(q,p,o){this.params[q]=p;if(o!==undefined){this[q]=o}},getParam:function(o){return this.params[o]},setParemFormEl:function(o){this.setParam(f.ID,o.id);if(o.getAttribute("method")){this.setParam(f.Method,o.getAttribute("method"))}if(o.getAttribute("checkbox")){this.setParam(f.TreeCheckbox,o.getAttribute("checkbox"));this.checkable=2;if(o.getAttribute("cascade")=="false"){this.setParam(f.TreeCascade,false);this.propagateUp=false;this.propagateDown=false}}else{if(o.getAttribute("radio")){this.setParam(f.TreeRadio,o.getAttribute("radio"));this.checkable=1}}if(typeof o.onclick=="function"){this.onClick=o.onclick;o.onclick=null}},initDom:function(){var p=this;var o=this.el;var q=o.id;p.dom={};p.outerEl=j.getDom(q+"_outer");p.$outerEl=$(p.outerEl);p.initEvents();j.Page.onLayout(function(){if(!p.container||p.el.clientWidth===0&&p.container.clientWidth===0){return}p.layout();p.initScroll()})},initEvents:function(){var o=this;o.$outerEl.on("contextmenu","dt",function(p){o.onContextMenu(p)});o.$outerEl.on("click","dt",function(p){o.onNodeClick(p)});o.$outerEl.on("click.nodetoggle","img.branch",function(p){o._onToggleClick(p);p.stopPropagation()});o.$outerEl.on("click.checkbox","img.tree-checkbox",function(p){o._onCheckboxClick(p);p.stopPropagation()});o.$outerEl.on("dblclick","dt",function(p){o.onNodeDblClick(p)})},onContextMenu:function(o){var q=this;var p=o.currentTarget},getString:function(){var o=this,p=o.initRenderData();return j.String.tmpl(this.renderTpl,p)},initRenderData:function(){var o=this;o.renderData=o.renderData||{};j.mixIf(o.renderData,{id:o.getId(),cls:o.cls,nodes:o._getBodyString()});return o.renderData},_getBodyString:function(){var o="",p=this;if(p.data){p._rootNode=new d.TreeNode(p.data);p._rootNode.isRoot=true;p._rootNode.nodeType="root";p._rootNode._level=0;p._rootNode.setTree(p);o=p._rootNode.getString()}return o},getTreeNodes:function(){return this._treeNodes},getTreeNodeById:function(o){return this.getTreeNodes()[o]},getCurrentNode:function(){if(this.currentNode&&!this.currentNode.isDestroyed){return this.currentNode}return null},getCurrentNodeInnerCode:function(){if(this.currentNode&&!this.currentNode.isDestroyed){return this.el.getAttribute("innercode")}return null},setCurrentNode:function(o){this.currentNode=o},insertNode:function(p,o,q){},removeNode:function(o){},select:function(o,q,p){this.selectByAttr(o,q,p)},selectByAttr:function(o,s,p){var r=this;var q=r.findNodeByAttr(o,s);if(q){q.select();if(p&&r.onClick){r.onClick.call(q.el)}}},selectByInnerCode:function(q){if(!q){return}var p=this;var o=function(t){var r=t.el;var s=r.getAttribute("innercode");if(!t.isRoot&&!q.startsWith(s)){return}if(s==q){p.onNodeClick(r);j.getDom(r).scrollIntoView(false);return true}else{if(!t.isLeaf){if(t.isRoot||t.expanded){if(!t._children){console.log("!node._children",t)}t._children&&t._children.some(o)}else{t.on("expand",function(u){if(!u._children){console.log("!inode._children",u)}u._children&&u._children.some(o)});t.expand()}}}};o(p._rootNode)},selectByIdPath:function(p){if(!p){return}var q=this;if(typeof p=="string"){p=p.split(",")}p.unshift("_TreeRoot");var o=function(s){var r=s.el;var u=p[r.getAttribute("level")];var t=r.getAttribute("cid")||r.getAttribute("id");if(t.indexOf("_")!=-1){t=t.substr(t.indexOf("_")+1)}if(!s.isRoot&&t!=u){return}if(t==u&&r.getAttribute("level")==p.length-1){q.onNodeClick(r);j.getDom(r).scrollIntoView(false);return true}else{if(!s.isLeaf){if(s.isRoot||s.expanded){if(!s._children){console.log("!node._children",s)}if(s.isRoot){i=-1}s._children&&s._children.some(o)}else{s.on("expand",function(w){if(!w._children){console.log("!inode._children",w)}w._children&&w._children.some(o)});s.expand()}}}};o(q._rootNode)},_onCheckboxClick:function(o){var p=h.getParent(o.currentTarget,"DT");h.getComponent(p,"Tree.TreeNode")._onCheckboxClick(o)},_onToggleClick:function(o){var p=h.getParent(o.currentTarget,"DT");h.getComponent(p,"Tree.TreeNode")._onToggleClick(o)},onNodeClick:function(o){var q=this;var p;if(o.nodeType&&o.tagName){p=o}else{var r=o.target;if(r&&r.tagName&&/select|input|textare/i.test(r.tagName)&&!r.disabled){return}if(r&&(h.hasClass(r,"branch")||h.hasClass(r,"tree-checkbox"))){return}p=o.currentTarget}q.onNodeSelected(p,o);if(q.onClick){q.onClick.call(p,o)}},onNodeSelected:function(p,o){var q=this;h.getComponent(p,"Tree.TreeNode").select()},onNodeDblClick:function(o){var p=this;var q=o.target;if(q&&q.tagName&&/select|input|textare/i.test(q.tagName)&&!q.disabled){return}if(q&&h.hasClass(q,"tree-checkbox")){return}if(q&&q.getAttribute&&q.getAttribute("treenodetype")&&q.getAttribute("treenodetype")=="root"){return}p._onToggleClick(o);o.stopPropagation()},layout:function(){var o=this},initScroll:function(){var r=this;var q=r.getEl();var t=q.id;var p=this.outerEl;var s=this.$outerEl;if(q.getAttribute("customscrollbar")=="false"){return}if(j.ScrollPanel&&!j.isIE6&&!j.isChrome){if(!s.data("scrollpanelId")){if(q.offsetHeight>p.offsetHeight||q.offsetWidth>p.offsetWidth){s.data("scrollpanelId",new j.ScrollPanel({target:p,overflow:"auto"}).getId());r.usedCustomScrollbar=true}}else{var o=j.ComponentManager.get(s.data("scrollpanelId"));if(o){o.resume({target:p})}}}s=p=null},resumeScrollPanel:function(){var r=this;var q=this.getEl();var t=q.id;var p=this.outerEl;var s=this.$outerEl;if(s.data("scrollpanelId")){var o=j.ComponentManager.get(s.data("scrollpanelId"));if(o){o.resume({target:p})}}s=p=null},showLoading:function(){var t=this;var o=this.getBodyEl();var r=t.dom.body;var u=m("#_LoadingBGDiv");var z=m("#_LoadingIconDiv");if(!u){u=document.createElement("div");u.id="_LoadingBGDiv";h.hide(u);u.style.cssText="background-color:#FCFCFC;position:absolute;z-index:800;opacity:0.2;filter:alpha(opacity=20);";document.body.appendChild(u);u=$(u);z=document.createElement("div");z.id="_LoadingIconDiv";h.hide(z);z.innerHTML="　<img src='"+PATH+"framework/images/loadingGreen15px.gif'><font color=green> "+Lang.get("Tree.Loading")+"　</font>";z.style.cssText="padding-top:5px;background-color:#ffc;position:absolute;z-index:801;height:20px;width:120px";document.body.appendChild(z)}var s=$(u);var q=$(z);var x=$(r).offset();var y=t.dom.body.offsetWidth,p=t.dom.body.offsetHeight;s.css({top:x.top+"px",left:x.left+"px",width:y+"px",height:p+"px"});q.css({top:x.top+(j.isIE?2:0)+"px",left:x.left+(j.isIE?2:0)+"px"});s.show();q.show()},hideLoading:function(){$("#_LoadingBGDiv").hide();$("#_LoadingIconDiv").hide()},loadData:function(r,w,u){var t=this;var q=t.getEl();var p=q.id;var s=t.getBodyEl();if(t.isDataLoading){return}t.isDataLoading=true;var o=null;var x={width:t.outerEl.style.width,height:t.outerEl.style.height};if(t.currentNode){o=t.currentNode.el.getAttribute("cid")}if(!w){w={}}else{if(w instanceof j.DataCollection){w=j.mix({},w.map)}}j.mix(w,t.params);Server.sendRequest(d.BackendMethod,w,function(A){t.currentNode=null;var C=A.HTML;if(!C||C.length<10){j.Console.error("用于渲染树结构的数据错误："+A);t.isDataLoading=false;return}if(!e){e=document.createElement("div")}C=C.replace(/^<div [^>]+>/,"").replace(/<\/td><\/tr><\/table><\/div><\/div>/,"</td></tr></table></div>");e.innerHTML=C;var E=e.firstChild;jQuery.cleanData(q.parentNode.getElementsByTagName("*"));q.parentNode.replaceChild(E,q);q=null;t.el=q=m(p);q._components=t.el._components||{};q._components[t.ctype]=t.id;t.isDataLoading=false;if(e.getElementsByTagName("script")[0]){new Function(e.getElementsByTagName("script")[0].text)()}var z=Number(t.getParam(f.Size));if(z>0){var y=Number(t.getParam(f.PageIndex));var B=Number(t.getParam(f.PageTotal));var D=Math.floor(B/z);if(B%z===0){D--}t.setParam(f.LastPage,D);if(D>y){this.loadOtherPages();return}}t.restore();if(o!==null){t.select("cid",o,false)}if(r){r()}t.outerEl.style.width=x.width;t.outerEl.style.height=x.height;if(t.usedCustomScrollbar){t.resumeScrollPanel()}q=null})},lazyLoad:function(s,r,o){var q=this;var p=j.getDom(s);var t=h.getComponent(p,"Tree.TreeNode");t.lazyLoad(r,o)},restore:function(){this.restoreNodes()},restoreNodes:function(){this.initFromDom(this.el)},loadOtherPages:function(){var r=this;var p=Number(r.getParam(f.Size));if(p<1){return}var q=Number(r.getParam(f.PageTotal));var s=Math.floor(q/p);if(q%p===0){s--}r.setParam(f.LastPage,s);var o={};j.mix(o,r.params);r.otherPagesHtml=[];r.loadNextPage(o)},loadNextPage:function(o){var p=this;o[f.PageIndex]++;Server.sendRequest(d.BackendMethod,o,function(q){var r=q.HTML;if(!r){j.Console.error("用于渲染树结构的数据错误："+q);return}r=r.replace(/^<div [^>]+>/,"").replace(/<\/td><\/tr><\/table><\/div><\/div>$/,"</td></tr></table></div>");r=r.replace(/^.+?<\/dt><dd>/,"").replace(/<\/dd><\/dl><\/td><\/tr><\/table><\/div>$/,"");p.otherPagesHtml.push(r);p._rootNode._getSubNodesContainer().insertAdjacentHTML("beforeend",r);if(o[f.LastPage]>o[f.PageIndex]&&o[f.PageIndex]<9){p.loadNextPage(o)}else{console.log("载入Treer控件的"+p.otherPagesHtml.length+"个分页")}})},filter:function(u){var s=this;var p=s._rootNode._childNodes;var o=[];var q;for(q=0,len=p.length;q<len;q++){var r=p[q];if(u===""){r.show();continue}var t;if(r._innerText){t=r._innerText}else{t=r.el.innerText;t=t.replace(/　/g,"").trim();r._innerText=t}if(t.indexOf(u)!==-1){o.push(r);var w=r._parentNode;while(w){o.push(w);w=w._parentNode}}else{r.hide()}}for(q=0,l=o.length;q<l;q++){o[q].show()}o=undefined},clear:function(){var o=this;o.data={};o.el.innerHTML=""},forEachNodes:function(q,p){p=p||this;var o=function(s,t){var r=s._children;if(r&&r.length){r.each(function(x,u,w){q.call(p,x,u,w);o(x,t+1)})}};o(this._rootNode,0)},checkNode:function(p){var o=this;p.setChecked(true)},getCheckedData:function(s,t){var u=this;var o=[];if(u.checkable==1){var w=document.getElementsByName(u.el.id);for(var r=0,p=w.length;r<p;r++){if(w[r].checked===true){var q=h.getParent(w[r],"DT");o.push(s?q.getAttribute(s):h.getComponent(q,"Tree.TreeNode"));break}}}else{if(u.checkable==2){t=t||function(){return true};u.forEachNodes(function(x){if(x.checked===b&&t(x)){o.push(s?x.el.getAttribute(s):x)}})}}return o.length?o:null},findNodeByAttr:function(o,r){r=String(r);var q=null,p=function(s){if(s.el.getAttribute(o)===r){q=s;return true}if(s._children){return s._children.some(p)}return false};if(p(this._rootNode)){return q}return null},findNodesByAttr:function(o,r){r=String(r);var q=[],p=function(s){if(s.el.getAttribute(o)===r){q.push(s)}if(s._children){return s._children.each(p)}return false};p(this._rootNode);return q.length?q:null},beforeDestroy:function(){var o=this;delete this.currentItem;delete this._rootNode;delete this._treeNodes}});var c="filter,lazyLoad,select,selectByAttr,onNodeClick,getParam,setParam,insertNode,removeNode,loadData,loadOtherPages,showLoading,hideLoading";c=c.split(",");var a={};for(i=0;i<c.length;i++){d[c[i]]=(function(o){return function(r){var q=j.toArray(arguments,1);var p=j.ComponentManager.getByDom(r,"Tree");if(p){return p[o].apply(p,q)}}})(c[i])}d.selectNode=function(o,p){var q=h.getComponent(o,"Tree.TreeNode");q.select();if(p&&q.onClick){q.onClick.call(o)}};d.TreeNode=function(o){this.defaultConfig={_childNodes:[],_children:[],_stringArray:[],_tree:{}};if(!(this instanceof d.TreeNode)){return j.ComponentManager.getByDom(j.getDom(o),"Tree.TreeNode")}d.TreeNode.superclass.constructor.apply(this,arguments)};d.isRoot=function(o){return j.getDom(o).getAttribute("level")==="0"};j.Class.extend(d.TreeNode,j.UICompBase,{ctype:"Tree.TreeNode",cls:"",autoEl:"dl",autoElTpl:'<dl class="{cls}"><dt>{content}</dt><dd>{childNodes}</dd></dl>',renderTpl:"{content}",nodeType:"leaf",checked:0,isToggle:true,initComponent:function(){this.addEvents("click","append","expandnode","collapsenode","load","movenode","insert","select","unselect");d.TreeNode.superclass.initComponent.apply(this);if(this.el){this.initDom()}},initDom:function(){var y=this,r=y.el;if(r.getAttribute("treenodetype")){this.nodeType=r.getAttribute("treenodetype");if(this.nodeType=="leaf"){this.isLeaf=true}}var t=y._getSubNodesContainer();if(r.getAttribute("expand")){if(r.getAttribute("expand")=="2"||r.getAttribute("expand")=="4"){y._isRenderChildren=true;y.expanded=true}else{if(r.getAttribute("expand")=="1"||r.getAttribute("expand")=="3"){y.expanded=false}}}if(t.style.display!=="none"&&t.children.length>0){y._isRenderChildren=true;y.expanded=true}if(r.getAttribute("islast")=="true"){y._isLast=true}y._childNodes=[];y._children=[];var A=y._getSubNodesContainer();var q=A.children;var p=[];for(var w=0,x=q.length;w<x;w++){if(!q[w].firstChild){console.log(q[w].parentNode.outerHTML)}if(q[w].firstChild&&q[w].firstChild.tagName=="DT"){p.push(q[w].firstChild)}}for(var u=0,s=p.length;u<s;u++){var z=new d.TreeNode({el:p[u],_parentNode:y,_tree:y._tree});y._childNodes.push(z);var o=y._parentNode;while(o){o._childNodes.push(z);o=o._parentNode}if(p[u].parentNode.parentNode==A){y._children.push(z)}}if(r.getAttribute("level")){y.level=Number(r.getAttribute("level"))}if(y._parentNode&&typeof y._parentNode.level=="number"&&y.level!==y._parentNode.level+1){y.level=y._parentNode.level+1;r.setAttribute("level",y.level)}if(y._parentNode&&y._parentNode.checked==2&&y._tree.propagateDown==true){r.setAttribute("checked","true")}if(r.getAttribute("checked")=="checked"||r.getAttribute("checked")=="true"){y.checked=2;y._afterCheckedChange({newVal:2,prevVal:0,src:"propagatingDown"})}if(r.getAttribute("chkdisabled")=="disabled"||r.getAttribute("chkdisabled")=="true"){y.setCheckboxDisabled(true)}},lazyLoad:function(t,p){var s=this;var r=s.el;var o=s.getTree();var u=o.id;if(s.isDataLoading){return}var q=s._getSubNodesContainer();q.style.display="block";q.innerHTML='<div class="z_loading">loading...</div>';s.isDataLoading=true;if(!p){p={}}else{if(p instanceof j.DataCollection){p=j.mix({},p.map)}}j.mix(p,o.params);p.ParentLevel=r.getAttribute("level");p.LevelStr=r.getAttribute("levelstr");p[o.params[f.TreeParentColumn]||"ParentID"]=r.getAttribute("cid");Server.sendRequest(d.BackendMethod,p,function(w){if(r.getAttribute("lazy")=="1"){r.setAttribute("lazy","0");var x=w.HTML;if(!x){j.Console.error("用于渲染树结构的数据错误："+w);s.isDataLoading=false;return}q.innerHTML=x.replace(/^<dd>/,"").replace(/<\/dd>$/,"");s._isRenderChildren=true;s.initDom();s._switchToggleState("block","branch-last-expand","branch-notlast-expand",true);if(t){t.call(r)}if(typeof o.el.onLazyLoad=="function"){o.el.onLazyLoad.call(o,q,r)}s.fireEvent("lazyLoad",s);s.fireEvent("toggle",s);s.fireEvent("expand",s);o.fireEvent("lazyLoad",{treeNode:s});o.fireEvent("toggle",{treeNode:s});o.fireEvent("expand",{treeNode:s})}o=r=t=null;s.isDataLoading=false})},getString:function(){var q=this,o=q._stringArray,p="";o.push('<dl id="',q.id,'">');q._createBodyStringArray();p=q.expanded?"display:''":"display:none";o.push('<dd  style="'+p+'" id="',q.id,'-subNodeId"></dd></dl>');return o.join("")},initRenderData:function(){var o=this,p=[];this.renderData=this.renderData||{};return j.mixIf(this.renderData,{id:this.id,content:this.content,childNodes:""})},getParentNode:function(){return this._parentNode},setParentNode:function(o){var p=this;p._parentNode=o;p._level=o._level+1},getChildNodes:function(){return this._childNodes},forSomeChildren:function(q,p){var o=this._children;p=p||this;if(o&&o.length){o.some(function(s,r,t){return q.call(p,s,r,t)})}},setTree:function(o){var p=this;p._tree=o;p._tree._treeNodes[p.id]=p},getTree:function(){return this._tree},appendData:function(p){var o=this;if(!p){return}$(o._getSubNodesContainer()).append(o._getSubNodeString(p));o._isRenderChildren=true},_getSubNodeString:function(u){var s=this,t,p=[],q=0,r,o=u.length;for(;q<o;q++){r=u[q];t=new d.TreeNode(r);if(q==(o-1)){t._isLast=true}s._appendChildData(t,o-1);p.push(t.getString())}return p.join("")},isParent:function(q){var p=this,o=q;while(!o.isRoot&&(o=o.getParentNode())){if(o==p){return true}}return false},appendTo:function(o){var p=this;p.getParentNode()._removeChildData(p);o.appendChild(p);p.fireEvent("appendto")},moveTo:function(s){var r=this,p=r.getParentNode(),q,o;if(!p){return false}if(s.expanded&&s.getChildNodes().length>0){q=s}else{q=s.getParentNode()}p._removeChildData(r);o=(q==s)?-1:s.getIndex();q.appendChild(r,o);r.fireEvent("moveto");r.getTree().fireEvent("movenode",{treeNode:r})},_appendChildData:function(s,q,o){var r=this,p=r.getChildNodes();s._parentNode=r;s.setTree(r.getTree());if(o){p.splice(q+1,0,s);r._children.splice(q+1,0,s.json)}else{p.push(s);r._children.push(s.json)}},appendChild:function(u,r){var t=this,s,q,w,o=u._getContainer(),p=t._getSubNodesContainer();if(r===null){r=t.getChildNodes().length-1}t._appendChildData(u,r,true);w=t.getChildNodes();s=u.getParentNode();q=u.getString();if(o){if(r==-1){if(w.length==1){p.appendChild(o)}else{$(o).before(w[1]._getContainer())}}else{$(o).after(w[r]._getContainer())}}else{if(r==-1){if(w.length==1){$(p).append(q)}else{$(w[1]._getContainer()).prepend(q)}}else{$(w[r]._getContainer()).after(q)}}u._updateAll();u._updateOldParent(s);if(t.nodeType=="leaf"){t.nodeType="trunk"}t._getSpanElement().innerHTML=t._getImagesString();t.getTree().fireEvent("append",{treeNode:t});return u},_updateOldParent:function(o){var p=this;if(!o){return false}if(o.getLastChild()){o.getLastChild()._update()}else{if(p.getTree().expandable){o.nodeType="leaf";o.isLeaf=true}o._update()}},_removeChildData:function(q,o){var p=this;Array.remove(p._children,q.json);Array.remove(p._childNodes,q);delete p.getTree().getTreeNodes()[q.id];if(o){while(q._childNodes[0]){q._removeChildData(q._childNodes[0])}}},removeAllChildren:function(){var o=this,p=o.getChildNodes();while(p[0]){o.removeChild(p[0],true)}},removeChild:function(q){if(!q.getParentNode()){return false}var p=this,o=p.getChildNodes();p._removeChildData(q,true);delete p.getTree().getTreeNodes()[q.id];j.Dom.removeNode(q._getContainer());p.getTree().setCurrentNode(null);if(o.length<=0&&!p.isRoot){p._getSubNodesContainer().style.display="none";if(p.getTree().expandable){p.nodeType="leaf";p.isLeaf=true}}p._updateAll()},_updateAll:function(){var p=this,o=p.getPrevious();o&&o._update();p._update()},_update:function(){var o=this;o._getSpanElement().innerHTML=o._getImagesString();Array.each(o._childNodes,function(p){p._update()})},update:function(q){var r=this,p=r._getHrefElement(),o=r._getTextElement();j.mix(r,q);(p?p:o).innerHTML=r.text},_switchToggleState:function(t,q,r,o){var s=this,p=s._getToggleElement();if(s.nodeType=="leaf"){return false}s.expanded=o;if(p){p.className="tree-skeleton-icon branch "+(s.isLastNode(true)?q:r)}if(s.getChildNodes()&&s.getChildNodes().length>0){s._getSubNodesContainer().style.display=t}},expand:function(){var o=this;if(!o._isRenderChildren){o.lazyLoad(o._dynamicLoadReturn);return}o._switchToggleState("block","branch-last-expand","branch-notlast-expand",true);o.fireEvent("expand",o);o.getTree().fireEvent("expandnode",{treeNode:o})},_dynamicLoadReturn:function(){if(this.propagateDown){var o=this.getChecked();this.forSomeChildren(function(p){p.setChecked(o,{src:"propagatingDown"})})}},collapse:function(){var o=this;this._switchToggleState("none","branch-last-collapse","branch-notlast-collapse",false);o.fireEvent("collapse");o.getTree().fireEvent("collapsenode",{treeNode:o})},toggle:function(){var o=this;if(o.nodeType=="leaf"){return false}o.expanded?o.collapse():o.expand()},click:function(o){var p=this;p.select();if(p.onClick){p.onClick.call(p.el)}if(p.getTree().onClick){p.getTree().onClick.call(p.el)}p.getTree().fireEvent("click",{treeNode:p})},select:function(o){var p=this,q=p.getTree().getCurrentNode();if(q){q.unselect()}this.el.selected=this.selected=true;$(this.el).addClass(d.selectedClass);p.getTree().setCurrentNode(p);if(o!==true){p.fireEvent("select",this);p.getTree().fireEvent("select",{treeNode:p})}return this},onSelect:function(){},unselect:function(){this.el.selected=this.selected=false;$(this.el).removeClass(d.selectedClass);this.getTree().setCurrentNode(null)},_onToggleClick:function(o){var q=this;if(q.el.getAttribute("lazy")&&q.el.getAttribute("lazy")=="1"){var p=q.checked;q.lazyLoad(function(){q.setChecked(p)})}else{q.isToggle&&q.toggle();q.getTree().fireEvent("toggle",{treeNode:q})}},_onCheckboxClick:function(o){var p=this;if(!p.chkdisabled){p.toggleCheckbox()}},toggleCheckbox:function(){this.setChecked(this.checked?g:b)},getChecked:function(){return(this.chkdisabled?null:this.checked||0)},setChecked:function(r){if(r===true){r=2}var q="checked-state-";if(this.chkdisabled){return}var o=this.checked;this.checked=r;if(o!=r){this.$el.removeClass(q+o).addClass(q+r);var p={newVal:r,prevVal:o,type:"checkedchange"};this._afterCheckedChange(p);this.fireEvent("checkedchange",p)}},setCheckboxDisabled:function(r){var o=this.chkdisabled;this.chkdisabled=r;if(o!=r){var p=this.checked,q=k.CNAME_CHK_PREFIX+"-";if(r){this.$el.removeClass(q+p).addClass(q+p+"-disabled")}else{this.$el.removeClass(q+p+"-disabled").addClass(q+p)}this.$el.find(":radio").prop("disabled",r);this.fireEvent("checkboxdisabledchange")}},_childCheckedChange:function(){var p=0,o=0,q,r=this.checked;this.forSomeChildren(function(s){p+=2;o+=s.getChecked()});q=(o===0?g:(o===p?b:n));this.checked=q;this._afterCheckedChange({prevVal:r,newVal:q,src:"propagatingUp"});return this},_afterCheckedChange:function(q){var p=q.newVal,r=k.CNAME_CHK_PREFIX+"-",o;if(this.chkdisabled){return}this.$el.removeClass(r+q.prevVal).addClass(r+p);this.$el.attr("aria-checked",this._ariaCheckedGetter());if(!this.isRoot&&this._tree.propagateUp&&q.src!=="propagatingDown"){this.getParentNode()._childCheckedChange()}if(this._tree.propagateDown&&q.src!=="propagatingUp"){this.forSomeChildren(function(s){s.setChecked(p,{src:"propagatingDown"})})}},_ariaCheckedGetter:function(){return["false","mixed","true"][this.getChecked()||0]},_createBodyStringArray:function(){var p=this,o=p._stringArray;o.push('<dt id="',p.id,'-node" class="z-tree-node-node"');if(p.skin){o.push(" ",p.skin,"-node")}o.push('"> <span id="',p.id,'-span">',p._getImagesString(true),"</span>");p._createIconStringArray();p._createTextStringArray();o.push("</dt>")},_getImagesString:function(q){var p=this,o="";o+=p._getIdentString(q);if(p.nodeType=="leaf"){o+=p._getTLString(q)}else{if(p.nodeType=="trunk"){if(p.children&&p.children.length>0){o+=p._getToggleString(q)}else{o+=p._getTLString(q)}}}return o},_getIdentString:function(r){var q=this,o="",p;while(q.getParentNode()&&q.getParentNode().nodeType!="root"){q=q.getParentNode();p=(q.isLastNode(r)?"blank":"I");className="z-tree-node-"+p;if(q.skin){className+=" "+q.skin+"-"+p}o='<span   class="'+className+'"></span>'+o}return o},_getTLString:function(q){var p=this,o=(p.isLastNode(q)?"L":"T");className="z-tree-node-"+o;if(p.skin){className+=" "+p.skin+"-"+o}return'<span   class="'+className+'" ></span>'},_getToggleString:function(s){var r=this,p=r.expanded?"minus":"plus",q=(r.isLastNode(s)?"L":"T")+p,o="z-tree-node-"+q;if(r.skin){o+=" "+r.skin+"-"+q}return['<span class="',o,'" id="',r.id,'-toggle"></span>'].join("")},_createIconStringArray:function(){var q=this,p=(q.type=="leaf"?"leaf":"trunk"),o=q._stringArray;if(q.isOpen){p="open-trunk"}o.push('<span  class="z-tree-node-',p);if(q.skin){o.push(" ",q.skin,"-",p)}o.push('" style="',q.icon?"background-image:url("+q.icon+")":"",'" id="',q.id,'-icon"></span>')},_createTextStringArray:function(){var p=this,q=(p.href?p._createHrefStringArray():p.text),o=p._stringArray;o.push('<span title="',p.title||p.text,'" id="',p.id,'-text" >',q,"</span></span>")},_createHrefStringArray:function(){var p=this,o=p._stringArray;o.push('<a id="',p.id,"-link",(p.target?"target='"+p.target+"'":""),' hidefocus="on" " href="',p.href,'" >',p.text,"</a>")},_getSpanElement:function(){return j.getDom(this._getId("span"))},_getIconElement:function(){return thid.$el.find("icon")},_getTextContainer:function(){return j.getDom(this._getId("textContainer"))},_getTextElement:function(){return j.getDom(this._getId("text"))},_getToggleElement:function(){this.dom=this.dom||{};if(!this.dom.toggleEl){var p=this.el.getElementsByTagName("img");for(var o=0;o<p.length;o++){if(h.hasClass(p[o],"branch")){this.dom.toggleEl=p[o];break}}p=null}return this.dom.toggleEl},_getSubNodesContainer:function(){return h.nextElement(this.el)},hide:function(){h.hide(this.el);this.fireEvent("hide")},show:function(){h.show(this.el);this.fireEvent("show")},expandAll:function(){var o=this;if(o.children){o.expand()}Array.each(o.getChildNodes(),function(p){p.expandAll()})},collapseAll:function(){var o=this;if(o.getChildNodes().length>0){o.collapse()}Array.each(o.getChildNodes(),function(p){p.collapseAll()})},getIndex:function(){if(!this._parentNode){return}var s=this,p=s.isRoot?[]:s.getParentNode().getChildNodes(),q=-1;for(var r=0,o=p.length;r<o;r++){if(p[r]==s){return r}}return q},getNext:function(){var q=this,p=q.getIndex(),o;if(q.isRoot){return q}o=q.getParentNode().getChildNodes();return(p+1>=o.length)?q:o[p+1]},getPrevious:function(){var q=this,p=q.getIndex(),o;if(q.isRoot){return q}o=q.getParentNode().getChildNodes();return(p-1<0)?q:o[p-1]},getFirstChild:function(){var p=this,o=p.getChildNodes();return(o.length<=0)?null:o[0]},getLastChild:function(){var p=this,o=p.getChildNodes();return o.length<=0?null:o[o.length-1]},isLastNode:function(p){var o=this;if(p){return o._isLast}if(o.isRoot){return true}return o.getIndex()==(o._parentNode._childNodes.length-1)},beforeDestroy:function(){var o=this;delete this._tree;delete this._childNodes;delete this._children;delete this._stringArray}});c="getParentNode";c=c.split(",");a={};for(i=0;i<c.length;i++){d.TreeNode[c[i]]=(function(o){return function(q){var p=j.toArray(arguments,1);var r=j.ComponentManager.getByDom(q,"Tree.TreeNode");if(r){return r[o].apply(r,p)}}})(c[i])}j.Tree=d})();
/*! TabPage */
(function(){var f=window.Zving,d=f.getDom,g=f.Url,b=f.AjaxPage,e={};var a,c;e.onChildTabClick=function(k){var m=$(d(k));if(m.data("tip")){m.data("tip").close();m.removeData("tip")}if(m.attr("data-href")){var j=g.makePathAbsolute(m.attr("data-href"),g.documentUrl.hrefNoSearch);var h=g.parseUrl(j);location.hash=h.hrefNoHash.replace(h.domain,"")}k=m=null};e.setQueryString=function(m,k){if(!m){var j=$("a.z-tab-current");m=j.get(0)}m=d(m);var h=m.getAttribute("data-href");if(h){m.setAttribute("data-href",h.split("?")[0]+"?"+k)}m=null};e.tryReload=function(r,n){if(!r){return}var p;var o;if(n){o=$(n)}else{o=$("a.z-tab-current");if(!o.length){o=$("a.z-tab[data-href]").first()}}var m=o.attr("data-href");var j=g.makePathAbsolute(m,g.documentUrl.hrefNoSearch);var s=g.parseUrl(j);p=s.hrefNoHash.replace(s.domain,"");var k;var q=p.indexOf("?");if(q<0){k=p+"?"+r}else{var h=p.substring(q+1);if(h==r){return}k=p.substring(0,q)+"?"+r}o.attr("data-href",m.split("?")[0]+"?"+r);location.hash=k;n=o=null};e._onHashChange=function(j){var h=e.getChildTabByHash(j);e.synTabBtnStatus(h)};e.synTabBtnStatus=function(h){if(h){$(".z-tab").each(function(){if(this===h){$(this).addClass("z-tab-current")}else{$(this).removeClass("z-tab-current")}})}};e.init=function(h,k){$window.bind("hashchange",function(m){e._onHashChange(g.parseUrl(location.href).hash)});var j;if(location.hash&&/^#\//.test(location.hash)){$window.trigger("hashchange")}else{j=(k?$("#"+k):$("a.z-tab"))[0];$(j).trigger("click")}if(h===false){$(j).siblings().each(function(){b.loadPage(g.makePathAbsolute(this.getAttribute("data-href"),g.documentUrl.hrefNoSearch),{autoAppend:true})})}else{$(j).siblings("[data-lazy=false]").each(function(){b.loadPage(g.makePathAbsolute(this.getAttribute("data-href"),g.documentUrl.hrefNoSearch),{autoAppend:true})})}this.hiddenItems=[];this.triggerWidth=22;this.buttonSelector="a.z-tab";this.dom={};this.outerEl=$("div.z-tabpanel").get(0);this.el=this.outerEl.children[0];this.dom.$frameBody=$("div.z-tabpanel-nowrap");this.dom.frameBody=this.dom.$frameBody.get(0);this.dom.frame=this.dom.frameBody.parentNode;this.dom.$frame=$(this.dom.frame);this.$buttons=this.dom.$frameBody.find(this.buttonSelector).not(".z-scroller");this.getItems();this.fitToSize()};e.getItems=function(j){var h=this;this.items=[];if(j){this.$buttons=this.dom.$frameBody.find(h.buttonSelector).not(".z-scroller")}this.$buttons.each(function(){var k={};k.el=this;k.left=this.offsetLeft-2;k.right=this.offsetLeft+2+this.clientWidth;k.ownerCt=h;k.parentToolbar=h;h.items.push(k)})};e.getItemWidth=function(h){return h.xtbHidden?(h.xtbWidth||0):h.el.offsetWidth+3};e.fitToSize=function(){var t=this;if(!t.outerEl||!t.outerEl.parentNode||!t.outerEl.offsetParent&&!t.outerEl.parentNode.offsetParent){return}var j=this.dom.frameBody.offsetWidth,w=j-this.triggerWidth,h=this.lastWidth||0,r=0,k=this.hiddenItems,o=k.length!==0,x=j>h;this.lastWidth=j;var n=this.dom.$frameBody.find(t.buttonSelector).not(".z-scroller");if(j==h&&n.length==this.items.length){return}if(n.length!=this.items.length){this.$buttons=n;this.getItems()}n=null;var s=this.items,q=s.length,m=0,y;for(var p=0;p<q;p++){y=s[p];if(!y.isFill){m+=this.getItemWidth(y);if(m>w){if(!(y.hidden||y.xtbHidden)){this.hiddenItems.push(y)}}}}var u=t.dom.frameBody.scrollWidth;t.dom.frameBody.style.width=u+"px";o=k.length!==0;if(o){this.initMore();if(!this.lastOverflow){this.lastOverflow=true}}else{if(this.rightScroller){this.clearMenu();this.rightScroller.destroy(true);delete this.rightScroller;if(this.lastOverflow){this.lastOverflow=false}}}this.dom.frame.style.width="auto"};e.initMore=function(){var h=this;if(!this.rightScroller){this.leftScroller=new f.Button({text:"&nbsp;",cls:"z-scroller z-scroller-left",style:{position:"absolute",left:0,top:"4px"},ownerCt:this});this.rightScroller=new f.Button({text:"&nbsp;",cls:"z-scroller z-scroller-right",style:{position:"absolute",right:0,top:"4px"},ownerCt:this});this.el.style.paddingRight="18px";this.outerEl.style.paddingLeft="18px";this.leftScroller.handler=function(){h.scroll("right")};this.rightScroller.handler=function(){h.scroll("left")};this.leftScroller.render(this.el);this.rightScroller.render(this.el)}};e.scroll=function(n){var p=this;var m=p.dom.frame.clientWidth;var k=p.dom.frameBody.scrollWidth;var j=k-m;if(n=="left"){var h=p.dom.$frame.prop("scrollLeft");if(j>h){for(var o=0;o<p.items.length;o++){if(p.items[o].left>h){p.dom.$frame.animate({scrollLeft:p.items[o].left});break}}}}else{var h=p.dom.$frame.prop("scrollLeft");if(h>0){for(var o=p.items.length-1;o>=0;o--){if(p.items[o].right<h+m){p.dom.$frame.animate({scrollLeft:p.items[o].right-m});break}}}}};e.getChildTabByHash=function(m){var j=null;var k=m.replace(/^#/,"");if(k){if((/\//).test(k)){k=(g.makeUrlAbsolute(k,g.documentUrl.hrefNoSearch));if(k){var h=$("a.z-tab");h.each(function(){if(this.getAttribute("data-href")){var n=this,r=$(n);var s=g.parseUrl(g.makePathAbsolute(n.getAttribute("data-href"),g.documentUrl.hrefNoSearch));var p=s.hrefNoSearch.replace(s.domain,"");var o=k.indexOf(p);if(o!=-1){var q=k.substr(o);if(q!=p){n.setAttribute("data-href",q)}j=n;return false}}})}}}return j};e.getChildTab=function(h){return d(h)};e.isChildLoaded=function(j){var h=$('div[data-role=page][data-url$="'+$("#"+j).attr("data-href")+'"]');return !!h.length};e.getCurrentTab=function(){return $("a.z-tab-current")[0]};e.setSrc=function(j,h){d(j).setAttribute("data-href",h)};e.disableTab=function(h){h=d(h);$(h).addClass("z-tab-disabled");h._onclick_backup=h.onclick;h.onclick=null;h.onmouseover=null;h.onmouseout=null};e.enableTab=function(h){h=d(h);$(h).removeClass("z-tab-disabled");if(h._onclick_backup){h.onclick=h._onclick_backup;h._onclick_backup=null}else{h.onclick=function(){e.onChildTabClick(this)}}};f.TabPage=e})();
/*! Panel */
(function(){var c=window.Zving;var b={};var a={};a=function(d){this.defaultConfig={};if(!(this instanceof a)){return c.ComponentManager.getByDom(c.getDom(d),"PanelHeader")}a.superclass.constructor.apply(this,arguments);this.addEvents("beforecollapse","collapse","beforeexpand","expand");this.getBodyEl();this.$el.on("click",$.proxy(this.toggleCollapse,this));if(this.collapsed){this.$el.click()}};c.Class.extend(a,c.UICompBase,{ctype:"PanelHeader",collapsed:false,getBodyEl:function(){var g=this.$el;var e=g.next();while(e.length&&e[0].tagName=="SCRIPT"){e=e.next()}var d;var f=1;while(!e[0]&&f<99){if(!g.parent()[0]){break}if(g.parent()[0].nodeName=="TD"){d=g.parent().parent()}else{d=g.parent()}e=d.next();f++}if(e[0]){this.body=e[0]}},collapse:function(){$(this.body).hide();this.$el.addClass("z-toggle-collapsed")},expand:function(){$(this.body).show();this.$el.removeClass("z-toggle-collapsed")},toggleCollapse:function(){$(this.body).toggle();this.$el[(c.Node.isVisible(this.body)?"removeClass":"addClass")]("z-toggle-collapsed")}});c.PanelHeader=a})();
/*! Progress */
(function(){var h=window.Zving,f=h.isIE,b=h.isGecko,e=h.Page,g=h.Lang,a=h.Dialog,c=h.CONTEXTPATH;var d=function(k,n,j,m){this.TaskID=k;this.Title=n;if(m){this.Height=m}else{this.Height=150}if(j){this.Width=j}else{this.Width=400}this.id="z_Progress_"+k;h.ComponentManager.register(this)};d.BackendMethod="com.zving.framework.ui.control.LongTimeTaskUI.getInfo";d.prototype={ctype:"Progress",show:function(m){var k=h.rootWin;var r=this.TaskID;var p=new a({id:"Progress_Dialog"+this.TaskID,width:this.Width,height:this.Height,title:this.Title,url:"about:blank",onOk:function(){d.stop(r)},onCancel:function(){}});p.show();var o=p.innerWin;var n=o.document;n.open();n.write("<style>.progressBox{border:#ddd 1px solid}");n.write(".progressBg{ background:#ddd url("+c+"framework/images/progressBg.gif);}");n.write(".progressLight{font-size:5px; line-height:5px; color:#99bb00; background:#99bb00}");n.write(".progressShadow{font-size:5px; line-height:6px; color:#779911; background:#779911}");n.write("table,td{border-collapse: collapse; border-spacing: 0;}</style>");n.write("<body oncontextmenu='return false;'></body>");var j=[];j.push("<table width='100%' height='100%' border='0'><tr>");j.push("  <td align='center' valign='middle'>");j.push("	<div id='Info' style='text-align:left;width:100%;font-size:12px'>&nbsp;</div><br>");j.push("      <table width='100%' border='1' cellpadding='1' cellspacing='0' class='progressBox'>");j.push("      <tr><td class='progressBg'>");j.push("				<table width='1%' border='0' cellpadding='0' cellspacing='0' id='tableP'>");j.push("          <tr><td class='progressLight'>-</td></tr>");j.push("          <tr><td class='progressShadow'>-</td></tr>");j.push("        </table></td></tr></table></td></tr></table>");var q=n.createElement("div");q.innerHTML=j.join("");n.body.appendChild(q);n.close();p.okButton.innerText=g.get("Common.Cancel");p.cancelButton.innerText=g.get("Common.Close");this.Dialog=p;this.Dialog.onComplete=m;d.getInfo(this.TaskID)},destroy:function(){if(this.Dialog){this.Dialog.onComplete=null;this.Dialog.destroy()}h.ComponentManager.unregister(this)}};d.getInfo=function(k){var j=new DataCollection();j.add("TaskID",k);Server.sendRequest(d.BackendMethod,j,function(m){if(m.Status===0||m.Status==="0"){a.alert(m.Message)}else{if(!a.getInstance("Progress_Dialog"+k)){return}var q=m.CurrentInfo;if(q){$DW.document.getElementById("Info").innerHTML=q}if(m.CompleteFlag=="1"){$DW.document.getElementById("tableP").width="100%";var r=a.getInstance("Progress_Dialog"+k);h.Node.hide(r.okButton);if(m.ErrorFlag!=1){var p=r.onComplete;r.close();if(p){try{p()}catch(n){alert(n.message)}}}}else{var o=m.Percent;if(o=="0"){o="1"}if(o){$DW.document.getElementById("tableP").width=o+"%"}window.setTimeout(function(){d.getInfo(k)},1000)}}})};d.stop=function(k){var j=new DataCollection();j.add("TaskID",k);Server.sendRequest("com.zving.framework.ui.control.LongTimeTaskUI.stop",j,function(m){function n(){Server.sendRequest("com.zving.framework.ui.control.LongTimeTaskUI.stop",j,function(o){if(o.Status==1){a.alert(g.get("Progress.HasCanceled"));a.getInstance("Progress_Dialog"+k).close()}else{window.setTimeout(function(){n(k)},1000)}})}a.getInstance("Progress_Dialog"+k).cancelButton.innerHTML=g.get("Progress.HasCancelling");h.Node.disable(a.getInstance("Progress_Dialog"+k).cancelButton);n()})};h.Progress=d})();
/*! Layout */
(function(){var z=window.Zving,Layout={};z.Page=z.Page||{};var layoutTableClassName="js_layoutTable";Layout.haslayout=0;Layout.layoutTables=[];Layout.layoutTablesInSubPage=[];Layout.isAutoResizeBodyHeight=false;var layoutEvent=new z.CustEvent();z.Page.onLayout=function(fn,scope,options){layoutEvent.addListener(fn,scope,options)};Layout.initLayoutTable=function(evt){var subPageEL=evt.type=="pageshow"?evt.target:document;var $tables=$("table."+layoutTableClassName,evt.type=="pageshow"?evt.target:document);Layout.layoutTablesInSubPage=[];if($tables.length<1){z.Page.onLoad(function(){Layout.haslayout=-1;layoutEvent.fire()},50);return}else{$tables.each(function(){if(evt.type=="pageshow"){Layout.layoutTablesInSubPage.push(new Layout.LayoutTable({el:this,inSubPage:true}))}else{Layout.layoutTables.push(new Layout.LayoutTable({el:this}))}var pNode=this.parentNode;if(pNode.tagName=="FORM"){pNode.style.height="100%";pNode=pNode.parentNode}if(pNode.tagName=="BODY"){var tHeight=this.getAttribute("height");if(tHeight&&(tHeight=="*"||tHeight.indexOf("%")>0)){Layout.isAutoResizeBodyHeight=true}var tWidth=this.getAttribute("width");if(tWidth&&tWidth=="*"){this.setAttribute("width","100%")}}})}if($tables.length&&evt.type=="pageshow"){Page.onLoad(function(){Layout.doLayoutSubPage(subPageEL)},50)}else{if(evt.type!=="pageshow"){if(Layout.isAutoResizeBodyHeight){Page.onLoad(function(){Layout.resizeBodyHeight()},100);if(window!=window.top){z.EventManager.onWindowResize(Layout.resizeBodyHeight);$window.on("unload",function(){z.EventManager.removeResizeListener(Layout.resizeBodyHeight)})}}else{Page.onLoad(function(){Layout.doLayout()},100)}}}};Layout.resizeBodyHeight=function(evt){evt=z.getEvent(evt);if(evt&&evt.type=="load"){var LT=Layout.layoutTables;if(window==window.top){document.body._style_overflow=document.body.style.overflow;document.body.style.overflow="hidden";document.body._onloadHeight=document.body.offsetHeight;document.body.style.height=document.body._onloadHeight+"px";document.body.style.overflow=document.body._style_overflow}}if(window!=window.parent){var ownerdialogid;try{ownerdialogid=window.frameElement.getAttribute("ownerdialogid")}catch(ex){ownerdialogid=null}if(ownerdialogid===null){if(window.parent.Zving&&!window.parent.Zving.Page.isLoaded||!Zving.rootWin.Zving.Page.isLoaded){window.setTimeout(Layout.resizeBodyHeight,40);return}if(window.parent.Zving&&!window.parent.Zving.Layout.haslayout){window.setTimeout(Layout.resizeBodyHeight,20);return}}}var ch=z.isIE?(z.isStrict?document.documentElement.clientHeight:document.body.clientHeight):self.innerHeight;if(window==window.top&&ch<400){ch=400}if(!document.body.currentStyle){window.setTimeout(Layout.resizeBodyHeight,50);return}var bodyStyleHeight=parseInt(document.body.currentStyle.height,10);if(bodyStyleHeight!=ch){if(window==window.top&&ch<bodyStyleHeight){}else{document.body.style.overflow="hidden";document.body.style.height=ch+"px";document.body.style.overflow=""}}Layout.doLayout();if(z.isIE6){}};Layout.doLayout=function(){var list=Layout.layoutTables;for(var j=0;j<list.length;j++){list[j].layout()}Layout.haslayout++;layoutEvent.fire()};Layout.doLayoutSubPage=function(layoutTablesCt){var list=Layout.layoutTablesInSubPage;for(var j=0;j<list.length;j++){list[j].layout(true)}Layout.haslayout++;layoutEvent.fire(layoutTablesCt)};Layout.LayoutTable=function(config){z.mix(this,config);if(!this.el){alert("layout.js#LayoutTable: 参数错误，没有传入dom对象")}if(!this.container){this.container=this.el.parentNode}if(!this.layoutTarget){this.layoutTarget=this.container}this.fixHeightCells=[];this.percentHeightCells=[];this.autoHeightCells=[];this.getId();this.rendered=true;z.Observable(this);this.addEvents("beforelayout","layout","afterlayout");z.ComponentManager.register(this);this.on("layout",this._evalOnloayout);this.configureItem()};Layout.LayoutTable.prototype={ctype:"LayoutTable",getId:function(){if(!this.id){var ctype=this.ctype.toLocaleLowerCase(),idSeed=z.ComponentManager.idSeed;if(idSeed[ctype]==undefined){idSeed[ctype]=0}this.id="z-"+ctype+"-"+(++idSeed[ctype])}return this.id},configureItem:function(){var me=this;var cells=[],rows=me.el.rows;if(z.isGecko&&me.el.getAttribute("height")=="100%"){me.el.setAttribute("height","*")}for(var r=0;r<rows.length;r++){if(rows[r].style.display!=="none"){cells.push(rows[r].cells[0])}}for(var i=0,len=cells.length;i<len;i++){var height=cells[i].getAttribute("height");if(height=="*"||height=="auto"){me.autoHeightCells.push(new Layout.LayoutCell({el:cells[i],type:"autoHeight"}))}else{if(height!==null&&height.indexOf("%")>0){me.percentHeightCells.push(new Layout.LayoutCell({el:cells[i],type:"percentHeight",originalHeight:height}))}else{if(height==""||height==null){me.fixHeightCells.push(new Layout.LayoutCell({el:cells[i],type:"fixHeight"}))}else{if(this.inSubPage){var boxfix=z.isBorderBox?0:z.Node.getOuterH(cells[i]);cells[i]._attr_height=Number(height)+boxfix}me.fixHeightCells.push(new Layout.LayoutCell({el:cells[i],type:"fixHeight"}))}}}}},getLayoutTargetHeight:function(){var me=this;var height;if((me.layoutTarget.tagName=="TD"||me.layoutTarget.tagName=="BODY")&&/^[0-9.]+px$/i.test(me.layoutTarget.style.height)){height=parseInt(me.layoutTarget.style.height,10);if(me.layoutTarget.tagName=="BODY"){}}else{if(z.isIE6){me.layoutTarget._style_overflow=me.layoutTarget._style_overflow||me.layoutTarget.currentStyle.overflow;me.layoutTarget._style_overflowX=me.layoutTarget._style_overflowX||me.layoutTarget.currentStyle.overflowX;me.layoutTarget.style.overflow="hidden";height=me.layoutTarget.clientHeight;me.layoutTarget.style.overflow=me.layoutTarget._style_overflow;me.layoutTarget.style.overflowX=me.layoutTarget._style_overflowX}else{height=me.layoutTarget.clientHeight}height-=z.isBorderBox?0:z.Node.getOuterH(me.layoutTarget)}return height},layout:function(onsubpageshow){var me=this;me.fireEvent("beforelayout",me);var fixHeightCellsH=0,percentHeightCellsH=0,fixHC=me.fixHeightCells,perHC=me.percentHeightCells,autoHC=me.autoHeightCells;var surplus,boxfix;var tableHeight=me.el.getAttribute("height");if(tableHeight===null){return}var tableHeight100per;if(tableHeight=="100%"||tableHeight==""||tableHeight=="*"){tableHeight100per=true;if(tableHeight=="100%"){me.el.setAttribute("height","*")}tableHeight="100%"}if(tableHeight=="100%"){surplus=tableHeight=me.getLayoutTargetHeight()}else{if(tableHeight.indexOf("%")!=-1){surplus=tableHeight=me.getLayoutTargetHeight()*parseInt(tableHeight,10)*0.01}}for(var i=0;i<fixHC.length;i++){if(fixHC[i].el.getAttribute("ztype")=="tab_thead"){surplus-=Number(fixHC[i].el.getAttribute("height"))}else{surplus-=fixHC[i].el.offsetHeight}}for(var j=0;j<perHC.length;j++){var newHeight=parseInt(perHC[j].originalHeight,10)*tableHeight*0.01;if(newHeight>surplus){newHeight=surplus}surplus-=newHeight;perHC[j].setHeight(newHeight)}if(surplus>0){for(var k=0,autoHCLength=autoHC.length;k<autoHCLength;k++){autoHC[k].setHeight(parseInt(surplus/autoHCLength,10),onsubpageshow);autoHC[k].fireEvent("layout",autoHC[k])}}if(z.isIE6){var iframes=me.el.getElementsByTagName("IFRAME");iframes=z.toArray(iframes);iframes.each(function(iframe){var innerWin=iframe.contentWindow,innerDoc=innerWin.document;if(!innerDoc||!innerWin.Zving){return}if(innerWin.Zving.Layout.isAutoResizeBodyHeight===true){innerDoc.body.style.overflow="hidden";innerDoc.body.style.height=(innerWin.isStrict?innerDoc.documentElement.clientHeight:innerDoc.body.clientHeight)+"px";innerDoc.body.style.overflow=""}innerWin=innerDoc=null});iframes.length=0;iframes=null}me.fireEvent("layout",me.el);me=null},_evalOnloayout:function(){var el=this.el;if(typeof el.onLayout=="function"){el.onLayout.call(el)}else{if(el.getAttribute("onlayout")){eval.call(el,el.getAttribute("onlayout"))}}},destroy:function(){this.el=this.el.onLayout=null;this.fixHeightCells.length=this.percentHeightCells.length=this.autoHeightCells.length=0;this.fixHeightCells=this.percentHeightCells=this.autoHeightCells=null;this.layoutTarget=this.container=null;z.ComponentManager.unregister(this)}};Layout.LayoutCell=function(config){z.mix(this,config);this.getId();z.Observable(this);this.addEvents("beforelayout","layout","afterlayout");z.Statable(this);z.ComponentManager.register(this);this.on("layout",this._evalOnloayout);this.getBackState()};Layout.LayoutCell.prototype={ctype:"LayoutCell",getId:function(){if(!this.id){var ctype=this.ctype.toLocaleLowerCase(),idSeed=z.ComponentManager.idSeed;if(idSeed[ctype]==undefined){idSeed[ctype]=0}this.id="z-"+ctype+"-"+(++idSeed[ctype])}return this.id},getBackState:function(){if(this.type=="fixHeight"){return}var h=this.getState("height");if(h){if(z.isIE6&&window==window.top&&h>$(window).height()){}else{this._setHeight(this.el,h)}}},setHeight:function(h,onsubpageshow,dontSaveState){var boxfix=z.isBorderBox?0:z.Node.getOuterH(this.el);h=h-boxfix;if(h<0){h=0}this._setHeight(this.el,h,onsubpageshow);var nextCell=z.Node.nextElement(this.el,"TD");while(nextCell&&nextCell.rowSpan==1){this._setHeight(nextCell,h);nextCell.style.zoom=1;nextCell=z.Node.nextElement(nextCell,"TD")}if(dontSaveState==undefined){this.setState("height",h)}},_setHeight:function(el,h,onsubpageshow){try{if(onsubpageshow){var children=el.children;for(var i=children.length-1;i>=0;i--){var child=children[i];if(/DIV/.test(child.tagName)&&child.offsetHeight>h){var boxfix=z.Node.isBorderBox(child)?0:z.Node.getOuterH(child);child.style.height=h-boxfix+"px"}}}el.style.height=h+"px"}catch(e){z.Console.error(el,"设置高度",h,"不成功")}},_evalOnloayout:function(ct){var el=this.el;if(typeof el.onLayout=="function"){el.onLayout.call(el)}else{if(el.getAttribute("onlayout")){eval.call(el,el.getAttribute("onlayout"))}}},destroy:function(){this.el=this.el.onLayout=null;z.ComponentManager.unregister(this)}};z.Page.onReady(Layout.initLayoutTable,90);$document.on("pageshow",".ui-page",Layout.initLayoutTable);$window.on("unload",function(){Layout.layoutTables.length=0;layoutEvent.clearListeners()});z.Layout=Layout})();(function(){var c=window.Zving,a=c.Dom,b;b=function(d){this.constructor.superclass.constructor.apply(this,arguments);this.addEvents("dragstart","drag","dragend")};c.Class.extend(b,c.UICompBase,{ctype:"Splitter",initComponent:function(){var d=this;this.dom.previousSibling=this.previousSibling?c.getDom(this.previousSibling):c.Node.prevElement(this.el);this.dom.nextSibling=this.nextSibling?c.getDom(this.nextSibling):c.Node.nextElement(this.el);this.previousSibling=this.nextSibling=null;this.orientation=this.orientation||"v";this.$el=$(this.el);this.startX=this.$el.offset().left;this.startY=this.$el.offset().top;this.startStyleLeft=this.el.style.left;this.startStyleTop=this.el.style.top;this.initDragObject();this.initOverlay();this.dragObject.on("dragstart",this.dragstart,this);this.dragObject.on("drag",this.drag,this);this.dragObject.on("dragend",this.dragend,this);var e=false;this.$el.on("mouseover",function(){if(e){return}d.resetStartXY();e=true})},resetStartXY:function(){var d=this.orientation=="h"?true:false,e=this.orientation=="v"?true:false;this.startX=this.$el.offset().left;this.startY=this.$el.offset().top;this.dragObject.minXAttr=e?this.startX+this.minXAttr:null;this.dragObject.maxXAttr=e?this.startX+this.maxXAttr:null;this.dragObject.minYAttr=d?this.startY+this.minYAttr:null;this.dragObject.maxYAttr=d?this.startY+this.maxYAttr:null},initDragObject:function(){var e=this;var d=this.orientation=="h"?true:false,f=this.orientation=="v"?true:false;if(!c.SimpleDrag){c.Console.error("没有引用到Drag相关的js类，Slider（滑块）控件无法初始化！");this.dragObject={on:c.noopFn};return}this.dragObject=new c.SimpleDrag({dragEl:this.el,withProxy:true,minXAttr:f?this.startX+this.minXAttr:null,maxXAttr:f?this.startX+this.maxXAttr:null,minYAttr:d?this.startY+this.minYAttr:null,maxYAttr:d?this.startY+this.maxYAttr:null,xFixed:d?true:false,yFixed:f?true:false});this.dragObject.dragend=function(g){this.proxyEl.style.display="none";this.fireEvent("dragend")}},initOverlay:function(){var d;d=this.overlay?c.getDom(this.overlay):c.getDom("_dragOverlay");if(!d){d=this.overlay=a.html2Node('<div id="_dragOverlay" class="z-dragOverlay" style="position:absolute;top:0;left:0;">&#160;</div>');document.body.appendChild(d);c.Node.unselectable(d);c.Node.setSize(d,a.getViewport());c.Node.hide(d)}},getPreviousSibling:function(){return this.dom.previousSibling},getNextSibling:function(){return this.dom.nextSibling},dragstart:function(){this.fireEvent("dragstart");c.Node.show(this.overlay)},drag:function(){this.fireEvent("drag")},dragend:function(){var d,e;d=this.dragObject.proxyEl.__deltaX;e=this.dragObject.proxyEl.__deltaY;this.performResize(d,e);c.Node.hide(this.overlay);this.el.style.left=this.startStyleLeft;this.el.style.top=this.startStyleTop;this.updateChildCompLayout();this.fireEvent("dragend")},performResize:function(p,k){var g=this.dom.previousSibling,h=this.dom.nextSibling;var o=this.orientation=="v"?true:false;var m=this.orientation=="h"?true:false;var q=c.Node.getSize(g);var d=c.Node.getSize(h);var e=o&&(g.width||g.style.width);var n=m&&(g.height||g.style.height);var j=o&&(h.width||h.style.width);var f=m&&(h.height||h.style.height);c.Node.setSize(g,e?q.width+p:undefined,n?q.height+k:undefined);c.Node.setSize(h,j?d.width-p:undefined,f?d.height-k:undefined)},updateChildCompLayout:function(){this.updateToolbarLayout()},updateToolbarLayout:function(){var g,d,j,h=[],f=$("div.z-toolbar",this.dom.previousSibling).get(),e=$("div.z-toolbar",this.dom.nextSibling).get();h=h.concat(f,e);for(g=0,d=h.length;g<d;g++){if(h[g]._components&&h[g]._components.Toolbar){j=c.ComponentManager.getById(h[g]._components.Toolbar);if(j){j.fitToSize()}}}},beforeDestroy:function(){this.dragObject.destroy();this.overlay=null}});c.Splitter=b})();(function(){var b=window.Zving,a;a=function(c){this.defaultConfig={};if(!(this instanceof a)){return b.ComponentManager.getByDom(b.getDom(c),"ProgressBar")}a.superclass.constructor.apply(this,arguments)};a.htmlTemplate='<div class="z-progressbar-bar"></div>';b.Class.extend(a,b.UICompBase,{ctype:"ProgressBar",orientation:"h",cls:"z-progressbar",renderTpl:a.htmlTemplate,value:0,min:0,max:100,axis:{h:{offsetSize:"offsetWidth",size:"width"},v:{offsetSize:"offsetHeight",size:"height"}},initComponent:function(){this.orientation=this.orientation.toLowerCase();this.addEvents("beforeupdate","update");a.superclass.initComponent.apply(this)},afterRender:function(){this.update()},update:function(d){var e=this;d=d||{};b.mix(e,d);e.value=Math.max(Math.min(e.value,e.max),e.min);if(e.value==e._lastValue){return}var c=e.axis[e.orientation].size;b.Node.setStyle(e.getBar(),c,e._calcPos(e.value)+"px");e._lastValue=e.value;e.fireEvent("update")},getValue:function(){var c=this;return c.value},_calcPos:function(e){var d=this;var c=d.el[d.axis[d.orientation].offsetSize];return e*(c)/(d.max-d.min)},disable:function(){this.disabled=true},enable:function(){this.disabled=false},getTarget:function(){return b.getDom(this.targetId)},getBar:function(){return this.el.firstChild}});b.ProgressBar=a})();(function(){var b=window.Zving,a;a=function(c){this.defaultConfig={};if(!(this instanceof a)){return b.ComponentManager.getByDom(b.getDom(c),"Slider")}this.outerElAttrs={tag:"div",cls:"z-slider",style:{position:"relative"},ztype:"slider",onselectstart:"return false"};a.superclass.constructor.apply(this,arguments)};a.htmlTemplate='<div style="position: absolute;" class="{thumbCls}" id="{id}-thumb"><!--progressbar--><div class="z-thumb-{orientation}-btn"><div class="z-thumb-{orientation}-prev"></div><div class="z-thumb-{orientation}-track"></div><div class="z-thumb-{orientation}-next"></div></div></div>';b.Class.extend(a,b.UICompBase,{ctype:"Slider",orientation:"h",cls:"slider",thumbCls:"z-slider-thumb",renderTpl:a.htmlTemplate,value:0,min:0,max:100,onslide:function(){},onslideclick:function(){},_dragOpt:{},_axis:{h:{mousePos:"pageX",pos:"left",size:"width",clientSize:"clientWidth",offsetSize:"offsetWidth",dragFixed:"yFixed"},v:{mousePos:"pageY",pos:"top",size:"height",clientSize:"clientHeight",offsetSize:"offsetHeight",dragFixed:"xFixed"}},initComponent:function(){this.orientation=this.orientation.toLowerCase();this.range=[this.min||0,this.max||100];this.addEvents("slidestart","slide","slidestop","beforeupdate","update","slideclick");a.superclass.initComponent.apply(this);if(this.el){this.initDom()}},initDom:function(){var c=this;c.dom=c.dom||{};c.dom.thumb=c.getThumb();c.$el.on("mousedown.slider",$.proxy(c.onMouseDown,c));c.initDraggable();if(c.value>c.min){c._syncThumb()}c.targetEl=c.targetEl||c.target;delete c.target;if(c.targetEl){c.targetEl=typeof c.targetEl=="string"?b.getDom(c.targetEl):c.targetEl;c.$targetEl=$(c.targetEl);c.on("slide",function(){c._syncTarget()});c.on("slideclick",function(){c._syncTarget()});c.$targetEl.on("change.slider",function(){c.setValue(Number(this.value));c._syncThumb()})}},onMouseDown:function(c){if(!this.mousedownfirst){this._updateDragRange();this.mousedownfirst=true}var h=this,g=h._axis[h.orientation],e=h.$el.offset(),d=h.dom.thumb,j=c.target||c.srcElement;if(j==d||d.contains(j)||h.disabled){return}var f=h._calcValue(c[g.mousePos]-e[g.pos]-d[g.offsetSize]/2);h.setValue(f);h._syncTarget();h._syncThumb();h.fireEvent("slideclick",c);h.onslideclick()},initRenderData:function(){return b.mixIf(this.renderData,{id:this.id,cls:this.cls,thumbCls:this.thumbCls,orientation:this.orientation})},afterRender:function(){this.initDom()},initDraggable:function(){var c=this;c._dragRange=[0,0,0,0];if(!b.SimpleDrag){b.Console.error("没有引用到Drag相关的js类，Slider（滑块）控件无法初始化！");return}c._dragOpt={dragEl:c.dom.thumb,withProxy:false};c._dragOpt[c._axis[c.orientation].dragFixed]=true;c.dragObject=new b.SimpleDrag(c._dragOpt);c._updateDragRange();c.dragObject.on("dragstart",this.dragstart,this);c.dragObject.on("drag",this.drag,this);c.dragObject.on("dragend",this.dragend,this)},dragend:function(){this.fireEvent("slidestop")},dragstart:function(){this.dragstartValue=this.value;this.fireEvent("slidestart")},drag:function(){var e=this,d=e._axis[e.orientation],c=e.dom.thumb.style[d.pos];e.setValue(e._calcValue(parseInt(c,10)));e.fireEvent("slide");e.onslide()},_updateDragRange:function(j){var h=this,e=h.$el.offset(),g=h._axis[h.orientation],d=j||h.range,f=h._dragRange,c=h.dom.thumb;d=[Math.max(Math.min(d[0],h.max),h.min),Math.max(Math.min(d[1],h.max),h.min)];if(h.orientation=="h"){f[1]=h._parseValue(d[1],"fix")+c[g.offsetSize];f[3]=h._parseValue(d[0],"fix");f[2]=c.clientHeight;h.dragObject.minYAttr=h.dragObject.maxYAttr=e.top;h.dragObject.minXAttr=f[3]+e[g.pos];h.dragObject.maxXAttr=f[1]+e[g.pos]-c[g.offsetSize]}else{f[0]=h._parseValue(d[0],"fix");f[2]=h._parseValue(d[1],"fix")+c[g.offsetSize];f[1]=c.clientWidth;h.dragObject.minXAttr=h.dragObject.maxXAttr=e.left;h.dragObject.minYAttr=f[0]+e[g.pos];h.dragObject.maxYAttr=f[2]+e[g.pos]-c[g.offsetSize]}},_syncTarget:function(d){var c=this;if(!c.targetEl){return}d=typeof d=="undefined"?c.value:d;c.targetEl.value=(d).toFixed(0)},update:function(d){var e=this,c=e.el;d=d||{};b.mix(e,d);e._updateDragRange();if(e.fireEvent("beforeupdate",e)!==false){e._syncTarget();e._syncThumb();e.fireEvent("update")}},setValue:function(c){var d=this;var e=d._adjustValue(c);if(d.value!=e){d.value=e;d.fireEvent("change")}},_syncThumb:function(){var c=this;c.getThumb().style[c._axis[c.orientation].pos]=c._parseValue(c.value,"pix")+"px"},_adjustValue:function(c){c=Number(c);return Math.max(Math.min(c,this.range[1]),this.range[0])},_calcValue:function(d){var c=this;return c._adjustValue(c._parseValue(d,"value"))},_parseValue:function(f,d){var e=this,c=e._axis[e.orientation];len=e.el[c.clientSize]-e.dom.thumb[c.offsetSize];if(d=="value"){f=(e.max-e.min)/len*f+e.min}else{f=Math.round(len/(e.max-e.min)*(f-e.min))}return f},getValue:function(){return this.value},getThumb:function(){var c=this;c.dom=c.dom||{};c.dom.thumb=c.dom.thumb||c.$el.find("."+this.thumbCls)[0];return c.dom.thumb},disable:function(){var c=this;c.disabled=true;c._updateDragRange([c.value,c.value])},enable:function(){var c=this;c.disabled=false;c._updateDragRange(c.range)},beforeDestroy:function(){var c=this;if(c.$targetEl){c.$targetEl.off(".slider");delete c.targetEl;delete c.$targetEl}if(c.dragObject){c.dragObject.destroy();delete c.dragObject}}});b.Slider=a})();(function(){var a=window.Zving;a.Slider$progressBar={progressbarTpl:'<div style="position:absolute;" class="z-slider-progressbar" id="{id}-progressbar-wrap"></div>',init:function(c){var b=this;c._adjustProgressbar=this._adjustProgressbar;c.on("afterrender",function(){c.getThumb().insertAdjacentHTML("beforeBegin",a.String.tmpl(b.progressbarTpl,{id:c.id}));c.progressBar=new a.ProgressBar({id:c.id+"_progressbar",orientation:c.orientation,baseCls:"z-slider-followProgressbar"});c.progressBar.render(a.getDom(c.id+"-progressbar-wrap"));c._adjustProgressbar();c.on("distroy",function(){c.progressBar.distroy()})});c.on("slide",function(){c._adjustProgressbar()});c.on("slideclick",function(){c._adjustProgressbar()});c.on("update",function(){c._adjustProgressbar()})},_adjustProgressbar:function(){var f=this,c=f.orientation,d=f._axis[c],b=f.getThumb(),e=parseInt(b.style[d.pos],10);if(!f.progressBar){return}f.progressBar.getBar().style[f.progressBar.axis[c].size]=(isNaN(e)?0:e)+b[d.offsetSize]/2+"px"}}})();(function(){var a=window.Zving;a.Slider$tip=a.Class.extend(a.Tip,{minWidth:10,offsets:[0,-10],init:function(b){b.on("slidestart",this.onSlide,this);b.on("slide",this.onSlide,this);b.on("slidestop",this.hide,this);b.on("destroy",this.destroy,this)},onSlide:function(b){this.show();this.body.innerHTML=this.getText(b);this.doAutoWidth();this.el.alignTo(b.thumb,"b-t?",this.offsets)},getText:function(b){return String(b.getValue())}})})();(function(){var b=window.Zving,a;a=function(c){this.defaultConfig={_scrollBarSize:{width:0,height:0}};if(!(this instanceof a)){return b.ComponentManager.getByDom(b.getDom(c),"ScrollBar")}this.outerElAttrs={tag:"div",cls:"scrollbar-"+(c.orientation||this.orientation),ztype:"ScrollBar",onselectstart:"return false"};a.superclass.constructor.apply(this,arguments);this.addEvents("scrollstart","scroll","scrollstop","beforeupdate","update");this.orientation=this.orientation.toLowerCase()};a.htmlTemplate='<div class="z-scrollbar-prev scrollbar-{orientation}-prev"></div><div class="z-scrollbar-track scrollbar-{orientation}-track" id="{id}_track">    <div style="position:relative;" class="z-scrollbar-slider scrollbar-{orientation}-slider" id="{id}_slider">        <div style="position: absolute;" class="z-scrollbar-slider-thumb scrollbar-{orientation}-slider-thumb" id="{id}_slider_thumb">            <div class="z-scrollbar-thumb-btn scrollbar-{orientation}-thumb-btn">                <div class="z-scrollbar-thumb-prev scrollbar-{orientation}-thumb-prev"></div>                <div class="z-scrollbar-thumb-track scrollbar-{orientation}-thumb-track"></div>                <div class="z-scrollbar-thumb-next scrollbar-{orientation}-thumb-next"></div>            </div>        </div>    </div></div><div class="z-scrollbar-next scrollbar-{orientation}-next"></div>';b.Class.extend(a,b.UICompBase,{ctype:"ScrollBar",cls:"z-scrollbar",renderTpl:a.htmlTemplate,orientation:"v",value:0,dimension:10,step:2,onscroll:null,_axis:{h:{size:"width",unSize:"height",offsetSize:"offsetWidth",unOffsetSize:"offsetHeight",clientSize:"clientWidth",scrollPos:"scrollLeft",scrollSize:"scrollWidth"},v:{size:"height",unSize:"width",offsetSize:"offsetHeight",unOffsetSize:"offsetWidth",clientSize:"clientHeight",scrollPos:"scrollTop",scrollSize:"scrollHeight"}},initRenderData:function(){return b.mixIf(this.renderData,{id:this.id,cls:this.cls,orientation:this.orientation})},afterRender:function(){var j=this,f=j._axis[j.orientation],c=j.el,h,g,e;j.dom=j.dom||{};j.dom.prev=j.$el.find(".z-scrollbar-prev")[0];j.dom.next=j.$el.find(".z-scrollbar-next")[0];var d=function(){var m=this,k=Math.round(m.getValue());if(j.targetEl){j.scrollTarget(k)}j.fireEvent("scroll",k);if(j.onscroll){j.onscroll.call(j,k)}};g=j._slider=new b.Slider({thumbCls:"z-scrollbar-slider-thumb",orientation:j.orientation,el:b.getDom(j.id+"_track"),initFromExistEl:true});g.on("slidestart",function(){j.fireEvent("scrollstart")});g.on("slide",d);g.on("slidestop",function(){j.fireEvent("scrollstop")});g.on("slideclick",d);j._scrollBarSize[f.unSize]=j.dom.next[f.unOffsetSize];j.dom.thumbButton=j.$el.find(".z-scrollbar-thumb-btn")[0];j.flushUI(j.value,j.dimension);j.initTarget()},initTarget:function(){var c=this,d=c.getTarget();if(!d){return}c.update();if(c.orientation=="v"){c._registMouseWheelEvt(d)}},scrollTarget:function(e){var d=this,f=d.getTarget(),c=d._axis[d.orientation];f[c.scrollPos]=e/100*(f[c.scrollSize]-f[c.clientSize])},flushUI:function(m,g){if(!isNumber(g)){return}var k=this,f=k._axis[k.orientation],j=k.dom.prev[f.offsetSize]+k.dom.next[f.offsetSize],h=k.el,d=k._slider,c=d.getThumb(),e;k.$el.hide();e=k.getContainerEl()[f.clientSize];k._scrollBarSize[f.size]=(e<=0)?j:e;d.getContainerEl().style[f.size]=(e<=0?0:e-j)+"px";c.style[f.size]=Math.max(Math.min(g,100),0)+"%";k.$el.show();k._scrollTo(m)},_scrollTo:function(c){this._slider.update({value:c})},scrollTo:function(d){var c=this;d=Math.min(Math.max(d,0),100);c._scrollTo(d);if(c.targetEl){c.scrollTarget(d)}c.fireEvent("scroll",{value:d})},_basicScroll:function(e){var d=this;var c=Math.pow(d.dimension/100,d.step)*100;d.scrollTo(d._slider.getValue()+(e=="prev"?-c:c))},_onMouseWheelHandler:function(c){var e=this,f=e.targetEl;c=c.originalEvent||c;var d=c.detail||-c.wheelDelta;b.Event.preventEvent(c);e._basicScroll(d>0?"next":"prev")},_registMouseWheelEvt:function(f){var d=this,e=function(){return"onmousewheel" in window&&"onmousewheel" in document?"mousewheel":"DOMMouseScroll"},c=d._mouseWheelEvent={targetEl:f,evtName:e(),handler:$.proxy(d._onMouseWheelHandler,d)};$(c.targetEl).on(c.evtName,c.handler)},_cancelMouseWheelEvt:function(){var c=this._mouseWheelEvent;if(!c){return}$(c.targetEl).off(c.evtName,c.handler);this._mouseWheelEvent=null},setVisible:function(c){this.getContainerEl().style.display=c?"":"none"},isVisible:function(){return this.getContainerEl().style.display!="none"},getSize:function(){return this._scrollBarSize},update:function(c){var d=this;d.fireEvent("beforeupdate");b.mix(d,c);d.restoreTarget();d.flushUI(d.value,d.dimension);d.fireEvent("update")},restoreTarget:function(){var d=this,c=d._axis[d.orientation],e=d.getTarget();if(!e){return}d.dimension=Math.round(e[c.clientSize]/e[c.scrollSize]*100);d.value=e[c.scrollSize]-e[c.clientSize];if(d.value>0){d.value=Math.round(e[c.scrollPos]/(e[c.scrollSize]-e[c.clientSize])*100)}},_adjustValue:function(){var d=this,c=d.range;d.value=Math.max(Math.min(d.value,c[1]),c[0])},_calcValue:function(d){var c=this;c.value=c._parseValue(d,"value");c._adjustValue()},_parseValue:function(f,d){var e=this,c=e._axis[e.orientation];len=e.el[c.clientSize]-e.dom.thumb[c.offsetSize];if(d=="value"){f=(e.max-e.min)/len*f+e.min}else{f=Math.round(len/(e.max-e.min)*(f-e.min))}return f},getValue:function(){return this.value},getThumb:function(){return this.$el.find("."+this.thumbCls)[0]},getTarget:function(){var c=this;c.targetEl=c.targetEl||c.target;delete c.target;if(typeof c.targetEl=="string"){c.targetEl=b.getDom(c.targetEl)}return c.targetEl},disable:function(){var c=this;c.disabled=true;c._updateDragRange([c.value,c.value])},enable:function(){var c=this;c.disabled=false;c._updateDragRange(c.range)},onDestroy:function(){this._cancelMouseWheelEvt();this._slider.destroy()}});b.ScrollBar=a})();
/*! ScrollPanel */
(function(){var c=window.Zving,b=c.Node,a;if(c.isWebKit){c.importCss("resources/scrollbar.css")}a=function(d,e){if(!(this instanceof a)){return c.ComponentManager.getByDom(c.getDom(d),"ScrollPanel")}if(!e&&(c.isIE6||c.isWebKit)){this.resume=function(){};return}d.targetEl=d.targetEl||d.target;delete d.target;if(typeof d.targetEl=="string"){d.targetEl=c.getDom(d.targetEl)}a.superclass.constructor.apply(this,arguments);c.EventManager.onWindowResize(this.update,this);$window.on("unload",function(){c.EventManager.removeResizeListener(this.update,this)})};a.htmlTemplate='<div class="z-scrollpanel-outer" id="{id}-outer"><div class="z-scrollpanel-main" id="{id}-main">  <div class="z-scrollpanel-panel" id="{id}-panel">      <!-- content container -->      <div class="z-scrollpanel-overflow-x" id="{id}-overflow-x">          <!-- new ScrollBar h -->      </div>  </div>  <div class="z-scrollpanel-overflow-y" id="{id}-overflow-y">      <!-- new ScrollBar v -->  </div></div></div>';c.Class.extend(a,c.UICompBase,{ctype:"ScrollPanel",renderTpl:a.htmlTemplate,adaptive:true,overflow:"y",_scrollBarSize:0,_yVisible:false,_xVisible:false,_axis:{y:{size:"height",unSize:"width",unScrollSize:"scrollWidth",unClientSize:"clientWidth",offsetSize:"offsetHeight",unOffsetSize:"offsetWidth"},x:{size:"width",unSize:"height",unScrollSize:"scrollHeight",unClientSize:"clientHeight",offsetSize:"offsetWidth",unOffsetSize:"offsetHeight"}},initComponent:function(){var d=this;d.addEvents("scroll","beforeupdate","update");a.superclass.initComponent.apply(this);d.targetEl=d.targetEl||d.target;delete d.target;if(d.el){d.initDom()}else{if(d.targetEl){if(c.Page.onLayout&&!c.Layout.haslayout){c.Page.onLayout(function(){if(!d.rendered){d.render(d.targetEl.parentNode,d.targetEl)}else{if(d.el.clientWidth==0&&d.container.clientWidth==0){return}d.update()}})}else{d.render(d.targetEl.parentNode,d.targetEl)}}}},resume:function(d){var e=this;c.mix(e,d);e.targetEl=c.getDom(d.targetEl);if(b.hasClass(e.targetEl.parentNode,"z-scrollpanel-panel")){e._smartVisible()}else{e.rendered=false;e.render(e.targetEl.parentNode,e.targetEl)}},initDom:function(){var g=this,f=g.getOuter(),d=g.getPanel(),j=g.getTarget();if(!g.adaptive){g.el.style.width=j.offsetWidth+"px";g.el.style.height=j.offsetHeight+"px"}f.style.width=j.style.width=j.offsetWidth+"px";f.style.height=j.style.height=j.offsetHeight+"px";if(g.overflow=="x"){j.style.overflowX="hidden"}else{if(g.overflow=="y"){j.style.overflowY="hidden"}else{j.style.overflow="hidden"}}var e=j.scrollTop;d.insertBefore(j,c.getDom(g.id+"-overflow-x"));j.scrollTop=e;function h(q){var m=c.getDom(g.id+"-overflow-"+q),n=g._axis[q],k=g.getPanel(),o;if("y"==q){b.setStyle(k,"float","left");b.setStyle(m,"float","left")}g["_"+q+"Visible"]=true;o=g["_"+q+"ScrollBar"]=new c.ScrollBar({orientation:q=="y"?"v":"h",targetEl:g.targetEl,renderTo:m});m.style[n.unSize]=o.getSize()[n.unSize]+"px";g._scrollBarSize=o.getSize()[n.unSize];o.setVisible(false);var p;o.on("scrollstart",function(){if(p){window.clearTimeout(p)}g.addClass("scrollpanel_active")});o.on("scrollstop",function(){p=window.setTimeout(function(){g.removeClass("scrollpanel_active")},200)});o.on("beforedestroy",function(){if(p){window.clearTimeout(p)}})}if(/(x|auto)$/.test(g.overflow)){h("x")}if(/(y|auto)$/.test(g.overflow)){h("y")}g._smartVisible();return g},afterRender:function(){this.initDom();this._adaptiveInit()},_smartVisible:function(){var f=this,e={yshow:false,xshow:false};if(!f.getTarget()){return}function g(j){var m=f._axis[j],n=f["_"+j+"ScrollBar"],o=f.getTarget(),k={};if(!n||!n.isVisible()){o.style[m.unSize]=Math.max(o[m.unClientSize],f._scrollBarSize)-f._scrollBarSize+"px"}k[m.unSize]=o[m.unClientSize];k["scroll"+m.unSize]=o[m.unScrollSize];return k}function h(j,k){var m=f._axis[j],n=f.getTarget();if(!f["_"+j+"Visible"]||!k[j+"show"]||!f["_"+j+"ScrollBar"]){n.style[m.unSize]=Math.max(n[m.unClientSize],f._scrollBarSize)+f._scrollBarSize+"px"}}function d(j,m){var n=f._axis[j],o=f.getTarget(),p=f["_"+j+"ScrollBar"],k=m[j+"show"];if(p){p.getContainerEl().style[n.size]=o[n.offsetSize]+"px";p.setVisible(f["_"+j+"Visible"]?k:false);p.update()}}c.mix(e,g("y"));c.mix(e,g("x"));if(e.scrollwidth<=e.width+f._scrollBarSize&&e.scrollheight<=e.height+f._scrollBarSize){e.yshow=e.xshow=false}else{if(e.scrollwidth<=e.width&&e.scrollheight>e.height+f._scrollBarSize){e.yshow=true;e.xshow=false}else{if(e.scrollwidth>e.width+f._scrollBarSize&&e.scrollheight<=e.height){e.yshow=false;e.xshow=true}else{e.yshow=e.xshow=true}}}h("y",e);h("x",e);d("y",e);d("x",e)},setScrollBarVisible:function(e,f){var d=this;if(f){d["_"+f+"Visible"]=e}else{d._yVisible=d._xVisible=e}d._smartVisible()},isScrollBarVisible:function(e){var d=this;return d["_"+e+"Visible"]},getScrollBar:function(f){var e=this,d=f?e["_"+f+"ScrollBar"]:null;if(!d){d=(e._yScrollbar&&e._xScrollbar)?[e._yScrollbar,e._xScrollbar]:(e._yScrollbar||e._xScrollbar)}return d},_adaptiveInit:function(){if(!this.adaptive){return}var f=this;var e=100,d=f.el,h=f.getTarget(),g={w:d.clientWidth,h:d.clientHeight};var j=setInterval(function(){var k=f.el,o=g,n;if(o.w==k.clientWidth&&o.h==k.clientHeight){return}n=g={w:k.clientWidth,h:k.clientHeight};function m(p){var r=f["_"+p+"Scrollbar"],q=f._axis[p],t=r?r.isVisible():false,s=k[q.unClientSize]-h[q.unOffsetSize];return(t&&s==f._scrollBarSize)||(!t&&s==0)}if(m("y")&&m("x")){return}f.flushBounds()},e);f.on("beforedestroy",function(){clearInterval(j)})},flushBounds:function(h){var g=this,e=g.el,f=g.getOuter(),d=g.getPanel(),k=g.getTarget();var j={y:g._yVisible,x:g._xVisible},m={w:h&&c.isNumber(h.width)?h.width:e.clientWidth,h:h&&c.isNumber(h.height)?h.height:e.clientHeight};g.setScrollBarVisible(false);f.style.width=k.style.width=m.w+"px";f.style.height=k.style.height=m.h+"px";g._yVisible=j.y;g._xVisible=j.x;g._smartVisible()},update:function(d){var e=this;c.mix(e,d||{});e._smartVisible()},getOuter:function(){return c.getDom(this.id+"-outer")},getMain:function(){return c.getDom(this.id+"-main")},getPanel:function(){return c.getDom(this.id+"-panel")},getTarget:function(){var d=this;d.targetEl=d.targetEl||d.target;delete d.target;return c.getDom(d.targetEl)},onDestroy:function(){var e=this,d=e._yScrollbar,f=e._xScrollbar;if(e.el){e.el.parentNode.insertBefore(e.getTarget(),e.el)}if(d){d.destroy()}if(f){f.destroy()}delete this.targetEl;c.Dom.removeNode(e.getOuter())}});c.ScrollPanel=a})();
/*! NumberField */
(function(){var c=window.Zving,b=c.Node,a;a=function(d){if(!(this instanceof a)){return c.ComponentManager.getByDom(c.getDom(config),"NumberField")}this.constructor.superclass.constructor.call(this,d);this.targetEl=this.targetEl||this.target;delete this.target;var e=this.targetEl;this.$targetEl=$(e);this.minValue=Number(e.getAttribute("min"))||0;if(e.getAttribute("min")=="-"){this.minValue=-9999999999999998}this.maxValue=Number(e.getAttribute("max"))||9999999999999998;this.step=Number(e.getAttribute("step"))||1;this.container=e.parentNode;this.render();this.initEvents()};a.triggerTpl='<span class="z-spinner"><span class="z-spinner-ct"><a style="cursor:pointer" class="z-spinner-up"><b></b></a><a style="cursor:pointer" class="z-spinner-down"><b></b></a></span></span>';c.Class.extend(a,c.UICompBase,{ctype:"NumberField",allowDecimals:true,triggerTpl:a.triggerTpl,spinUpEnabled:true,spinDownEnabled:true,initComponent:function(){var d=this;this.constructor.superclass.initComponent.call(this);this.addEvents("spin","spinup","spindown")},initFromDom:function(d){return{targetEl:c.getDom(d)}},onRender:function(){var d=this;var f=d.targetEl;if(!f.nextSibling||f.nextSibling.tagName!=="SPAN"||f.nextSibling.className.indexOf("z-spinner")==-1){f.insertAdjacentHTML("afterEnd",d.triggerTpl)}d.el=f.nextSibling;this.ownerDocument=f.ownerDocument;this.ownerWindow=f.ownerDocument.parentWindow;d.$el=this.ownerWindow.$(d.el);this.targetEl._components=this.targetEl._components||{};this.targetEl._components[this.ctype]=this.id;var e="\\d";if(d.allowDecimals){e+="\\."}if(d.minValue<0){e+="\\-"}d.maskRe=new RegExp("["+e+"]");d.stripCharsRe=new RegExp("[^"+e+"]","gi");d.$spinUpEl=d.$el.find("a.z-spinner-up");d.$spinDownEl=d.$el.find("a.z-spinner-down");if(f.disabled){d.disable()}},initEvents:function(){var d=this;d.$targetEl.on("keydown",function(e){if(e.keyCode==38){d.spinUp()}if(e.keyCode==40){d.spinDown()}});d.$targetEl.on("focus",function(e){d.hasFocus=true});d.$targetEl.on("blur",function(e){this.value=this.value.replace(d.stripCharsRe,"");if(this.value){this.value=Math.max(d.minValue,Math.min(d.maxValue,(Number(this.value)||0)))}d.hasFocus=false});d.$targetEl.on("mousewheel",function(e,f){if(d.hasFocus){if(f>0){d.spinUp()}else{if(f<0){d.spinDown()}}e.preventDefault();e.stopPropagation()}});d.$targetEl.on("keyup",function(e){if(e.ctrlKey===false){if(e.which>=48&&e.which<=111||e.which==32||e.which>=186&&e.which<=221){this.value=this.value.replace(/[^\d\.\-]/g,"");if(this.value&&/\d/.test(this.value)){this.value=Math.max(d.minValue,Math.min(d.maxValue,(Number(this.value)||0)))}}}});d.spinUpRepeater=new d.ownerWindow.Zving.Util.ClickRepeater(d.$spinUpEl.get(0),{onClick:function(){d.spinUp()},onMouseUp:function(){d.targetEl.focus()}});d.spinDownRepeater=new d.ownerWindow.Zving.Util.ClickRepeater(d.$spinDownEl.get(0),{onClick:function(){d.spinDown()},onMouseUp:function(){d.targetEl.focus()}})},spinUp:function(){var d=this;if(d.spinUpEnabled&&!d.disabled){d.fireEvent("spin",d,"up");d.fireEvent("spinup",d);d.onSpinUp()}},spinDown:function(){var d=this;if(d.spinDownEnabled&&!d.disabled){d.fireEvent("spin",d,"down");d.fireEvent("spindown",d);d.onSpinDown()}},setSpinUpEnabled:function(d){var e=this,f=e.spinUpEnabled;e.spinUpEnabled=d;if(f!==d&&e.rendered){e.$spinUpEl[d?"removeClass":"addClass"]("z-spinner-disabled")}},setSpinDownEnabled:function(d){var e=this,f=e.spinDownEnabled;e.spinDownEnabled=d;if(f!==d&&e.rendered){e.$spinDownEl[d?"removeClass":"addClass"]("z-spinner-disabled")}},onSpinUp:function(){var d=this;if(!d.readOnly){d.targetEl.value=Math.max(d.minValue,Math.min(d.maxValue,(Number(d.targetEl.value)||0)+d.step));d.$targetEl.trigger("change")}},onSpinDown:function(){var d=this;if(!d.readOnly){d.targetEl.value=Math.max(d.minValue,Math.min(d.maxValue,(Number(d.targetEl.value)||0)-d.step));d.$targetEl.trigger("change")}},disable:function(d){var e=this;if(this.rendered){e.setSpinUpEnabled(false);e.setSpinDownEnabled(false);this.targetEl.disabled=true}this.disabled=true;if(d!==true){this.fireEvent("disable",this)}return this},enable:function(d){var e=this;if(this.rendered){e.setSpinUpEnabled(true);e.setSpinDownEnabled(true);this.targetEl.disabled=false}this.disabled=false;if(d!==true){this.fireEvent("enable",this)}return this},beforeDestroy:function(){this.$targetEl.off();this.spinUpRepeater.destroy();this.spinDownRepeater.destroy();this.$spinUpEl.off();this.$spinDownEl.off();delete this.targetEl;delete this.$targetEl;delete this.$spinUpEl;delete this.$spinDownEl;delete this.spinUpRepeater;delete this.spinDownRepeater}});c.NumberField=a;c.importCss("resources/numberfield.css")})();(function(){var f=window.Zving;f.$G=f.getDom;f.$T=f.getByTag;f.$N=f.getByName;if(f.Node){f.$V=f.Node.getValue;f.$S=f.Node.setValue}f.$NV=f.getValues;f.$NS=f.setValues;f.$F=f.getForm;if(!f.Config.namespace||f.Config.namespace==="window"){var b,h=[];var g=/^(\$|Object|Class|Array|Date|Function|String|Node|Event|JSON|Storage|Comment)$/;for(b in f){if(typeof(f[b])==="undefined"||/^(id|g)$/.test(b)){continue}if(typeof(window[b])!=="undefined"){if(!g.test(b)){h.push("retouch.js -- "+b+" existed in window")}else{if(g.test(b)&&typeof(f[b])==="object"){f.mixIf(window[b],f[b])}}}else{try{window[b]=f[b]}catch(e){throw e}}}if(h.length&&f.Console){f.Console.silence=true;f.Console.error(h.join("<br>"))}}else{if(f.Config.namespace!=="Zving"){window[f.Config.namespace]=f}}if(!window.console.dir){window.console.dir=function(n){if(!/object/.test(Object.prototype.toString.call(n))){return console.log("console can`t dir the arg")}for(var m in n){console.log(m,": ",n[m])}}}if(f.Config.ignoreErrors=="true"){window.onerror=function(){return false}}$window.on("unload",function(){if(f.ComponentManager){f.ComponentManager._unload()}if(f.AllDocumentsEvent){f.AllDocumentsEvent._unload()}var m=jQuery.cache;var o,n=[];for(var p in jQuery.cache){if(m[p].handle&&(o=m[p].handle.elem)){if(o.nodeName&&o.nodeType==1){n.push(o)}}}n=null;f.rootWin=f.rootDoc=null;$document.off();$window.off()});var k=f.Cookie.get("zcms_skin");if(k){var j=document.getElementsByTagName("link");for(var d=0,c=j.length;d<c;d++){var a=j[d].href;if(a&&a.endsWith(f.CONTEXTPATH+"style/default.css")){f.Config.skin=k;f.importCSS("../style/"+k+"/default.css");break}}}})();Zving.Skin={};Zving.Skin.Supported="zvingclassic,zvinggreen,zvingdeep,zvingpurple,zvingred";Zving.Lang=Zving.Lang||{};Zving.Lang.Supported="en,zh-cn,zh-tw";Zving.Lang.DefaultLanguage="zh-cn";