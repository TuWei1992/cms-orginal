/*!  Zving JS library mergedfile  
* compress at 2014-11-28 
*/
(function(){var c=window.Zving,b=c.getDom;var a=function(h,j){var g=b(h);if(!g){return}var e=this;this.hiddenInput=b("cmt_ContentScore");this.viewRating=b(g).getElementsByTagName("LI")[0];this.links=b(g).getElementsByTagName("A");this.starWidth=this.links[0].offsetWidth;for(var f=0,d=this.links.length;f<d;f++){this.links[f].value=f+1;this.links[f].onclick=function(){e.setRate(this.value)};this.links[f].onmouseover=function(){for(var i=0;i<this.value;i++){e.links[i].className=e.links[i].className.replace(/ hcolor/g,"");e.links[i].className+=" hcolor"}for(var i=this.value;i<5;i++){e.links[i].className=e.links[i].className.replace(/ hcolor/g,"")}};this.links[f].onmouseout=function(){for(var i=0;i<this.value;i++){e.links[i].className=e.links[i].className.replace(/ hcolor/g,"")}}}if(j==undefined){this.setRate(this.hiddenInput.value)}else{this.setRate(j)}};a.prototype={setRate:function(e){this.hiddenInput.value=e;this.viewRating.style.width=e*this.starWidth+0+"px";if(this.hiddenInput.value!=0){for(var d=0;d<this.hiddenInput.value;d++){this.links[d].className=this.links[d].className.replace(/ select/g,"");this.links[d].className+=" select"}for(var d=this.hiddenInput.value;d<5;d++){this.links[d].className=this.links[d].className.replace(/ select/g,"")}}},getRate:function(){return this.hiddenInput.value}};c.Rating=a})();(function(){var j=window.Zving,d=j.loadJs,h=j.loadJsonp,b=j.Cookie,m=j.getDom;if(!window.localsForMessageBoard&&!window.localsForComment&&!window.localsForMebmer){return}window.localsForMebmer=window.localsForMebmer||{};var c;var l=function(r,p,q){var n;if(typeof r=="object"){n=r}else{n={UserName:r,Password:p,AuthCode:q||""}}if(!n.UserName||!n.Password){i.trigger("loginerror",Lang.get("Member.ErrorMsg.5"));return}var o=c.FrontAppContext+"member/ajaxlogin?action=login&SiteID="+(n.SiteID||c.SiteID);h(o,n,function(s){if(typeof s=="object"){if(!s.login){i.isNeedVerifyCode=true;i.getNewAuthCode();i.trigger("loginerror",s)}else{b.set("ZVING_MEMBER_LOGIN_Name",n.UserName);i.isLogined=n.UserName||true;i.trigger("logined",n.UserName)}}})};var f=function(){var n=c.FrontAppContext+"member/ajaxlogout?"+new Date().getTime();h(n,function(){b.remove("ZVING_MEMBER_LOGIN_Name");i.isLogined=false;i.trigger("logout")})};var e=function(){if($("#loginPanel").filter(":visible").length){return}$("#loginForm2").get(0).reset();$("#loginAuthCodeImg").css("backgroundImage","url("+CONTEXTPATH+"authCode.zhtml?Height=21&Width=50&"+new Date().getTime()+")");var n=$("#span_login").offset();if(n){n.left-=250;n.top=31}else{n={left:$window.width()/2-175,top:30}}$("#loginPanel").css({top:n.top+"px",left:n.left+"px"}).show();$(document).off("click.toggleloginpanel").on("click.toggleloginpanel",function(o){if(!$("#loginPanel,#span_login").find(o.target).length){$("#loginPanel").hide()}})};var g=function(p,o){var n=c.FrontAppContext+"member/logined?t="+new Date().getTime();h(n,function(q){if(q.IsLogin){if(!p||!o){Dialog.alert(Lang.get("Verify.HasError"));return}h(c.FrontAppContext+"memberFavorites/add?ID="+p+"&FavType="+o+"&t="+new Date().getTime(),function(r){Dialog.alert(r.message)})}else{Dialog.alert(Lang.get("Member.MustLogin"))}})};var k={};var i={jsonpLogin:l,jsonpLogout:f,showLoginPanel:e,register:function(){var o=c.FrontAppContext+"member/register?SiteID="+c.SiteID;var n=window.open(o,"_blank","");if(!n){Dialog.alert(c.Contentcore_WindowBlocked);return}},addEventListener:function(p,o){var n=k[p]=k[p]||[];n.push(o);return this},removeEventListener:function(q,p){var o=k[q];if(o&&o.length){var n=o.indexOf(p);if(n>-1){o.splice(n,1)}}return this},trigger:function(p,q){var o=k[p]||[];for(var n=0;n<o.length;n++){o[n](q)}return this},isLogined:false,addFavorites:g};i.Event=k;var a=new Image();a.onload=function(){i.trigger("authcodechange",a.src)};i.getNewAuthCode=function(){a.src=c.FrontAppContext+"authCode.zhtml?Height=21&Width=50&"+new Date().getTime()};i.needVerifyCode=function(o){var n=c.FrontAppContext+"member/needVerifyCode?UserName="+o;h(n,function(p){if(p){i.isNeedVerifyCode=true;i.getNewAuthCode();i.trigger("needverify")}else{i.isNeedVerifyCode=false;i.trigger("notneedverify")}})};i.isNeedVerifyCode=false;j.Member=i;$(window).load(function(){c=$.extend(window.localsForMebmer,window.localsForComment,window.localsForMessageBoard);if(c.SiteLink&&window.needRedirect){i.addEventListener("logined",function(o){window.location=c.SiteLink})}var n=c.FrontAppContext+"member/logined?timestamp="+new Date().getTime();h(n,function(o){if(typeof o!="undefined"&&o.IsLogin){i.isLogined=o.UserName;i.trigger("logined",o.UserName)}})})})();jQuery(function(w){var C=window.Zving,f=C.loadJs,s=C.loadJsonp,K=C.getDom,i=C.Member;if(!window.localsForComment){return}var A=false;var p=200;var B={suffix:"_reply",elIds:{commentContainer:"comment2",checkStar:"checkstar",checkMood:"checkMood",textarea:"cmt_content",counter:"cmt_content_count",checkbox:"cmt_CmntCheckbox",submitBtn:"cmtSubmit",loginContainer:"cmt_Login",username:"cmt_uname",password:"cmt_pass",authCode:"cmt_AuthCode",authImg:"cmt_authCodeImg",loginBtn:"cmt_frmbutton",commentCount:"cmt_commtotal",personCount:"cmt_commusertotal",registerBtn:"cmt_reg",parent:"cmt_ParentID",score:"cmt_ContentScore",logout:"cmt_logout",replyBox:"replyBox",replyBoxContainer:"commentLoginBox_reply",userNameLabel:"userNameLabel",loginedPanel:"cmt_Logined",logoutPanel:"cmt_Login",authCodeContainer:"authCodeContainer",loginFrm:"cmt_frm"}};var k=B.elIds,H;H=B.suffix;function x(){var M=K("commentLoginBox_reply"),z=K("commentLoginBox");if(M){var O=[];for(var L in k){if(k.hasOwnProperty(L)){O.push(k[L])}}var N=new RegExp("(\\s+id=(['\"]|))("+O.sort(function(Q,P){return P.length-Q.length}).join("|")+")(\\2)","gi");M.innerHTML=z.innerHTML.replace(N,function(Q,P,T,S,R){return P+S+H+R})}i.addEventListener("logined",function(P){c(P,true)});i.addEventListener("logout",function(){D(true)})}function D(N){var M=k.loginPanel,P=k.authCodeContainer,z=k.loginFrm,Q,L,O;if(N){M+=H;P+=H;z+=H}Q=K(M);L=K(P);O=K(z);O.reset();K(!N?k.loginedPanel:k.loginedPanel+H).style.display="none";K(!N?k.logoutPanel:k.logoutPanel+H).style.display="block";K(!N?k.authCodeContainer:k.authCodeContainer+H).style.display="none"}function c(L,z){w("#"+(!z?k.userNameLabel:k.userNameLabel+H)).html(L);K(!z?k.logoutPanel:k.logoutPanel+H).style.display="none";K(!z?k.loginedPanel:k.loginedPanel+H).style.display="block"}function g(){var L=localsForComment.FrontAppContext+"comment/count?contentid="+localsForComment.ContentID+"&timestamp="+new Date().getTime();s(L,function z(M){K(k.personCount).innerHTML=M.PersonTotal||0;K(k.commentCount).innerHTML=M.CommentTotal||0})}function j(P){var P=P||window.event,R=P.target||P.srcElement,O=k.username,N=k.password,L=k.authCode,M,Q=R.id!==k.loginBtn;if(Q){O=k.username+H;N=k.password+H;L=k.authCode+H}var z={UserName:K(O).value,Password:K(N).value};if(i.isNeedVerifyCode){z.AuthCode=K(L).value;z.IsVerifyCode=true}i.jsonpLogin(z)}function e(){i.jsonpLogout()}function t(L){if(A&&!i.isLogined){Dialog.alert(localsForComment.Comment_CommentLoginFirst);return false}var L=L||window.event,R=L.target||L.srcElement;var O=R.id!==k.submitBtn,z=k.textarea,S=k.checkbox,N=localsForComment.CommitUrl+"?ContentID="+localsForComment.ContentID+"&ContentType="+localsForComment.Catalog_ContentType+"&CatalogID="+localsForComment.CatalogID+"&SiteID="+localsForComment.SiteID,M;var P=null;if(O){z+=H;S+=H;P=w(R).closest("div.textCon").get(0)}M=K(z);if(M.value.trim()==""||M.value.trim()==localsForComment.Comment_CivilizedComments){Dialog.alert(localsForComment.Comment_CommentContentEmpty);M.focus();return false}else{if(M.value.length>p){Dialog.alert(localsForComment.Comment_ContentMore);return false}}var Q=M.value;N=N+"&CmntContent="+encodeURIComponent(M.value);N=N+"&CmntCheckbox="+K(S).checked;if(O){N=N+"&ParentID="+$V(k.parent+H)}else{N=N+"&ContentScore="+$V(k.score)}s(N,function T(U){if(!U.Status){Dialog.alert(U.Message);return}if(typeof addComment!=="undefined"){if(O){addCommentReply({addUser:K(S).checked?localsForComment.Comment_Anonymous:i.isLogined,content:Q,id:U.id||0,message:U.Message},P)}else{addComment({score:$V(k.score),addUser:K(S).checked?localsForComment.Comment_Anonymous:i.isLogined,content:Q,id:U.id||0,message:U.Message})}}else{if(U.Message){Dialog.alert(U.Message)}}w("#"+k.textarea+(O?H:"")).val("");w("#"+k.counter+(O?H:"")).html("0");if(O){K(k.replyBox).style.display="none"}})}var q=function(z){if(z.Status){b()}else{Dialog.alert(z.Message)}};var m=function(L){var z={CmntCheckbox:$V("#cmt_CmntCheckbox"),ContentID:localsForComment.ContentID,CatalogID:localsForComment.CatalogID,ContentType:localsForComment.ContentType,faceId:L};s(localsForComment.FrontAppContext+"CommentFaceVote/add",z,r.showresult)};function b(){var z={SiteID:localsForComment.SiteID,ContentID:localsForComment.ContentID,CatalogID:localsForComment.CatalogID};s(localsForComment.FrontAppContext+"comment/initFaceVote",z,r.showVote)}var o=function(O){var z="";var N=K("_zving_faceVote").innerHTML;for(var M=0;M<O.length;M++){var L={VoteResult:O[M].VoteResult,Percent:O[M].Percent,srcurl:localsForComment.Prefix+O[M].srcurl,VoteMood:O[M].VoteMood,faceId:O[M].faceId,Visibility:parseFloat(O[M].Percent)?"visible":"hidden"};z+=C.String.tmpl(N,(L))}K("ul_Moods").innerHTML=z};var E=function(L){var O=L.getAttribute("data");var N=K(k.parent+H);if(N){N.value=O}var M=K("reply_"+O);var z=K("replyBox");if(M.childNodes.length<1){M.appendChild(K("replyBox"));z.style.display="block"}else{z.style.display=z.style.display=="none"?"block":"none"}};commsupportData={};var J=function(M,z){var L=localsForComment.FrontAppContext+"comment/support?ID="+z+"&Type="+M;s(L,function(N){if(N.Message){Dialog.alert(N.Message)}if(N.CommSupport){var Q=N.Span;var P=K(Q);var O=P.innerHTML;if(O){P.innerHTML=Number(O)+1}else{P.innerHTML=1}}})};var r={reply:E,showVote:o,submitMoodInit:m,showresult:q,commentLogout:e,commSupport:J};window.Comment=r;A=window.localsForComment.IsNeedLogin===true||window.localsForComment.IsNeedLogin==="true";var n=K(k.commentContainer),d,I;if(!n){return}var v=localsForComment.CommentStartTime||"",a=localsForComment.CommentEndTime||"",F=new Date().getTime();v=v.length?DateTime.parseDate(v).getTime():Number.MIN_VALUE;a=a.length?DateTime.parseDate(a).getTime():Number.MAX_VALUE;if(v>F||F>a){return}n.style.display="block";if(d=K(k.checkStar)){d.style.display="block"}if(I=K("checkMood")){I.style.display="block"}g();new C.Rating("rating1");var h=K(k.replyBoxContainer);var G=[k.textarea];var y=[k.submitBtn];if(h){K(k.replyBox).style.display="none";x();K(k.replyBoxContainer).style.display="block";G.push(k.textarea+H);y.push(k.submitBtn+H)}var u=[k.loginBtn,k.loginBtn+H];u.forEach(function(L){var z=K(L);if(!z){return}w(z).on("click",j)});var l=[k.registerBtn,k.registerBtn+H];l.forEach(function(L){var z=K(L);if(!z){return}w(z).on("click",i.register)});var G=[k.textarea,k.textarea+H];G.forEach(function(L){var z=K(L);if(z){w(z).on("keyup",function(){var M=z.value.length;var N=K(z.id===k.textarea?k.counter:k.counter+H);N.innerHTML=M});w(z).on("click",function(){if(z.innerHTML==localsForComment.Comment_CivilizedComments){z.innerHTML=""}})}});y.forEach(function(L){var z=K(L);if(z){w(z).on("click",t)}});i.addEventListener("logined",c);i.addEventListener("logout",D);i.addEventListener("authcodechange",function(z){w("#"+k.authImg+",#"+k.authImg+H).css("background","url("+z+") no-repeat center center")});i.addEventListener("loginerror",function(){w("#"+k.authCodeContainer+",#"+k.authCodeContainer+H).show()});w("#"+k.authImg+",#"+k.authImg+H).click(function(){i.getNewAuthCode()});i.addEventListener("needverify",function(z){w("#"+k.authCodeContainer+",#"+k.authCodeContainer+H).show()}).addEventListener("notneedverify",function(z){w("#"+k.authCodeContainer+",#"+k.authCodeContainer+H).hide()});w("#"+k.username+",#"+k.username+H).change(function(){i.needVerifyCode(this.value)});b()});jQuery(function(d){var h=window.Zving,b=h.loadJs,e=h.loadJsonp,m=h.getDom,i=h.Member,c=200;if(!window.localsForMessageBoard){return}var l=false;var a={messageBoard:"msgBoard",contentInput:"msg_content",counter:"msg_contentCount",chkAnonymous:"msg_chkAnonymous",submitBtn:"msg_submit",loginContainer:"msg_loginContainer",username:"msg_username",password:"msg_password",authCode:"msg_authCode",authImg:"msg_authCodeImg",loginBtn:"msg_frmbutton",registerBtn:"msg_reg",userNameLabel:"msg_userNameLabel",loginedPanel:"msg_logined",logoutPanel:"msg_login",authCodeContainer:"msg_authCodeContainer",loginFrm:"msg_frm"};var f=function(q){var p=a.loginPanel,s=a.authCodeContainer,n=a.loginFrm,t,o,r;t=m(p);o=m(s);r=m(n);r.reset();m(a.loginedPanel).style.display="none";m(a.logoutPanel).style.display="block";m(a.authCodeContainer).style.display="none"},g=function(n){d("#"+a.userNameLabel).html(n);m(a.logoutPanel).style.display="none";m(a.loginedPanel).style.display="block"},k=function(s){var s=s||window.event,t=s.target||s.srcElement,r=a.username,q=a.password,o=a.authCode,p;var n={UserName:m(r).value,Password:m(q).value};if(i.isNeedVerifyCode){n.AuthCode=m(o).value;n.IsVerifyCode=true}i.jsonpLogin(n)},j=function(){var p=m(a.contentInput);var q=p.value.trim();if(l&&!i.isLogined){Dialog.alert(localsForMessageBoard.Messageboard_LoginFirst);return}else{if(q==""||q==localsForMessageBoard.Messageboard_CivilizedMessages){Dialog.alert(localsForMessageBoard.Messageboard_ContentEmpty);p.focus();return false}else{if(q.length>c){Dialog.alert(localsForMessageBoard.Messageboard_ContentMore);return false}}}var n={BoardID:localsForMessageBoard.Request_boardId,SiteID:localsForMessageBoard.SiteID,Content:q,Anonymous:m(a.chkAnonymous).checked};var o=localsForMessageBoard.FrontAppContext+"message/submit";e(o,n,function(r){if(r.error){Dialog.alert(r.error);return}if(!r.noDisplay){addMessage({content:q,addUser:n.Anonymous||!i.isLogined?localsForMessageBoard.Messageboard_Anonymous:i.isLogined,message:r.message});d("#"+a.contentInput).val("");m(a.counter).innerHTML="0"}})};if(!m(a.messageBoard)){return}l=localsForMessageBoard.IsNeedLogin=="true";d("#"+a.submitBtn).click(j);d("#"+a.registerBtn).click(i.register);d("#"+a.loginBtn).click(k);d("#"+a.contentInput).on("keyup",function(){var n=this.value.length;var o=m(a.counter);o.innerHTML=n}).on("click",function(){if(this.innerHTML==localsForMessageBoard.Messageboard_CivilizedMessages){this.innerHTML=""}});i.addEventListener("authcodechange",function(n){d("#"+a.authImg).css("background","url("+n+") no-repeat center center")});i.addEventListener("loginerror",function(){d("#"+a.authCodeContainer).show()});d("#"+a.authImg).click(function(){i.getNewAuthCode()});i.addEventListener("needverify",function(n){d("#"+a.authCodeContainer).show()}).addEventListener("notneedverify",function(n){d("#"+a.authCodeContainer).hide()});d("#"+a.username).change(function(){i.needVerifyCode(this.value)});i.addEventListener("logined",g).addEventListener("logout",f)});(function(){var f=window.Zving;f.$G=f.getDom;f.$T=f.getByTag;f.$N=f.getByName;if(f.Node){f.$V=f.Node.getValue;f.$S=f.Node.setValue}f.$NV=f.getValues;f.$NS=f.setValues;f.$F=f.getForm;f.importCss("zcms_components.css");if(!f.Config.namespace||f.Config.namespace==="window"){var b,h=[];var g=/^(\$|Object|Class|Array|Date|Function|String|Node|Event|JSON|Storage|Comment)$/;for(b in f){if(typeof(f[b])==="undefined"||/^(id|g)$/.test(b)){continue}if(typeof(window[b])!=="undefined"){if(!g.test(b)){h.push("retouch.js -- "+b+" existed in window")}else{if(g.test(b)&&typeof(f[b])==="object"){f.mixIf(window[b],f[b])}}}else{try{window[b]=f[b]}catch(e){throw e}}}if(h.length&&f.Console){f.Console.silence=true;f.Console.error(h.join("<br>"))}}else{if(f.Config.namespace!=="Zving"){window[f.Config.namespace]=f}}if(!window.console.dir){window.console.dir=function(l){if(!/object/.test(Object.prototype.toString.call(l))){return console.log("console can`t dir the arg")}for(var i in l){console.log(i,": ",l[i])}}}if(f.Config.ignoreErrors=="true"){window.onerror=function(){return false}}$window.on("unload",function(){if(f.ComponentManager){f.ComponentManager._unload()}if(f.AllDocumentsEvent){f.AllDocumentsEvent._unload()}var i=jQuery.cache;var m,l=[];for(var n in jQuery.cache){if(i[n].handle&&(m=i[n].handle.elem)){if(m.nodeName&&m.nodeType==1){l.push(m)}}}l=null;f.rootWin=f.rootDoc=null;$document.off();$window.off()});var k=f.Cookie.get("zcms_skin");if(k){var j=document.getElementsByTagName("link");for(var d=0,c=j.length;d<c;d++){var a=j[d].href;if(a&&a.endsWith(f.CONTEXTPATH+"style/default.css")){f.Config.skin=k;f.importCSS("../style/"+k+"/default.css");break}}}})();Zving.Skin={};Zving.Skin.Supported="zvingclassic,zvinggreen,zvingdeep,zvingpurple,zvingred";Zving.Lang=Zving.Lang||{};Zving.Lang.Supported="en,zh-cn,zh-tw";Zving.Lang.DefaultLanguage="zh-cn";