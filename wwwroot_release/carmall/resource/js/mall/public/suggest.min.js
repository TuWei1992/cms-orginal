(function(){var a={create:function(){return function(){this.initialize.apply(this,arguments)}}};Object.extend=function(e,f){for(property in f){e[property]=f[property]}return e};var c=a.create();Object.extend(Function.prototype,{bind:function(){var h=this,f=arguments[0],e=new Array();for(var g=1;g<arguments.length;g++){e.push(arguments[g])}return function(){return h.apply(f,e)}}});Object.extend(c.prototype,{initialize:function(){},Browser:{IE:!!(window.attachEvent&&navigator.userAgent.indexOf("Opera")===-1),Opera:navigator.userAgent.indexOf("Opera")>-1,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")===-1,MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/)},$:function(e){return typeof(e)=="string"?document.getElementById(e):e},$Tag:function(e){return typeof(e)=="string"?document.getElementsByTagName(e):e},$C:function(e){return document.createElement(e)},$E:function(f){tempObj=f.target?f.target:event.srcElement;return tempObj},$aE:function(i,h,f,e){if(i.addEventListener){i.addEventListener(h,f,e);return true}else{if(i.attachEvent){var g=i.attachEvent("on"+h,f);return g}else{i["on"+h]=f}}},$dE:function(i,h,f,e){if(i.removeEventListener){i.removeEventListener(h,f,e);return true}else{if(i.detachEvent){var g=i.detachEvent("on"+h,f);return g}else{i["on"+h]=null;return}}},stopBubble:function(f){if(!this.Browser.IE){f.stopPropagation()}else{window.event.cancelBubble=true}},stopDefault:function(f){if(!this.Browser.IE){f.preventDefault()}else{window.event.returnValue=false}},isNullorEmpty:function(e){if(e==null||e==""||e=="undefined"){return true}return false},getXY:function(g){var h=0;var f=0;var e;if(g.offsetParent){do{h+=g.offsetLeft;f+=g.offsetTop;if(this.getStyle(g,"position")=="relative"){if(e=this.getStyle(g,"border-top-width")){f+=parseInt(e)}if(e=this.getStyle(g,"border-left-width")){h+=parseInt(e)}break}}while(g=g.offsetParent)}else{if(g.x){h+=g.x;f+=g.y}}return{x:h,y:f}},getStyle:function(f,e){if(f.currentStyle){return f.currentStyle[e]}else{if(window.getComputedStyle){return document.defaultView.getComputedStyle(f,null).getPropertyValue(e)}}}});var b=new c();var d=a.create();Object.extend(d.prototype,{initialize:function(f,e){this.input=f;this.dataurl=b.isNullorEmpty(e.dataurl)?"":e.dataurl;if(!b.isNullorEmpty(e.dataurl)){this.dataurl=e.dataurl}this.link=b.isNullorEmpty(e.link)?"":e.link;this.opacity=b.isNullorEmpty(e.opacity)?1:e.opacity;this.className=b.isNullorEmpty(e.className)?"":e.className;this.max=b.isNullorEmpty(e.max)?10:e.max;this.text=b.isNullorEmpty(e.text)?"请输入搜索内容":e.text;this.body=b.isNullorEmpty(e.body)?[0]:e.body;this.target=b.isNullorEmpty(e.target)?"_blank":e.target;this.hotSearchList=b.isNullorEmpty(e.hotSearchList)?[]:e.hotSearchList;this.callback=(e.callback==null||e.callback=="undefined")?null:e.callback;this.results=null;this._D=null;this._F=null;this._requestCount=0;this._R=null;this._W=null;this._X={};this._Y={};this._hidden=false;this._iF=null;this._iN=null;this._iC=null;this._oForm=null;this._rInterval=-1;this.init()},init:function(){this._Y={key_:this.hotSearchList};this.input=typeof(this.input)=="string"?b.$(this.input):this.input;if(this.input){if(this._F==null){var f=this.input.parentNode;while(f.nodeName.toLowerCase()=="form"&&f.nodeName.toLowerCase()=="body"){f=f.parentNode}if(f.nodeName.toLowerCase()=="form"){this._oForm={action:f.action,target:f.target,method:f.method};this._F=f}else{this._F=b.$C("form");this._F.method="get";this.input.parentNode.insertBefore(this._F,this.input);var e=this.input;this.input.parentNode.removeChild(this.input);this._F.appendChild(e)}}this._F.input=this.input;this._F.onsubmit=function(){if(this.input.value==this.input.getAttribute("placeholder")){this.input.value=""}return true};this._F.style.position="relative";this._F.style.display="block";this._F.target=this.target;this._F.style.zIndex="19";this._F.style.width="100%";this._F.style.height="100%";this.input.setAttribute("autocomplete","off");this.input.autoComplete="off";this._iF=this._bd(this.inputFocus);this._iN=this._bd(this.Navigate);this._iC=this._bd(this.Confirm);b.$aE(this.input,"focus",this._iF);b.$aE(this.input,"blur",this._iF);b.$aE(this.input,"keyup",this._iN);b.$aE(this.input,"paste",this._iF);b.$aE(this.input,"keydown",this._iC);b.$aE(this.input,"mouseup",this._iN)}},dispose:function(){this._Y={};this.input=typeof(this.input)=="string"?b.$(this.input):this.input;if(this.input){if(this._oForm!=null){this._F.action=this._oForm.action;this._F.target=this._oForm.target;this._F.method=this._oForm.method}b.$dE(this.input,"focus",this._iF);b.$dE(this.input,"blur",this._iF);b.$dE(this.input,"keyup",this._iN);b.$dE(this.input,"paste",this._iF);b.$dE(this.input,"keydown",this._iC);b.$dE(this.input,"mouseup",this._iN)}},inputFocus:function(h){var f=this;var g=h.type;setTimeout(function(){if(f.input.value==f.text&&g.indexOf("focus")>=0){f.input.value="";f._U="";f.Suggest()}else{if(f.input.value==""&&g.indexOf("blur")>=0){f._U="";f.hiddenResults()}else{if(g.indexOf("blur")>=0){f.hiddenResults()}else{if(g.indexOf("paste")>=0){f.Suggest()}}}}},0)},nGourl:false,Navigate:function(f){switch(f.keyCode){case 13:this.nGourl=true;this.Submit();break;default:this.Suggest();break}},Confirm:function(f){switch(f.keyCode){case 38:b.stopDefault(f);this.nGourl=false;if(this.results!=null&&this.results.innerHTML!=""){this.setLine(this.results.firstChild.rows[(!this._W||this._W.rowIndex==1)?this.results.firstChild.rows.length-1:this._W.rowIndex-1])}break;case 40:this.nGourl=false;if(this.results!=null&&this.results.innerHTML!=""){this.setLine(this.results.firstChild.rows[(!this._W||this._W.rowIndex==this.results.firstChild.rows.length-1)?1:this._W.rowIndex+1])}break}},_bd:function(g,f){var e=this;return function(){var h=null;if(typeof f!="undefined"){for(var j=0;j<arguments.length;j++){f.push(arguments[j])}h=f}else{h=arguments}return g.apply(e,h)}},_gt:function(){return(new Date()).getTime()},Suggest:function(){var e=this.input.value;if(this._U!=e){this._U=e;if(e!=""){this._W&&(this._W=null);if(("key_"+e) in this._Y){this.Tip()}else{this.Tip();this._io(e,this._bd(this.Tip),this._bd(this.hiddenResults))}}else{if(this.results!=null&&this.results.innerHTML!=""){this._W=null}this.Tip()}}else{if(this.input.value==""){this.Tip()}this.setResults()}},setResults:function(){if(this.results!=null&&this.results.innerHTML!=""){this.results.style.display=""}},hiddenResults:function(){if(this._hidden==false){if(this.results!=null){if(this.input.value==""){this.results.innerHTML=""}this.results.style.display="none"}}},_io:function(f,i,h){if(this._R==null){this._R=b.$C("div");this._R.style.display="none";document.body.insertBefore(this._R,document.body.lastChild)}this._requestCount++;var e="jsonp"+this._gt();var g=b.$C("script");g._count=this._requestCount;g.type="text/javascript";g.charset="utf-8";g.src=this.dataurl.replace("{#NAME}",e).replace("{#KEY}",f);g._0j=this;if(i){g._0k=i}if(h){g._0l=h}g._0m=f;g._0n=e;window[g._0n]=function(k){var j=k;if(typeof j!="undefined"){g._0j._Y["key_"+g._0m]=j;if(g._count==g._0j._requestCount){g._0k(j)}}window[g._0n]=null};g[document.all?"onreadystatechange":"onload"]=function(){if(document.all&&this.readyState!="loaded"&&this.readyState!="complete"){return}this._0j=null;this._0m=null;this._0n=null;this[document.all?"onreadystatechange":"onload"]=null;this.parentNode.removeChild(this)};this._R.request=g;this._R.appendChild(g)},Submit:function(){var e=this.input.value;this._F.submit();this.hiddenResults()},setColor:function(f){var e="";if(f._0f&&f._0g){e="#f2f2f2"}else{if(f._0f){e="#f2f2f2"}else{if(f._0g){e="#f2f2f2"}}}if(f.style.backgroundColor!=e){f.style.backgroundColor=e}},setLine:function(i,h){var g=i.id.split(",");this._D=g;var f=g[0];this._U=f;this.input.value=f;if(this._W!=null){this._W._0f=false;this.setColor(this._W)}i._0f=true;this.setColor(i);this._W=i;if(this.nGourl){this.Submit()}},mouseoverLine:function(e){e._0g=true;this.setColor(e)},mouseoutLine:function(e){e._0g=false;this.setColor(e)},setLineMouse:function(e){this.nGourl=true;this.setLine(e);if(this.callback!=null){this.callback({code:this.input.value})}},hidepause:function(){this._hidden=true},hideresume:function(){this._hidden=false;this.hiddenResults()},setTip:function(){var g=0;var f=0;var k=this.input;do{g+=k.offsetTop||0;f+=k.offsetLeft||0;k=k.offsetParent}while(k);this.results.style.left="0";this.results.style.top="0";var e=this.input.style.borderTopWidth;var j=this.input.style.borderBottomWidth;var i=this.input.clientHeight;i+=e!=""?e.replace("px","")*1:1;i+=j!=""?j.replace("px","")*1:1;if(this.results.style.marginTop!=i+"px"){this.results.style.marginTop=i+"px"}var h=this.input.clientWidth;this.results.style.width=h+"px"},Tip:function(){var s=this.input.value;this.results&&(this.results.innerHTML="");if(("key_"+s) in this._Y&&this._Y["key_"+s]&&this._Y["key_"+s].length>0){if(this.results==null){this.results=b.$C("div");this.results.id="kk-suggest-result";this.results.style.zIndex="19";this.results.style.position="absolute";this.results.style.display="none";this.results.style.background="#000";if(this.className==""){this.results.style.border="1px solid #CCC"}else{this.results.className=this.className}this.input.parentNode.insertBefore(this.results,this.input);this.results.suggest=this}this.setTip();var u=b.$C("table");u.border="0";u.cellPadding="0";u.cellSpacing="0";u.style.lineHeight="25px";u.style.border="1px solid #FFF";u.style.background="#FFF";u.style.fontSize="12px";u.style.textAlign="left";u.style.textIndent="5px";u.style.color="#666";u.style.width="100%";u.style.position="relative";var l=b.$C("thead");var f=b.$C("tr");var r=b.$C("td");r.hidefocus="true";r.style.padding="1px";if(s==""){r.innerHTML="<b>热门搜索</b>"}else{r.innerHTML="<b>搜索结果</b>";f.style.display="none"}f.appendChild(r);l.appendChild(f);u.appendChild(l);var n=b.$C("tbody");this.results.body=n;var q=this._Y["key_"+s];var p=q.length>this.max?this.max:q.length;for(var k=0;k<p;k++){var m=q[k];var o=b.$C("tr");o.id=m.kw;o.style.cursor="pointer";o._oj=this;o.onmouseover=function(){this._oj.mouseoverLine(this)};o.onmouseout=function(){this._oj.mouseoutLine(this)};o.onmousedown=function(){return this._oj.hidepause(this)};o.onclick=function(){this._oj.setLineMouse(this);this._oj.hideresume(this)};for(var g=0;g<this.body.length;g++){var h=b.$C("td");h.hidefocus="true";h.style.padding="1px";var e=m[this.body[g]];if(g==0&&e.indexOf(s)==0){e=e.replace(s,'<span style="color:#FFC107;">'+s+"</span>")}h.innerHTML=e;o.appendChild(h)}n.appendChild(o)}u.appendChild(n);this.results.appendChild(u);this.setResults()}else{this.hiddenResults()}}});window.MallSuggest=d})();