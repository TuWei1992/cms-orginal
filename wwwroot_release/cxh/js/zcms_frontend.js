/*!  Zving JS library mergedfile  
* compress at 2015-01-04 
*/
(function(){var c=window.Zving,b=c.getDom;var a=function(h,j){var g=b(h);if(!g){return}var e=this;this.hiddenInput=b("cmt_ContentScore");this.viewRating=b(g).getElementsByTagName("LI")[0];this.links=b(g).getElementsByTagName("A");this.starWidth=this.links[0].offsetWidth;for(var f=0,d=this.links.length;f<d;f++){this.links[f].value=f+1;this.links[f].onclick=function(){e.setRate(this.value)};this.links[f].onmouseover=function(){for(var i=0;i<this.value;i++){e.links[i].className=e.links[i].className.replace(/ hcolor/g,"");e.links[i].className+=" hcolor"}for(var i=this.value;i<5;i++){e.links[i].className=e.links[i].className.replace(/ hcolor/g,"")}};this.links[f].onmouseout=function(){for(var i=0;i<this.value;i++){e.links[i].className=e.links[i].className.replace(/ hcolor/g,"")}}}if(j==undefined){this.setRate(this.hiddenInput.value)}else{this.setRate(j)}};a.prototype={setRate:function(e){this.hiddenInput.value=e;this.viewRating.style.width=e*this.starWidth+0+"px";if(this.hiddenInput.value!=0){for(var d=0;d<this.hiddenInput.value;d++){this.links[d].className=this.links[d].className.replace(/ select/g,"");this.links[d].className+=" select"}for(var d=this.hiddenInput.value;d<5;d++){this.links[d].className=this.links[d].className.replace(/ select/g,"")}}},getRate:function(){return this.hiddenInput.value}};c.Rating=a})();(function(){var j=window.Zving,d=j.loadJs,f=j.Server,b=j.Cookie,m=j.getDom;if(!window.localsForMessageBoard&&!window.localsForComment&&!window.localsForMebmer){return}window.localsForMebmer=window.localsForMebmer||{};var c;var l=function(q,o,p){var n;if(typeof q=="object"){n=q}else{n={UserName:q,Password:o,AuthCode:p||""}}if(!n.UserName||!n.Password){Dialog.alert(Lang.get("Member.ErrorMsg.5"));return}n.action="login";n.SiteID=n.SiteID||c.SiteID;f.sendRequest("member/ajaxlogin",n,function(r){if(typeof r=="object"){if(!r.login){i.isNeedVerifyCode=true;i.getNewAuthCode();i.trigger("loginerror",r)}else{b.set("ZVING_MEMBER_LOGIN_Name",n.UserName);i.isLogined=n.UserName||true;i.trigger("logined",n.UserName)}}})};var g=function(){var n=c.FrontAppContext+"member/ajaxlogout?"+new Date().getTime();f.sendRequest("member/ajaxlogout",{},function(){b.remove("ZVING_MEMBER_LOGIN_Name");i.isLogined=false;i.trigger("logout")})};var e=function(){if($("#loginPanel").filter(":visible").length){return}$("#loginForm2").get(0).reset();$("#loginAuthCodeImg").css("backgroundImage","url("+CONTEXTPATH+"authCode.zhtml?Height=21&Width=50&"+new Date().getTime()+")");var n=$("#span_login").offset();if(n){n.left-=250;n.top=31}else{n={left:$window.width()/2-175,top:30}}$("#loginPanel").css({top:n.top+"px",left:n.left+"px"}).show();$(document).off("click.toggleloginpanel").on("click.toggleloginpanel",function(o){if(!$("#loginPanel,#span_login").find(o.target).length){$("#loginPanel").hide()}})};var h=function(o,n){f.sendRequest("member/logined",{},function(p){if(p.IsLogin){if(!o||!n){Dialog.alert(Lang.get("Verify.HasError"));return}f.sendRequest("memberFavorites/add",{ID:o,FavType:n},function(q){Dialog.alert(q.message)})}else{Dialog.alert(Lang.get("Member.MustLogin"))}})};var k={};var i={jsonpLogin:l,jsonpLogout:g,showLoginPanel:e,register:function(){var o=c.FrontAppContext+"member/register?SiteID="+c.SiteID;var n=window.open(o,"_blank","");if(!n){Dialog.alert(c.Contentcore_WindowBlocked);return}},addEventListener:function(p,o){var n=k[p]=k[p]||[];n.push(o);return this},removeEventListener:function(q,p){var o=k[q];if(o&&o.length){var n=o.indexOf(p);if(n>-1){o.splice(n,1)}}return this},trigger:function(p,q){var o=k[p]||[];for(var n=0;n<o.length;n++){o[n](q)}return this},isLogined:false,addFavorites:h};i.Event=k;var a=new Image();a.onload=function(){i.trigger("authcodechange",a.src)};i.getNewAuthCode=function(){a.src=c.FrontAppContext+"authCode.zhtml?Height=21&Width=50&"+new Date().getTime()};i.needVerifyCode=function(n){f.sendRequest("member/needVerifyCode",{UserName:n},function(o){if(o){i.isNeedVerifyCode=true;i.getNewAuthCode();i.trigger("needverify")}else{i.isNeedVerifyCode=false;i.trigger("notneedverify")}})};i.isNeedVerifyCode=false;j.Member=i;$(window).load(function(){c=$.extend(window.localsForMebmer,window.localsForComment,window.localsForMessageBoard);if(c.SiteLink&&window.needRedirect){i.addEventListener("logined",function(n){window.location=c.SiteLink})}f.sendRequest("member/logined",{},function(n){if(typeof n!="undefined"&&n.IsLogin){i.isLogined=n.UserName;i.trigger("logined",n.UserName)}})})})();jQuery(function(w){var C=window.Zving,g=C.loadJs,d=C.Server,K=C.getDom,j=C.Member;if(!window.localsForComment){return}var A=false;var q=200;var B={suffix:"_reply",elIds:{commentContainer:"comment2",checkStar:"checkstar",checkMood:"checkMood",textarea:"cmt_content",counter:"cmt_content_count",checkbox:"cmt_CmntCheckbox",submitBtn:"cmtSubmit",loginContainer:"cmt_Login",username:"cmt_uname",password:"cmt_pass",authCode:"cmt_AuthCode",authImg:"cmt_authCodeImg",loginBtn:"cmt_frmbutton",commentCount:"cmt_commtotal",personCount:"cmt_commusertotal",registerBtn:"cmt_reg",parent:"cmt_ParentID",score:"cmt_ContentScore",logout:"cmt_logout",replyBox:"replyBox",replyBoxContainer:"commentLoginBox_reply",userNameLabel:"userNameLabel",loginedPanel:"cmt_Logined",logoutPanel:"cmt_Login",authCodeContainer:"authCodeContainer",loginFrm:"cmt_frm"}};var l=B.elIds,H;H=B.suffix;function x(){var M=K("commentLoginBox_reply"),z=K("commentLoginBox");if(M){var O=[];for(var L in l){if(l.hasOwnProperty(L)){O.push(l[L])}}var N=new RegExp("(\\s+id=(['\"]|))("+O.sort(function(Q,P){return P.length-Q.length}).join("|")+")(\\2)","gi");M.innerHTML=z.innerHTML.replace(N,function(Q,P,T,S,R){return P+S+H+R})}j.addEventListener("logined",function(P){c(P,true)});j.addEventListener("logout",function(){D(true)})}function D(N){var M=l.loginPanel,P=l.authCodeContainer,z=l.loginFrm,Q,L,O;if(N){M+=H;P+=H;z+=H}Q=K(M);L=K(P);O=K(z);O.reset();K(!N?l.loginedPanel:l.loginedPanel+H).style.display="none";K(!N?l.logoutPanel:l.logoutPanel+H).style.display="block";K(!N?l.authCodeContainer:l.authCodeContainer+H).style.display="none"}function c(L,z){w("#"+(!z?l.userNameLabel:l.userNameLabel+H)).html(L);K(!z?l.logoutPanel:l.logoutPanel+H).style.display="none";K(!z?l.loginedPanel:l.loginedPanel+H).style.display="block"}function h(){d.sendRequest("comment/count",{contentid:localsForComment.ContentID},function(z){K(l.personCount).innerHTML=z.PersonTotal||0;K(l.commentCount).innerHTML=z.CommentTotal||0})}function k(P){var P=P||window.event,R=P.target||P.srcElement,O=l.username,N=l.password,L=l.authCode,M,Q=R.id!==l.loginBtn;if(Q){O=l.username+H;N=l.password+H;L=l.authCode+H}var z={UserName:K(O).value,Password:K(N).value};if(j.isNeedVerifyCode){z.AuthCode=K(L).value;z.IsVerifyCode=true}j.jsonpLogin(z)}function f(){j.jsonpLogout()}function t(L){if(A&&!j.isLogined){Dialog.alert(localsForComment.Comment_CommentLoginFirst);return false}var L=L||window.event,R=L.target||L.srcElement;var O=R.id!==l.submitBtn,z=l.textarea,S=l.checkbox,N=localsForComment.CommitUrl+"?ContentID="+localsForComment.ContentID+"&ContentType="+localsForComment.Catalog_ContentType+"&CatalogID="+localsForComment.CatalogID+"&SiteID="+localsForComment.SiteID,M;var P=null;if(O){z+=H;S+=H;P=w(R).closest("div.textCon").get(0)}M=K(z);if(M.value.trim()==""||M.value.trim()==localsForComment.Comment_CivilizedComments){Dialog.alert(localsForComment.Comment_CommentContentEmpty);M.focus();return false}else{if(M.value.length>q){Dialog.alert(localsForComment.Comment_ContentMore);return false}}var Q=M.value;N=N+"&CmntContent="+encodeURIComponent(M.value);N=N+"&CmntCheckbox="+K(S).checked;if(O){N=N+"&ParentID="+$V(l.parent+H)}else{N=N+"&ContentScore="+$V(l.score)}loadJsonp(N,function T(U){if(!U.Status){Dialog.alert(U.Message);return}if(typeof addComment!=="undefined"){if(O){addCommentReply({addUser:K(S).checked?localsForComment.Comment_Anonymous:j.isLogined,content:Q,id:U.id||0,message:U.Message},P)}else{addComment({score:$V(l.score),addUser:K(S).checked?localsForComment.Comment_Anonymous:j.isLogined,content:Q,id:U.id||0,message:U.Message})}}else{if(U.Message){Dialog.alert(U.Message)}}w("#"+l.textarea+(O?H:"")).val("");w("#"+l.counter+(O?H:"")).html("0");if(O){K(l.replyBox).style.display="none"}})}var r=function(z){if(z.Status){b()}else{Dialog.alert(z.Message)}};var n=function(L){var z={CmntCheckbox:$V("#cmt_CmntCheckbox"),ContentID:localsForComment.ContentID,CatalogID:localsForComment.CatalogID,ContentType:localsForComment.ContentType,faceId:L};d.sendRequest("CommentFaceVote/add",z,s.showresult)};function b(){var z={SiteID:localsForComment.SiteID,ContentID:localsForComment.ContentID,CatalogID:localsForComment.CatalogID};d.sendRequest("comment/initFaceVote",z,s.showVote)}var p=function(O){var z="";var N=K("_zving_faceVote").innerHTML;for(var M=0;M<O.length;M++){var L={VoteResult:O[M].VoteResult,Percent:O[M].Percent,srcurl:localsForComment.Prefix+O[M].srcurl,VoteMood:O[M].VoteMood,faceId:O[M].faceId,Visibility:parseFloat(O[M].Percent)?"visible":"hidden"};z+=C.String.tmpl(N,(L))}K("ul_Moods").innerHTML=z};var E=function(L){var O=L.getAttribute("data");var N=K(l.parent+H);if(N){N.value=O}var M=K("reply_"+O);var z=K("replyBox");if(M.childNodes.length<1){M.appendChild(K("replyBox"));z.style.display="block"}else{z.style.display=z.style.display=="none"?"block":"none"}};commsupportData={};var J=function(L,z){d.sendRequest("comment/support",{ID:z,Type:L},function(M){if(M.Message){Dialog.alert(M.Message)}if(M.CommSupport){var P=M.Span;var O=K(P);var N=O.innerHTML;if(N){O.innerHTML=Number(N)+1}else{O.innerHTML=1}}})};var s={reply:E,showVote:p,submitMoodInit:n,showresult:r,commentLogout:f,commSupport:J};window.Comment=s;A=window.localsForComment.IsNeedLogin===true||window.localsForComment.IsNeedLogin==="true";var o=K(l.commentContainer),e,I;if(!o){return}var v=localsForComment.CommentStartTime||"",a=localsForComment.CommentEndTime||"",F=new Date().getTime();v=v.length?DateTime.parseDate(v).getTime():Number.MIN_VALUE;a=a.length?DateTime.parseDate(a).getTime():Number.MAX_VALUE;if(v>F||F>a){return}o.style.display="block";if(e=K(l.checkStar)){e.style.display="block"}if(I=K("checkMood")){I.style.display="block"}h();new C.Rating("rating1");var i=K(l.replyBoxContainer);var G=[l.textarea];var y=[l.submitBtn];if(i){K(l.replyBox).style.display="none";x();K(l.replyBoxContainer).style.display="block";G.push(l.textarea+H);y.push(l.submitBtn+H)}var u=[l.loginBtn,l.loginBtn+H];u.forEach(function(L){var z=K(L);if(!z){return}w(z).on("click",k)});var m=[l.registerBtn,l.registerBtn+H];m.forEach(function(L){var z=K(L);if(!z){return}w(z).on("click",j.register)});var G=[l.textarea,l.textarea+H];G.forEach(function(L){var z=K(L);if(z){w(z).on("keyup",function(){var M=z.value.length;var N=K(z.id===l.textarea?l.counter:l.counter+H);N.innerHTML=M});w(z).on("click",function(){if(z.innerHTML==localsForComment.Comment_CivilizedComments){z.innerHTML=""}})}});y.forEach(function(L){var z=K(L);if(z){w(z).on("click",t)}});j.addEventListener("logined",c);j.addEventListener("logout",D);j.addEventListener("authcodechange",function(z){w("#"+l.authImg+",#"+l.authImg+H).css("background","url("+z+") no-repeat center center")});j.addEventListener("loginerror",function(){w("#"+l.authCodeContainer+",#"+l.authCodeContainer+H).show()});w("#"+l.authImg+",#"+l.authImg+H).click(function(){j.getNewAuthCode()});j.addEventListener("needverify",function(z){w("#"+l.authCodeContainer+",#"+l.authCodeContainer+H).show()}).addEventListener("notneedverify",function(z){w("#"+l.authCodeContainer+",#"+l.authCodeContainer+H).hide()});w("#"+l.username+",#"+l.username+H).change(function(){j.needVerifyCode(this.value)});b()});jQuery(function(d){var h=window.Zving,b=h.loadJs,e=h.Server,m=h.getDom,i=h.Member,c=200;if(!window.localsForMessageBoard){return}var l=false;var a={messageBoard:"msgBoard",contentInput:"msg_content",counter:"msg_contentCount",chkAnonymous:"msg_chkAnonymous",submitBtn:"msg_submit",loginContainer:"msg_loginContainer",username:"msg_username",password:"msg_password",authCode:"msg_authCode",authImg:"msg_authCodeImg",loginBtn:"msg_frmbutton",registerBtn:"msg_reg",userNameLabel:"msg_userNameLabel",loginedPanel:"msg_logined",logoutPanel:"msg_login",authCodeContainer:"msg_authCodeContainer",loginFrm:"msg_frm"};var f=function(q){var p=a.loginPanel,s=a.authCodeContainer,n=a.loginFrm,t,o,r;t=m(p);o=m(s);r=m(n);r.reset();m(a.loginedPanel).style.display="none";m(a.logoutPanel).style.display="block";m(a.authCodeContainer).style.display="none"},g=function(n){d("#"+a.userNameLabel).html(n);m(a.logoutPanel).style.display="none";m(a.loginedPanel).style.display="block"},k=function(s){var s=s||window.event,t=s.target||s.srcElement,r=a.username,q=a.password,o=a.authCode,p;var n={UserName:m(r).value,Password:m(q).value};if(i.isNeedVerifyCode){n.AuthCode=m(o).value;n.IsVerifyCode=true}i.jsonpLogin(n)},j=function(){var o=m(a.contentInput);var p=o.value.trim();if(l&&!i.isLogined){Dialog.alert(localsForMessageBoard.Messageboard_LoginFirst);return}else{if(p==""||p==localsForMessageBoard.Messageboard_CivilizedMessages){Dialog.alert(localsForMessageBoard.Messageboard_ContentEmpty);o.focus();return false}else{if(p.length>c){Dialog.alert(localsForMessageBoard.Messageboard_ContentMore);return false}}}var n={BoardID:localsForMessageBoard.Request_boardId,SiteID:localsForMessageBoard.SiteID,Content:p,Anonymous:m(a.chkAnonymous).checked};e.sendRequest("message/submit",n,function(q){if(q.error){Dialog.alert(q.error);return}if(!q.noDisplay){addMessage({content:p,addUser:n.Anonymous||!i.isLogined?localsForMessageBoard.Messageboard_Anonymous:i.isLogined,message:q.message});d("#"+a.contentInput).val("");m(a.counter).innerHTML="0"}})};if(!m(a.messageBoard)){return}l=localsForMessageBoard.IsNeedLogin=="true";d("#"+a.submitBtn).click(j);d("#"+a.registerBtn).click(i.register);d("#"+a.loginBtn).click(k);d("#"+a.contentInput).on("keyup",function(){var n=this.value.length;var o=m(a.counter);o.innerHTML=n}).on("click",function(){if(this.innerHTML==localsForMessageBoard.Messageboard_CivilizedMessages){this.innerHTML=""}});i.addEventListener("authcodechange",function(n){d("#"+a.authImg).css("background","url("+n+") no-repeat center center")});i.addEventListener("loginerror",function(){d("#"+a.authCodeContainer).show()});d("#"+a.authImg).click(function(){i.getNewAuthCode()});i.addEventListener("needverify",function(n){d("#"+a.authCodeContainer).show()}).addEventListener("notneedverify",function(n){d("#"+a.authCodeContainer).hide()});d("#"+a.username).change(function(){i.needVerifyCode(this.value)});i.addEventListener("logined",g).addEventListener("logout",f)});(function(){var f=window.Zving;f.$G=f.getDom;f.$T=f.getByTag;f.$N=f.getByName;if(f.Node){f.$V=f.Node.getValue;f.$S=f.Node.setValue}f.$NV=f.getValues;f.$NS=f.setValues;f.$F=f.getForm;f.importCss("zcms_components.css");if(!f.Config.namespace||f.Config.namespace==="window"){var b,h=[];var g=/^(\$|Object|Class|Array|Date|Function|String|Node|Event|JSON|Storage|Comment)$/;for(b in f){if(typeof(f[b])==="undefined"||/^(id|g)$/.test(b)){continue}if(typeof(window[b])!=="undefined"){if(!g.test(b)){h.push("retouch.js -- "+b+" existed in window")}else{if(g.test(b)&&typeof(f[b])==="object"){f.mixIf(window[b],f[b])}}}else{try{window[b]=f[b]}catch(e){throw e}}}if(h.length&&f.Console){f.Console.silence=true;f.Console.error(h.join("<br>"))}}else{if(f.Config.namespace!=="Zving"){window[f.Config.namespace]=f}}if(!window.console.dir){window.console.dir=function(l){if(!/object/.test(Object.prototype.toString.call(l))){return console.log("console can`t dir the arg")}for(var i in l){console.log(i,": ",l[i])}}}if(f.Config.ignoreErrors=="true"){window.onerror=function(){return false}}$window.on("unload",function(){if(f.ComponentManager){f.ComponentManager._unload()}if(f.AllDocumentsEvent){f.AllDocumentsEvent._unload()}var i=jQuery.cache;var m,l=[];for(var n in jQuery.cache){if(i[n].handle&&(m=i[n].handle.elem)){if(m.nodeName&&m.nodeType==1){l.push(m)}}}l=null;f.rootWin=f.rootDoc=null;$document.off();$window.off()});var k=f.Cookie.get("zcms_skin");if(k){var j=document.getElementsByTagName("link");for(var d=0,c=j.length;d<c;d++){var a=j[d].href;if(a&&a.endsWith(f.CONTEXTPATH+"style/default.css")){f.Config.skin=k;f.importCSS("../style/"+k+"/default.css");break}}}})();Zving.Skin={};Zving.Skin.Supported="zvingclassic,zvinggreen,zvingdeep,zvingpurple,zvingred";Zving.Lang=Zving.Lang||{};Zving.Lang.Supported="en,zh-cn,zh-tw";Zving.Lang.DefaultLanguage="zh-cn";